{"version":3,"sources":["components/header/AppHeader.jsx","components/footer/Footer.jsx","components/linechart/LineChart.jsx","components/linechart/SmallLineChart.jsx","components/drawsignal/DrawSignal.jsx","components/helperfunctions/HelperFunctions.jsx","components/composemodel/ComposeModel.jsx","components/histogram/HistogramChart.jsx","components/viz/Viz.jsx","components/rocchart/ROCChart.jsx","components/scatterplot/ScatterPlot.jsx","components/losschart/LossChart.jsx","components/train/models/ae.jsx","components/train/Train.jsx","components/Main.jsx","serviceWorker.js","index.js"],"names":["AppHeader","props","appName","appDescription","className","aria-label","this","href","process","src","alt","exact","to","target","rel","Component","Footer","style","zIndex","LineChart","state","data","predictedData","color","minChartWidth","width","minChartHeight","height","backgrounOpacity","drawGraph","prevProps","prevState","lastUpdated","setState","updateGraph","chartMargin","top","right","bottom","left","chartWidth","chartHeight","n","length","xScale","d3","domain","range","yScale","xAxis","yAxis","tickSize","self","setupScalesAxes","concat","svg","transition","jointData","i","push","select","duration","attr","line","predictedColor","msearea","call","g","remove","selectAll","margin","x","d","y","y0","Math","min","y1","max","dataset","append","datum","ref","backgroundColor","SmallLineChart","chart","canvas","refs","smalllinecanvas","context","getContext","translate","scale","strokeStyle","prev_stat","move_left_by","stat","the_stat","beginPath","moveTo","lineTo","lineWidth","lineCap","stroke","DrawSignal","signalExtracted","axisOffset","smallChartWidth","smallChartHeight","prevX","currX","prevY","currY","dot_flag","strokeColor","flag","drawMap","Map","signalCount","pointColors","scaleRange","yaxisList","xaxisList","setUpCanvasSize","drawsignaloutcanvas","smallChartContext","largeChartCanvas","drawsignalcanvas","largeChartContext","addEventListener","mouseDownEvent","bind","mouseUpEvent","mouseMoveEvent","mouseOutEvent","touchEndEvent","touchStartEvent","passive","touchMoveEvent","ynScale","zeroArr","Array","fill","closePath","has","set","res","e","fillStyle","fillRect","miniGraph","xPos","yPos","limitValues","setXYCoords","draw","console","log","changedTouches","pageY","pageX","offsetLeft","offsetTop","findxy","updateMove","removeEventListener","size","clearRect","updateCurrentSignal","start","end","prevMean","sum","count","get","rangeMean","values","next","value","curMean","signalHolder","signalHolderScaled","step","floor","xaxis","map","key","yaxis","Button","renderIcon","onClick","clearDrawing","id","registerGAEvent","componentName","eventCategory","eventAction","componentLoadTime","eventTime","Date","getTime","window","location","hostname","ReactGA","event","category","action","label","computeAccuracyGivenThreshold","threshold","predVal","truePositive","trueNegative","falsePositive","falseNegative","forEach","each","mse","acc","tp","tn","fp","fn","tpr","fpr","fnr","tnr","precision","recall","percentToRGB","percent","r","initialize","LeaderLine","animOptions","timing","ComposeModel","hiddenDims","latentDim","maxLayers","minLayers","maxUnits","minUnits","defaultLayerDim","isTraining","latentLineWidth","animationDuration","lineHolder","rightTopAnchor","rightBottomAnchor","leftTopAnchor","leftBottomAnchor","rightMiddle","leftMiddle","blueColor","greyColor","isUpdatable","drawAllLines","network","attributeName","attributeValue","document","querySelector","layer","startId","endId","startEl","getElement","endEl","params","pathType","drawLeaderLine","latentDiv","getElementById","addLayerLines","addEncDecLines","lineId","toRemove","position","newHolder","startElement","endElement","startAnchor","endAnchor","lineColor","pointAnchor","startPlug","endPlug","startPlugColor","path","hide","dash","gap","show","opt","setOptions","redrawLine","updateModelDims","removeLayerLines","animateLines","adv","redrawAllLines","removeAllLines","varGroup","newDims","decoderDims","dimType","slice","currentDims","getDims","getAttribute","setStateVal","pop","currentUnit","latentLayers","layerindex","eachLayer","_","unitindex","layergroup","buttonaction","updateUnits","encLayers","nodeunit","layerdiv","decLayers","updateLayerClick","HistogramChart","numTicks","xTicks","epoch","nice","bins","thresholds","ticks","binNorm","binsAnorm","join","x0","x1","text","toFixed","meanNormal","meanAbnormal","midPoint","Viz","modelChartWidth","innerWidth","modelChartHeight","testData","require","trainMse","apptitle","trainData","selectedIndex","selectedData","showDrawData","drawSectionWidth","drawSectionHeight","isLoading","modelLoaded","predictedMse","selectedLegend","showAutoEncoderViz","showMseViz","isDataTransormed","showBeforeTrainingHistogram","trainVizEpoch","bestMetric","minThreshold","maxThreshold","vizThresold","histPlaying","showError","errorMsg","currentEpoch","chartColorMap","0","colornorm","name","1","2","3","4","maxSmallChart","modelDataLastUpdated","hiddenDim","mseExplanations","smallChartxScale","smallChartyScale","offsetWidth","xMinArray","xMaxArray","featureRange","sampleTestData","myStringify","applyTransform","sampleTransformedTestData","computeAccuracyMetrics","componentLoadedTime","replayHistInterval","result","el","loadedModel","dispose","holder","setTimeout","tf","catch","then","model","getPrediction","transformedData","dataTensor","preds","predict","batchSize","square","mean","array","applyReverseTransform","loadModel","uniqueMse","rocMetricHolder","metric","threshVal","lastclicked","setSelectedData","index","toString","replayUpdater","dataLegend","Object","entries","clickLegend","background","dataLegendSmall","dataPoints","isVisible","indexvalue","clickDataPoint","targetval","datasetExamples","dataSketchPad","barColor","modelOutput","opacity","Loading","active","small","withOverlay","fontSize","setDatasetECG","setDatasetDraw","toggelTransform","textContent","toggleVizHistPlaying","Slider","minLabel","maxLabel","stepMuliplier","labelText","hideTextInput","onChange","updateTrainVizEpoch","disabled","updateThreshold","borderLeftColor","ROCChart","dotRadius","rocLine","rocArea","drawLines","auc","ScatterPlot","LossChart","innerHTML","loss","val_loss","trainLine","valLine","curve","Train","stepOptions","type","regularizerOptions","batchSizeOptions","learningRateOptions","trainingDataOptions","testDataOptions","optimizerOptions","abnormalPercentageOptions","selectedAbnormalPercentage","selectedTrainDataOption","selectedTestDataOption","selectedOptimizer","selectedRegularizer","trainMetricHolder","CumulativeSteps","interfaceTimedDelay","trainLoaded","testLoaded","trainDataShape","testDataShape","mseData","rocData","createdModel","encodedData","numFeatures","hiddenLayers","learningRate","regularizer","adamBeta1","optimizer","outputActivation","numSteps","numEpochs","trainMetrics","trainDataSize","testDataSize","modelStale","showModelComposer","showModelEvaluationMetrics","showRocChart","showLossChart","showMseHistogram","showBottleneckScatterPlot","validateOnStep","showAdvanced","showIntroduction","showWarmingUp","lossChartHeight","lossChartWidth","abnormalPercentage","floatCapable","floatEnabled","isCreating","showOptions","checked","currentSteps","xsTrain","xsTest","yTest","trainDataPath","testDataPath","momentum","modelWarmedUp","tensorsCreated","trainUnmounted","getChartContainerSizes","fetchData","error","handleDataLoadError","dataPath","fetch","response","json","generateDataTensors","destroyModelTensors","adam","adamax","adadelta","rmsprop","sgd","modelParams","regularizationRate","layerRegularizer","regularizers","l1","l2","l1l2","input","shape","encoderHidden","layers","dense","units","activation","kernelRegularizer","apply","z_","encoder","inputs","outputs","latentInput","decoderHidden","j","decoderOutput","output","ae","compile","buildModel","getPredictions","warmUpTensor","item","startTime","fit","epochs","verbose","elapsedTime","validationData","metricRow","history","traintime","trainModel","savedModel","loadTestData","sortBy","reverse","rocSum","prevMetric","mseDataHolder","element","getLayer","getOutputAt","encoderPredictions","encPredHolder","maxAbnormalCount","abnormalCount","trainEcg","row","val","createModel","selectedItem","offsetHeight","chartState","box","showCheckBoxes","Checkbox","defaultChecked","wrapperClassName","showOptionsClick","isDataLoaded","loadingText","trainResetButtons","resetModelButtonClick","trainButtonClick","configBar","Dropdown","items","initialSelectedItem","itemToString","updateModelParam","firstEncode","compBoxSize","modelComposerBlock","lossChartBlock","rocChartBlock","mseHistogramBlock","bottleneckScatterPlotBlock","modelMetricsBlock","toggleIntroDrawer","toggleAdvancedDrawer","Tooltip","direction","triggerText","createBrowserHistory","basename","forceRefresh","keyLength","getUserConfirmation","message","callback","confirm","listen","page","hash","pageview","linkHolder","updateLh","Main","component","isLocalhost","Boolean","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","ReactDOM","render","URL","origin","contentType","headers","status","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.22cda980.chunk.js","sourcesContent":["/**\n * @license\n * Copyright 2019 Victor Dibia. https://github.com/victordibia\n * Anomagram - Anomagram: Anomaly Detection with Autoencoders in the Browser.\n * Licensed under the MIT License (the \"License\"); \n * =============================================================================\n */\n\nimport React, { Component } from \"react\";\nimport {\n    NavLink\n} from \"react-router-dom\";\nimport { LogoGithub16 } from '@carbon/icons-react';\n\nimport \"./header.css\"\n\nclass AppHeader extends Component {\n    constructor(props) {\n        super(props)\n\n        this.appName = \"Anomagram\"\n        this.appDescription = \"An interactive visualization for exploring deep learning models applied to the task of anomaly detection.\"\n\n\n    }\n    render() {\n        return (\n            <div>\n                <div className=\"headermain\" aria-label={this.appDescription}>\n\n                    <div className=\"container-fluid w100 headerrow pl10 \">\n\n                        <div className=\"flex    h100\">\n                            <div className=\"h100   flex flexjustifycenter mr10 \">\n                                <a href={process.env.PUBLIC_URL + \"/#\"}>\n                                    <img className=\"headericon\" src=\"images/icon.png\" alt=\"anomagram logo\" />\n\n                                </a>\n                            </div>\n                            <div className=\"h100 apptitle  flex flexjustifycenter  mr10\">\n                                <div className=\"whitetext boldtext  iblock mr10\">  {this.appName} </div>\n                            </div>\n                            <div className=\"h100   flex flexjustifycenter  navbarlinks \">\n                                <NavLink exact to=\"/\"> Introduction </NavLink>\n                            </div>\n                            <div className=\"h100   flex flexjustifycenter  navbarlinks mr10\">\n                                <NavLink exact to=\"/train\"> Train <span className=\"apptitle\"> a Model </span></NavLink>\n                            </div>\n                            <div className=\"h100   flex flexjustifycenter   navbarlinks mr10\">\n                                <a className=\" dispalyblock h100  \" href=\"https://github.com/victordibia/anomagram/\" target=\"_blank\" rel=\"noopener noreferrer\">\n                                    <LogoGithub16 className=\" whitefill gitlogo  \"></LogoGithub16>\n                                    <span className=\"gitlogotext\">Git</span><span className=\" apptitle\">hub</span>\n                                </a>\n                            </div>\n                        </div>\n\n                    </div>\n                </div>\n                <div></div>\n                <div className=\"headerboost\">  </div>\n            </div>\n\n        );\n    }\n}\n\nexport default AppHeader;\n","/**\n * @license\n * Copyright 2019 Victor Dibia. https://github.com/victordibia\n * Anomagram - Anomagram: Anomaly Detection with Autoencoders in the Browser.\n * Licensed under the MIT License (the \"License\"); \n * =============================================================================\n */\n\nimport React, { Component } from \"react\";\nimport \"./footer.css\"\n\nclass Footer extends Component {\n    render() {\n        return (\n            <div style={{ zIndex: 999000 }}>\n                Made with <span className=\"redcolor\">&#9829;</span> by <a href=\"https://twitter.com/vykthur\" target=\"blank\">Victor Dibia</a>.\n            </div>\n        );\n    }\n}\n\nexport default Footer;","/**\n * @license\n * Copyright 2019 Victor Dibia. https://github.com/victordibia\n * Anomagram - Anomagram: Anomaly Detection with Autoencoders in the Browser.\n * Licensed under the MIT License (the \"License\"); \n * =============================================================================\n */\n\n\nimport React, { Component } from 'react'\n// import { loadJSONData, abbreviateString } from \"../helperfunctions/HelperFunctions\"\nimport \"./linechart.css\"\nimport * as d3 from \"d3\"\n\n\nclass LineChart extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            data: this.props.data,\n            predictedData: this.props.predictedData,\n            color: this.props.color\n        }\n\n\n\n        this.minChartWidth = this.props.width\n        this.minChartHeight = this.props.height\n\n        // console.log(this.props);\n\n        this.backgrounOpacity = \"63\"\n\n\n    }\n\n    componentDidMount() {\n        // console.log(\"Line component mounted\")\n        this.drawGraph()\n\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        // console.log(this.props.index, prevProps.index);\n\n        if (this.props.lastUpdated !== prevProps.lastUpdated) {\n            this.setState({ data: this.props.data })\n            // console.log(\"stuff hass changed\", this.props.data);\n            this.updateGraph(this.props.data, this.props.predictedData)\n\n        }\n\n    }\n\n    setupScalesAxes(data) {\n        this.chartMargin = { top: 10, right: 5, bottom: 25, left: 20 }\n        this.chartWidth = this.minChartWidth - this.chartMargin.left - this.chartMargin.right\n        this.chartHeight = this.minChartHeight - this.chartMargin.top - this.chartMargin.bottom;\n\n        // consolse.log(data);\n\n        var n = data.length / 2;\n\n        this.xScale = d3.scaleLinear()\n            .domain([0, n - 1]) // input\n            .range([0, this.chartWidth]); // output\n\n\n        this.yScale = d3.scaleLinear()\n            .domain([d3.min(data), d3.max(data)]) // input \n            .range([this.chartHeight, 0]); // output \n\n        this.xAxis = d3.axisBottom(this.xScale)\n        this.yAxis = d3.axisRight(this.yScale)\n            .tickSize(this.minChartWidth)\n\n    }\n\n    updateGraph(data, predictedData) {\n        let self = this\n        // console.log(data)\n        this.setupScalesAxes(data.concat(predictedData))\n        // Select the section we want to apply our changes to\n        var svg = d3.select(\"div.linechartbox\").transition();\n\n\n        let jointData = []\n        for (let i = 0; i < this.props.data.length; i++) {\n            jointData.push({ data: this.props.data[i], predictedData: this.props.predictedData[i] })\n        }\n\n        // Make the changes\n        svg.select(\".line\")   // change the input line\n            .duration(750)\n            .attr(\"stroke\", this.state.color)\n            .attr(\"d\", this.line(data));\n\n        // Make the changes to predicted line\n        svg.select(\".predictedline\")   // change the line\n            .duration(750)\n            .attr(\"stroke\", this.props.predictedColor)\n            .attr(\"d\", this.line(predictedData));\n\n        //make changes to the error area\n        svg.select(\".msearea\")\n            .duration(750)\n            .attr(\"fill\", this.props.predictedColor + this.backgrounOpacity)\n            .attr(\"stroke\", \"none\")\n            .attr(\"d\", this.msearea(jointData)\n            );\n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            svg.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\");\n            g.selectAll(\".tick text\").attr(\"x\", -20).attr(\"y\", -.01)\n        }\n        svg.select(\".y.axis\")\n            .call(customYAxis).duration(5);\n    }\n\n\n    drawGraph() {\n        let self = this\n        this.setupScalesAxes(this.state.data.concat(this.state.predictedData))\n        let width = this.chartWidth, height = this.chartHeight, margin = this.chartMargin\n\n        let jointData = []\n        for (let i = 0; i < this.props.data.length; i++) {\n            jointData.push({ data: this.props.data[i], predictedData: this.props.predictedData[i] })\n        }\n\n        // 7. d3's line generator\n        this.line = d3.line()\n            .x(function (d, i) { return self.xScale(i); }) // set the x values for the line generator\n            .y(function (d) { return self.yScale(d); }) // set the y values for the line generator \n        // .curve(d3.curveMonotoneX) // apply smoothing to the line\n\n        this.msearea = d3.area()\n            .x(function (d, i) { return self.xScale(i); })\n            .y0(function (d) { return self.yScale(Math.min(d.data, d.predictedData)) })\n            .y1(function (d) { return self.yScale(Math.max(d.data, d.predictedData)) })\n\n        // 8. An array of objects of length N. Each object has key -> value pair, the key being \"y\" and the value is a random number\n        var dataset = this.state.data\n\n        // console.log(this.state);\n\n\n        // d3.range(n).map(function (d) { return { \"y\": d3.randomUniform(1)() } })\n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\");\n            g.selectAll(\".tick text\").attr(\"x\", -20).attr(\"y\", -.01)\n        }\n\n        function customXAxis(g) {\n            g.call(self.xAxis);\n            g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"x\", 100)\n            g.selectAll(\".tick text\").attr(\"y\", 15)\n        }\n\n        // 1. Add the SVG to the page and employ #2\n        var svg = d3.select(\"div.linechartbox\").append(\"svg\")\n            .attr(\"width\", width + margin.left + margin.right)\n            .attr(\"height\", height + margin.top + margin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n\n\n        // 3. Call the x axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"x axis\")\n            .attr(\"transform\", \"translate(0,\" + height + \")\")\n            .call(customXAxis); // Create an axis component with d3.axisBottom\n\n        // 4. Call the y axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"y axis\")\n            .call(customYAxis); // Create an axis component with d3.axisLeft\n\n        // 9. Append the path, bind the data, and call the line generator \n        svg.append(\"path\")\n            .datum(dataset) // 10. Binds data to the line \n            .attr(\"class\", \"line\") // Assign a class for styling \n            .attr(\"stroke\", this.state.color)\n            .attr(\"d\", this.line); // 11. Calls the line generator \n\n        svg.append(\"path\")\n            .datum(this.state.predictedData) // 10. Binds data to the line \n            .attr(\"class\", \"predictedline\") // Assign a class for styling \n            .attr(\"stroke\", this.props.predictedColor)\n            .attr(\"d\", this.line); // 11. Calls the line generator \n\n        svg.append(\"path\")\n            .datum(jointData)\n            .attr(\"class\", \"msearea\") // Assign a class for styling \n            .attr(\"fill\", this.props.predictedColor + this.backgrounOpacity)\n            .attr(\"stroke\", \"none\")\n            .attr(\"d\", this.msearea\n            )\n\n        // // 12. Appends a circle for each datapoint \n        // svg.selectAll(\".dot\")\n        //     .data(dataset)\n        //     .enter().append(\"circle\") // Uses the enter().append() method\n        //     .attr(\"class\", \"dot\") // Assign a class for styling\n        //     .attr(\"cx\", function (d, i) { return xScale(i) })\n        //     .attr(\"cy\", function (d) { return yScale(d) })\n        //     .attr(\"r\", 5)\n        //     .on(\"mouseover\", function (a, b, c) {\n        //         console.log(a)\n        //         // this.attr('class', 'focus')\n        //     })\n    }\n\n\n    render() {\n\n\n\n        return (\n            <div className=\"positionrelative mainchartbox \">\n                <div className=\"chartlegend legendbottomrightmod p5 mediumdesc \">\n                    <div className=\"mb3 \">\n                        <div className=\"legendcolorbox mr5  themeblue iblock\"></div>\n                        <div ref=\"trainlabel\" className=\"iblock boldtext mr5\"> Input  </div>\n                        <div className=\"iblock \"> </div>\n                    </div>\n                    <div className=\"mb3 \">\n                        <div style={{ backgroundColor: this.props.predictedColor }} className=\"legendcolorbox mr5 iblock\"></div>\n                        <div ref=\"validationlabel\" className=\"iblock boldtext mr5\"> Prediction</div>\n                        <div className=\"iblock \"></div>\n                    </div>\n                    <div >\n                        <div style={{ backgroundColor: this.props.predictedColor + this.backgrounOpacity }} className=\"legendcolorbox mr5  iblock\"></div>\n                        <div ref=\"trainlabel\" className=\"iblock boldtext mr5\"> Error  </div>\n                        <div className=\"iblock \"> </div>\n                    </div>\n                </div>\n\n                <div className=\"linechartbox \"></div>\n\n            </div>\n        )\n    }\n}\n\nexport default LineChart","/**\n * @license\n * Copyright 2019 Victor Dibia. https://github.com/victordibia\n * Anomagram - Anomagram: Anomaly Detection with Autoencoders in the Browser.\n * Licensed under the MIT License (the \"License\"); \n * =============================================================================\n */\n\n\nimport React, { Component } from 'react'\nimport \"./linechart.css\"\n\nclass SmallLineChart extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            chart: this.props.data\n        }\n\n        this.xScale = this.props.data.xScale\n        this.yScale = this.props.data.yScale\n    }\n\n    componentDidMount() {\n        let canvas = this.refs.smalllinecanvas\n        canvas.width = this.props.data.chartWidth\n        canvas.height = this.props.data.chartHeight\n        this.drawGraph()\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n\n\n    }\n    drawGraph() {\n\n        let data = this.state.chart.data.data\n\n        let canvas = this.refs.smalllinecanvas,\n            context = canvas.getContext('2d')\n\n\n\n        context.translate(0, this.props.data.chartHeight);\n        context.scale(1, -1);\n\n        context.strokeStyle = this.state.chart.color;\n\n        var left = 0,\n            prev_stat = data[0],\n            move_left_by = this.props.data.chartWidth / data.length;\n\n        for (let stat in data) {\n\n            let the_stat = this.yScale(data[stat]);\n\n            context.beginPath();\n            context.moveTo(left, prev_stat);\n            context.lineTo(left + move_left_by, the_stat);\n            context.lineWidth = 1.6;\n            context.lineCap = 'round';\n\n            context.stroke();\n\n            prev_stat = the_stat;\n            left += move_left_by;\n\n        }\n    }\n\n    render() {\n\n        return (\n            <canvas ref=\"smalllinecanvas\" ></canvas>\n        )\n    }\n}\n\nexport default SmallLineChart","/**\n * @license\n * Copyright 2019 Victor Dibia. https://github.com/victordibia\n * Anomagram - Anomagram: Anomaly Detection with Autoencoders in the Browser.\n * Licensed under the MIT License (the \"License\"); \n * =============================================================================\n */\n\nimport React, { Component } from \"react\";\nimport \"./drawsignal.css\"\nimport * as d3 from \"d3\"\n// import * as _ from \"lodash\"\nimport { Button } from \"carbon-components-react\"\n\nclass DrawSignal extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            signalExtracted: false\n        }\n\n\n        this.axisOffset = 20\n        this.chartWidth = this.props.width - this.axisOffset\n        this.chartHeight = this.props.height\n\n\n        this.smallChartWidth = 150\n        this.smallChartHeight = 40\n\n        this.prevX = 0\n        this.currX = 0\n        this.prevY = 0\n        this.currY = 0\n        this.dot_flag = false;\n\n        this.strokeColor = \"black\"\n        this.lineWidth = 2\n        this.flag = false\n\n        this.drawMap = new Map()\n        this.signalCount = 140\n        this.pointColors = []\n\n        this.scaleRange = [2, -5]\n\n        // Add x and y axis labelss for drawsignal\n        this.yaxisList = [2, 1, 0, -1, -2, -3, -4]\n        this.xaxisList = [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130]\n\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n\n        // console.log(prevProps.data.epoch, this.props.data.epoch)\n        if ((this.props.width !== prevProps.width)) {\n            this.chartWidth = this.props.width - this.axisOffset\n            this.setUpCanvasSize()\n        }\n\n    }\n\n    componentDidMount() {\n\n\n        this.refs.drawsignaloutcanvas.width = this.smallChartWidth\n        this.refs.drawsignaloutcanvas.height = this.smallChartHeight\n        this.smallChartContext = this.refs.drawsignaloutcanvas.getContext('2d')\n\n        // console.log(\"Line component mounted\")\n        this.largeChartCanvas = this.refs.drawsignalcanvas\n        this.setUpCanvasSize()\n        this.largeChartContext = this.largeChartCanvas.getContext('2d')\n\n        this.largeChartCanvas.addEventListener(\"mousedown\", this.mouseDownEvent.bind(this))\n        this.largeChartCanvas.addEventListener(\"mouseup\", this.mouseUpEvent.bind(this))\n        this.largeChartCanvas.addEventListener(\"mousemove\", this.mouseMoveEvent.bind(this))\n        this.largeChartCanvas.addEventListener(\"mouseout\", this.mouseOutEvent.bind(this))\n\n        this.largeChartCanvas.addEventListener(\"touchend\", this.touchEndEvent.bind(this))\n        this.largeChartCanvas.addEventListener(\"touchstart\", this.touchStartEvent.bind(this), { passive: true })\n        this.largeChartCanvas.addEventListener(\"touchmove\", this.touchMoveEvent.bind(this), { passive: true })\n\n\n        // Set up scales \n        this.xScale = d3.scaleLinear()\n            .domain([0, this.signalCount - 1]) // input\n            .range([0, this.smallChartWidth]); // output\n\n\n        this.yScale = d3.scaleLinear()\n            .domain([0, this.chartHeight]) // input \n            .range([0, this.smallChartHeight]); // output\n\n\n        this.ynScale = d3.scaleLinear()\n            .domain([0, this.chartHeight]) // input \n            .range(this.scaleRange); // output\n\n\n        this.zeroArr = new Array(this.signalCount).fill(0);\n\n    }\n\n    setUpCanvasSize() {\n        this.largeChartCanvas.width = this.chartWidth\n        this.largeChartCanvas.height = this.chartHeight;\n    }\n\n\n    draw() {\n\n\n        this.largeChartContext.beginPath();\n        this.largeChartContext.moveTo(this.prevX, this.prevY);\n        this.largeChartContext.lineTo(this.currX, this.currY);\n        this.largeChartContext.strokeStyle = this.strokeColor;\n        this.largeChartContext.lineWidth = this.lineWidth;\n        this.largeChartContext.stroke();\n        this.largeChartContext.closePath();\n        // console.log(this.currX, this.currY);\n\n        if (!this.drawMap.has(this.currX)) {\n            this.drawMap.set(this.currX, this.currY)\n\n        }\n\n    }\n\n\n\n    findxy(res, e) {\n        if (res === 'down') {\n            this.flag = true;\n            this.dot_flag = true;\n            if (this.dot_flag) {\n                this.largeChartContext.beginPath();\n                this.largeChartContext.fillStyle = this.strokeColor;\n                this.largeChartContext.fillRect(this.currX, this.currY, 2, 2);\n                this.largeChartContext.closePath();\n                this.dot_flag = false;\n            }\n        }\n        if (res === 'up') {\n            this.flag = false;\n            this.miniGraph()\n        }\n        if (res === \"out\") {\n            this.flag = false;\n        }\n        if (res === 'move') {\n\n        }\n    }\n\n    limitValues(x, min, max) {\n        x = x < min ? min : x\n        x = x > max ? max : x\n        return x\n    }\n\n    setXYCoords(xPos, yPos) {\n        // console.log(xPos, yPos);\n\n        xPos = this.limitValues(xPos, 0, this.chartWidth)\n        yPos = this.limitValues(yPos, 0, this.chartHeight)\n\n        this.prevX = this.currX;\n        this.prevY = this.currY;\n        this.currX = xPos\n        this.currY = yPos\n    }\n\n    updateMove(xPos, yPos) {\n        if (this.flag) {\n            this.setXYCoords(xPos, yPos)\n            this.draw();\n        }\n    }\n\n    touchStartEvent(e) {\n        console.log(e.changedTouches[0].pageY);\n        this.setXYCoords(e.changedTouches[0].pageX - this.largeChartCanvas.offsetLeft, e.changedTouches[0].pageY - this.largeChartCanvas.offsetTop)\n        this.findxy('down', e)\n    }\n\n    touchEndEvent(e) {\n        this.findxy('up', e)\n    }\n    touchMoveEvent(e) {\n        console.log(e.changedTouches.length);\n        for (let i = 0; i < e.changedTouches.length; i++) {\n            console.log(\"touchpoint[\" + i + \"].pageX = \" + e.changedTouches[i].pageX);\n            console.log(\"touchpoint[\" + i + \"].pageY = \" + e.changedTouches[i].pageY);\n            this.updateMove(e.changedTouches[i].pageX - this.largeChartCanvas.offsetLeft, e.changedTouches[i].pageY - this.largeChartCanvas.offsetTop)\n        }\n    }\n\n\n    mouseDownEvent(e) {\n        this.setXYCoords(e.pageX - this.largeChartCanvas.offsetLeft, e.pageY - this.largeChartCanvas.offsetTop)\n        this.findxy('down', e)\n    }\n    mouseUpEvent(e) {\n        this.findxy('up', e)\n    }\n    mouseMoveEvent(e) {\n        this.updateMove(e.pageX - this.largeChartCanvas.offsetLeft, e.pageY - this.largeChartCanvas.offsetTop)\n    }\n    mouseOutEvent(e) {\n        this.findxy('out', e)\n    }\n\n\n\n    componentWillUnmount() {\n        this.largeChartCanvas.removeEventListener(\"mousedown\", this.mouseDownEvent)\n        this.largeChartCanvas.removeEventListener(\"mouseup\", this.mouseUpEvent)\n        this.largeChartCanvas.removeEventListener(\"mouseover\", this.mouseMoveEvent)\n        this.largeChartCanvas.removeEventListener(\"mouseout\", this.mouseOutEvent)\n\n\n        this.largeChartCanvas.removeEventListener(\"touchend\", this.touchEndEvent)\n        this.largeChartCanvas.removeEventListener(\"touchstart\", this.touchStartEvent)\n        this.largeChartCanvas.removeEventListener(\"touchmove\", this.touchMoveEvent)\n\n\n    }\n\n    miniGraph() {\n        if (this.drawMap.size > 0) {\n            this.drawGraph(this.drawMap)\n\n        }\n    }\n\n    clearDrawing() {\n\n        this.largeChartContext.clearRect(0, 0, this.chartWidth, this.chartHeight);\n        this.smallChartContext.clearRect(0, 0, this.smallChartWidth, this.smallChartHeight);\n\n        this.drawMap = new Map()\n        this.setState({ signalExtracted: false })\n\n        this.props.updateCurrentSignal(this.zeroArr)\n    }\n\n    rangeMean(i, start, end, prevMean, data) {\n        let sum = 0\n        let count = 0\n        for (let i = start; i <= end; i++) {\n            if (data.get(i * 1)) {\n                sum += data.get(i * 1)\n                count++\n            }\n        }\n\n        let rangeMean = sum / count\n        this.pointColors[i] = \"blue\"\n        if (count === 0) {\n            rangeMean = prevMean\n            this.pointColors[i] = \"orange\"\n        }\n\n        // console.log(start, end, sum, count, rangeMean);\n        return rangeMean\n    }\n    drawGraph(data) {\n\n        let canv = this.refs.drawsignaloutcanvas\n        let context = canv.getContext(\"2d\")\n\n        this.smallChartContext.clearRect(0, 0, this.chartWidth, this.chartWidth);\n\n        // context.translate(0, this.chartHeight);\n        // context.scale(1, -1);\n\n        let prevMean = data.values().next().value\n        let curMean = 0\n        let signalHolder = []\n        let signalHolderScaled = []\n\n        let step = (this.chartWidth / this.signalCount)\n        for (let i = 0; i < this.signalCount; i++) {\n            curMean = this.rangeMean(i, Math.floor(i * step), Math.floor(i * step + step), prevMean, data)\n            signalHolder[i] = curMean\n            signalHolderScaled[i] = this.ynScale(curMean)\n            prevMean = curMean\n        }\n        this.setState({ signalExtracted: true })\n        this.props.updateCurrentSignal(signalHolderScaled)\n\n\n        // console.log(signalHolder);\n        let prevX = 0, prevY = signalHolder[0]\n        let currX = 0, currY = 0\n        for (let i = 1; i < signalHolder.length; i++) {\n            currX = i\n            currY = signalHolder[i] || signalHolder[i - 1]\n            context.beginPath();\n            context.moveTo(this.xScale(prevX), this.yScale(prevY));\n            context.lineTo(this.xScale(currX), this.yScale(currY));\n            context.strokeStyle = this.pointColors[i]\n            context.lineWidth = this.lineWidth;\n            context.stroke();\n            context.closePath();\n            prevX = currX\n            prevY = currY\n\n        }\n    }\n\n    drawSample() {\n\n    }\n\n\n    render() {\n        console.log();\n\n        let xaxis = this.yaxisList.map((data) => {\n            return (\n                <div style={{ height: this.chartHeight / this.yaxisList.length }} key={\"axisbox\" + data} className=\"axiscell \">\n                    <div className=\"axiscelltext mediumdesc\">   {data}</div>\n                </div>\n            )\n        })\n\n        let yaxis = this.xaxisList.map((data) => {\n            return (\n                <div style={{ width: (this.props.width - this.axisOffset) / this.xaxisList.length }} key={\"xaxisbox\" + data} className=\"xaxiscell iblock \">\n                    <div className=\"xaxiscelltext mediumdesc\">   {data}</div>\n                </div>\n            )\n        })\n        return (\n            // <div style={{ width: this.chartWidth + 25 }} className=\"mt2 border p10\">\n            <div className=\" w100 \" >\n\n                <div className=\"mb10 flex\">\n                    <div className=\"pb10 flexfull  mediumdesc\">\n                        <div className=\"h100 pt5 lhmedium \">  Click and drag to draw a signal. Please draw within the box.</div>\n                    </div>\n\n                    <div className=\"iblock mr5\">\n                        <Button\n                            size={\"small\"}\n                            renderIcon={null}\n                            onClick={this.clearDrawing.bind(this)}\n                        > Clear Drawing </Button>\n                    </div >\n                    {/* <div className=\"iblock\">\n                            <Button\n                                size={\"field\"}\n                                renderIcon={null}\n                                onClick={this.drawSample.bind(this)}\n                            > Draw Sample </Button>\n                        </div> */}\n                </div>\n                <div>\n                    <div className=\" w100 flex\">\n                        <div className=\" axisbox mr5 iblock\">\n                            {xaxis}\n                        </div>\n                        <div className=\"flexfull  iblock\">\n\n                            <div className={\"unclickable positionabsolute  smallchartbox \" + (this.state.signalExtracted ? \" \" : \" displaynone\")} >\n                                <canvas className=\"smallchart\" ref=\"drawsignaloutcanvas\" id=\"smallsignalcanvas\"></canvas>\n                                <div className={\"smalldesc extractedsignal \" + (this.state.signalExtracted ? \" \" : \" displaynone\")}> Extracted signal </div>\n\n                            </div>\n                            <div style={{ height: this.chartHeight }} className=\"\">\n\n                                <canvas className=\"border iblock largechart\" ref=\"drawsignalcanvas\" id=\"drawsignalcanvas\"></canvas>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div style={{ width: this.props.width - this.axisOffset + 5 }} className=\"horizontalaxis  \">{yaxis}</div>\n\n\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default DrawSignal","/**\n * @license\n * Copyright 2019 Victor Dibia. https://github.com/victordibia\n * Anomagram - Anomagram: Anomaly Detection with Autoencoders in the Browser.\n * Licensed under the MIT License (the \"License\"); \n * =============================================================================\n */\n\n\nimport ReactGA from 'react-ga';\nReactGA.initialize(\"UA-131578973-2\")\n\nexport function registerGAEvent(componentName, eventCategory, eventAction, componentLoadTime) {\n    let eventTime = (new Date()).getTime() - componentLoadTime\n    if (window.location.hostname !== \"localhost\") {\n        // console.log(\"GA\", eventCategory, eventTime, eventAction, componentName)\n        ReactGA.event({\n            category: eventCategory,\n            action: eventAction,\n            value: eventTime,\n            label: componentName\n        });\n    }\n\n}\n\nexport function showToast(type, message, duration = 4000) {\n    let notifbox = document.getElementById(\"notificatiionbox\")\n    let notif = document.createElement('div');\n    notif.className = \"notificationinner\"\n    notif.innerHTML = \"\" + message\n    notifbox.append(notif)\n    notif.style.opacity = 1\n    // console.log(notifbox);\n\n    setTimeout(() => {\n        // notif.remove()\n        notif.style.opacity = 0\n        setTimeout(() => {\n            notif.remove()\n        }, 1500);\n    }, duration);\n\n}\n\nexport function computeAccuracyGivenThreshold(data, threshold) {\n\n    let predVal = 0\n    let truePositive = 0\n    let trueNegative = 0\n    let falsePositive = 0\n    let falseNegative = 0\n\n    data.forEach(each => {\n        predVal = each.mse > threshold ? 1 : 0\n        if ((each.label === 1) && (predVal === 1)) {\n            truePositive++\n        }\n        if ((each.label === 0) && (predVal === 0)) {\n            trueNegative++\n        }\n\n        if ((each.label === 0) && (predVal === 1)) {\n            falsePositive++\n        }\n\n        if ((each.label === 1) && (predVal === 0)) {\n            falseNegative++\n        }\n    });\n\n    let metricRow = {\n        acc: (truePositive + trueNegative) / data.length,\n        threshold: threshold,\n        tp: truePositive,\n        tn: trueNegative,\n        fp: falsePositive,\n        fn: falseNegative,\n        tpr: truePositive / (truePositive + falseNegative),\n        fpr: falsePositive / (trueNegative + falsePositive),\n        fnr: falseNegative / (truePositive + falseNegative),\n        tnr: trueNegative / (trueNegative + falsePositive),\n        precision: truePositive / (truePositive + falsePositive) || 0,\n        recall: truePositive / (truePositive + falseNegative)\n\n    }\n\n    return metricRow\n\n}\n\nexport function percentToRGB(percent) {\n    percent = 100 - percent\n    if (percent === 100) {\n        percent = 99\n    }\n    let r, g, b;\n\n    if (percent < 50) {\n        // green to yellow\n        r = Math.floor(255 * (percent / 50));\n        g = 255;\n\n    } else {\n        // yellow to red\n        r = 255;\n        g = Math.floor(255 * ((50 - percent % 50) / 50));\n    }\n    b = 0;\n\n    return \"rgb(\" + r + \",\" + g + \",\" + b + \")\";\n}\n\n\nexport function abbreviateString(value, maxLength) {\n    if (value.length <= maxLength) {\n        return value\n    } else {\n        let retval = value.substring(0, maxLength) + \" ..\"\n        return retval\n    }\n}\n\nexport function boundWidth(widthVal) {\n    if (widthVal < 0) {\n        return 0;\n    } else if (widthVal > 1) {\n        return 1;\n    } else {\n        return widthVal;\n    }\n}\n\nfunction intlFormat(num) {\n    return new Intl.NumberFormat().format(Math.round(num * 10) / 10);\n}\nexport function makeFriendly(num) {\n    if (num < 1 && num > 0) {\n        return num\n    }\n    if (Math.abs(num) >= 1000000)\n        return intlFormat(num / 1000000) + 'M';\n    if (Math.abs(num) >= 1000)\n        return intlFormat(num / 1000) + 'k';\n    return intlFormat(num);\n}\n\nexport function loadJSONData(url) {\n    return fetch(url)\n        .then(\n            function (response) {\n                if (response.status !== 200) {\n                    console.log('Looks like there was a problem. Status Code: ' + response.status);\n                    return;\n                }\n                // Examine the text in the response\n                //    response.text().then(function(data){\n                //        console.log(data)\n                //    })\n                return response.json().then(function (data) {\n                    return data\n                });\n            }\n        )\n        .catch(function (err) {\n            console.log('Fetch Error :-S', err);\n        });\n}\n\nexport function ColorArray() {\n    let colorArray = [\n        \"#1f78b4\",\n        \"#b2df8a\",\n        \"#33a02c\",\n        \"#fb9a99\",\n        \"#e31a1c\",\n        \"#fdbf6f\",\n        \"#ff7f00\",\n        \"#6a3d9a\",\n        \"#cab2d6\",\n        \"#ffff99\",\n        \"#8fff4f\"\n    ]\n    return colorArray\n}\n\n\nexport function ColorArrayRGB() {\n    let colorArray = [\n        [141, 211, 199],\n        [255, 255, 179],\n        [190, 186, 218],\n        [251, 128, 114],\n        [128, 177, 211],\n        [253, 180, 98],\n        [179, 222, 105],\n        [252, 205, 229],\n        [188, 128, 189],\n        [204, 235, 197],\n    ]\n    return colorArray\n}\n\nexport function checkInView(container, element, partial, containerOffset, elementOffset) {\n\n    if (container) {\n        //Get container properties\n        let cTop = container.scrollTop;\n        let cBottom = cTop + container.clientHeight + containerOffset;\n\n        //Get element properties\n        let eTop = element.offsetTop + elementOffset;\n        let eBottom = eTop + element.clientHeight;\n\n        //Check if in view    \n        let isTotal = (eTop >= cTop && eBottom <= cBottom);\n        let isPartial = partial && (\n            (eTop < cTop && eBottom > cTop) ||\n            (eBottom > cBottom && eTop < cBottom)\n        );\n\n        //Return outcome\n        // console.log(\"cT:\", cTop, \"conHei\", container.clientHeight, \" offset\", containerOffset, elementOffset, container.offsetTop)\n        // console.log(element.offsetTop, \"eT:\", eTop, \"cT:\", cTop, \"eB:\", eBottom, \"cB:\", cBottom, isTotal || isPartial)\n        return (isTotal || isPartial);\n    } else {\n        return false\n    }\n\n\n}\n\nexport const LeaderLine = window.LeaderLine;\nexport const animOptions = { duration: 800, timing: 'ease' }\nexport const greyColor = \"rgba(189, 195, 199, 0.5)\"\nexport const blueColor = 'rgba(0,98,255, 1)'\n","/**\n * @license\n * Copyright 2019 Victor Dibia. https://github.com/victordibia\n * Anomagram - Anomagram: Anomaly Detection with Autoencoders in the Browser.\n * Licensed under the MIT License (the \"License\"); \n * =============================================================================\n */\n\nimport React, { Component } from \"react\";\nimport { LeaderLine, animOptions } from \"../helperfunctions/HelperFunctions\"\nimport { Add16, Subtract16 } from '@carbon/icons-react';\nimport \"./composemodel.css\"\nimport * as _ from \"lodash\"\n\nclass ComposeModel extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            hiddenDims: this.props.hiddenDims,\n            latentDim: this.props.latentDim,\n            maxLayers: 10,\n            minLayers: 1,\n            maxUnits: 9,\n            minUnits: 2,\n            defaultLayerDim: 3,\n            isTraining: this.props.isTraining,\n            lineWidth: 1.5,\n            latentLineWidth: 2.5,\n            animationDuration: 350\n        }\n\n        this.lineHolder = []\n\n        this.rightTopAnchor = { x: \"100%\", y: \"5%\" }\n        this.rightBottomAnchor = { x: \"100%\", y: \"95%\" }\n        this.leftTopAnchor = { x: 0, y: \"5%\" }\n        this.leftBottomAnchor = { x: \"0%\", y: \"95%\" }\n        this.rightMiddle = { x: \"100%\", y: \"50%\" }\n        this.leftMiddle = { x: \"0%\", y: \"50%\" }\n\n\n        this.blueColor = \"rgba(0, 0, 255, 0.89)\"\n        this.greyColor = \"grey\"\n\n        this.isUpdatable = this.props.isUpdatable\n    }\n    componentDidMount() {\n        this.drawAllLines();\n    }\n\n\n    getElement(network, attributeName, attributeValue) {\n        return document.querySelector(\"div.\" + network).querySelector(\"[\" + attributeName + \"=\" + attributeValue + \"]\")\n    }\n\n    addLayerLines(network, layer) {\n        if ((layer * 1) !== (this.state.hiddenDims.length - 1)) {\n            let startId = \"layerdiv\" + layer;\n            let endId = \"layerdiv\" + (layer * 1 + 1);\n            let startEl = this.getElement(network, \"layerdiv\", startId)\n            let endEl = this.getElement(network, \"layerdiv\", endId)\n            // console.log(startEl, endEl);\n            let params = { pathType: \"straight\", startId: startId, endId: endId, network: network }\n            this.drawLeaderLine(startEl, endEl, network === \"encoder\" ? this.rightTopAnchor : this.leftTopAnchor, network === \"encoder\" ? this.leftTopAnchor : this.rightTopAnchor, params)\n            this.drawLeaderLine(startEl, endEl, network === \"encoder\" ? this.rightTopAnchor : this.leftTopAnchor, network === \"encoder\" ? this.leftBottomAnchor : this.rightBottomAnchor, params)\n            this.drawLeaderLine(startEl, endEl, network === \"encoder\" ? this.rightBottomAnchor : this.leftBottomAnchor, network === \"encoder\" ? this.leftTopAnchor : this.rightTopAnchor, params)\n            this.drawLeaderLine(startEl, endEl, network === \"encoder\" ? this.rightBottomAnchor : this.leftBottomAnchor, network === \"encoder\" ? this.leftBottomAnchor : this.rightBottomAnchor, params)\n        } else {\n            let startId = \"layerdiv\" + layer;\n            let startEl = this.getElement(network, \"layerdiv\", startId)\n            // let encoderDiv = document.getElementById(\"mainencoderdiv\")\n            let latentDiv = document.getElementById(\"latentdiv\")\n            // let decoderDiv = document.getElementById(\"maindecoderdiv\")\n\n            let params = { pathType: \"arc\", startId: startId, endId: \"latent\", network: network }\n            this.drawLeaderLine(startEl, latentDiv, network === \"encoder\" ? this.rightMiddle : this.leftMiddle, network === \"encoder\" ? this.leftMiddle : this.rightMiddle, params)\n\n        }\n    }\n    addEncDecLines(layer) {\n        this.addLayerLines(\"encoder\", layer)\n        this.addLayerLines(\"decoder\", layer)\n    }\n    drawAllLines() {\n        // Add connector lines for encoder decoder \n        for (const layer in this.state.hiddenDims) {\n            this.addEncDecLines(layer)\n\n        }\n    }\n\n\n    removeLayerLines(lineId) {\n\n        // Remove lines associated with a deleted layer\n        // Remove it from the DOM and also from the holder array  \n        let toRemove = new Map()\n        this.lineHolder.forEach(function (each, i) {\n            if (each.startId === lineId || each.endId === lineId) {\n                each.line.remove()\n                toRemove.set(i, \"dot\")\n            } else {\n                each.line.position()\n            }\n        })\n\n        // Remove lines queued up for deletion\n        let newHolder = []\n        this.lineHolder.forEach(function (each, i) {\n            if (toRemove.get(i) == null) {\n                newHolder.push(each)\n            }\n        });\n\n\n        // console.log(\"old\", this.lineHolder.length, newHolder.length);\n        this.lineHolder = newHolder\n    }\n\n\n    drawLeaderLine(startElement, endElement, startAnchor, endAnchor, params) {\n\n        let lineColor = this.state.isTraining ? \"grey\" : \"rgba(0, 0, 255, 0.89)\"\n        let lineWidth = this.state.lineWidth\n        let plugType = \"disc\"\n\n        let line = new LeaderLine(\n            LeaderLine.pointAnchor(startElement, startAnchor),\n            LeaderLine.pointAnchor(endElement, endAnchor), {\n            color: lineColor,\n            startPlug: plugType,\n            endPlug: plugType,\n            startPlugColor: lineColor,\n            path: params.pathType,\n            size: lineWidth,\n            hide: true,\n            // dash: { gap: 2, animation: params.endId === \"latent\" ? this.state.isTraining : false }\n            dash: { gap: 3 }\n        });\n        // document.querySelector('.leader-line').style.zIndex = -100\n        animOptions.duration = this.state.animationDuration\n        line.show(\"draw\", animOptions)\n        this.lineHolder.push({ line: line, startId: params.startId, endId: params.endId, network: params.network })\n    }\n\n\n    removeAllLines(line) {\n        this.lineHolder.forEach(function (each) {\n            each.line.remove()\n        })\n        this.lineHolder = []\n    }\n\n    redrawAllLines() {\n        this.lineHolder.forEach(function (each) {\n            each.line.position();\n        })\n    }\n\n\n    redrawLine(lineId) {\n        this.lineHolder.forEach(function (each) {\n            if (each.startId === lineId || each.endId === lineId) {\n                // each.line.color = \"red\"\n                each.line.hide(\"none\")\n                each.line.show(\"draw\", animOptions)\n                each.line.position();\n            } else {\n                each.line.position();\n            }\n        })\n    }\n\n    animateLines() {\n        // let self = this\n        let color = this.state.isTraining ? this.greyColor : this.blueColor\n        // console.log(self.props.isTraining);\n        let opt = {\n            color: color,\n            startPlugColor: color\n        }\n\n        this.lineHolder.forEach(function (each) {\n            each.line.setOptions(opt)\n        })\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n\n        // Handle addition of a new node/unit in a layer \n        for (const i in this.state.hiddenDims) {\n            if (this.state.hiddenDims[i] !== prevState.hiddenDims[i]) {\n                this.redrawLine(\"layerdiv\" + i)\n                this.props.updateModelDims(this.state.hiddenDims, this.state.latentDim)\n\n            }\n        }\n\n        // Handle layer addition or removal \n        if (this.state.hiddenDims.length > prevState.hiddenDims.length) {\n            this.removeLayerLines(\"latent\")\n            this.addEncDecLines(this.state.hiddenDims.length - 2)\n            this.addEncDecLines(this.state.hiddenDims.length - 1)\n        } else if (this.state.hiddenDims.length < prevState.hiddenDims.length) {\n            this.removeLayerLines(\"layerdiv\" + this.state.hiddenDims.length)\n            this.addEncDecLines(this.state.hiddenDims.length - 1)\n\n        }\n\n\n        if (prevState.isTraining !== this.props.isTraining) {\n            // console.log(\"training toggled\");\n            this.setState({ isTraining: this.props.isTraining })\n            this.animateLines()\n\n        }\n\n        // Update parent state once dims change\n        if (this.state.hiddenDims.length !== prevState.hiddenDims.length || this.state.latentDim[0] !== prevState.latentDim[0]) {\n            // console.log(\"latent or hidden changed\");\n\n            this.props.updateModelDims(this.state.hiddenDims, this.state.latentDim)\n        }\n\n\n        if (prevProps.adv !== this.props.adv) {\n            this.redrawAllLines();\n        }\n\n    }\n\n    componentWillUnmount() {\n        this.removeAllLines()\n    }\n\n\n\n    setStateVal(varGroup, newDims) {\n        if (varGroup + \"\" === \"encoder\") {\n            this.setState({ hiddenDims: newDims })\n        } else if (varGroup + \"\" === \"decoder\") {\n            this.setState({ decoderDims: newDims })\n        } else if (varGroup + \"\" === \"latent\") {\n            this.setState({ latentDim: newDims })\n        }\n    }\n\n    getDims(dimType) {\n        switch (dimType) {\n            case \"encoder\":\n                return this.state.hiddenDims.slice()\n            case \"decoder\":\n                return this.state.decoderDims.slice()\n            case \"latent\":\n                return this.state.latentDim.slice()\n            default:\n                break\n        }\n    }\n\n\n\n\n    updateLayerClick(e) {\n\n\n        let currentDims = this.getDims(e.target.getAttribute(\"layergroup\"));\n\n        if (e.target.getAttribute(\"buttonaction\") === \"add\") {\n\n            if (currentDims.length + 1 <= this.state.maxLayers) {\n                currentDims.push(this.state.defaultLayerDim)\n                this.setStateVal(e.target.getAttribute(\"layergroup\"), currentDims)\n            }\n\n        } else {\n\n            if (currentDims.length - 1 >= this.state.minLayers) {\n                currentDims.pop()\n                this.setStateVal(e.target.getAttribute(\"layergroup\"), currentDims)\n            }\n        }\n    }\n\n\n    updateUnits(e) {\n\n        // Update state variables for dimension units\n        let currentDims = this.getDims(e.target.getAttribute(\"layergroup\"));\n        let currentUnit = currentDims[e.target.getAttribute(\"unitindex\") * 1]\n        // console.log(e.target.getAttribute(\"unitindex\"), currentUnit);\n        if (e.target.getAttribute(\"buttonaction\") === \"add\") {\n\n            if (currentUnit + 1 <= this.state.maxUnits) {\n                currentDims[e.target.getAttribute(\"unitindex\") * 1] = currentUnit + 1\n                this.setStateVal(e.target.getAttribute(\"layergroup\"), currentDims)\n            }\n\n        } else {\n\n            if (currentUnit - 1 >= this.state.minUnits) {\n                currentDims[e.target.getAttribute(\"unitindex\") * 1] = currentUnit - 1\n                this.setStateVal(e.target.getAttribute(\"layergroup\"), currentDims)\n            }\n\n        }\n    }\n\n    nodeHover(e) {\n        console.log(e.target.getAttribute(\"nodeunit\"));\n\n    }\n\n\n    render() {\n\n        let latentLayers = this.state.latentDim.map((data, layerindex) => {\n            let eachLayer = _.range(data).map((unitindex) => {\n                return (\n                    <div className={\"eachunitbox \" + (this.state.isTraining ? \" unitgrey\" : \" unitblue\")} key={\"eachunit\" + unitindex}>\n                        {/* {index} */}\n                    </div>\n                )\n            })\n            return (\n                <div key={\"latentlayer\" + layerindex} className=\" h100 flex flexfull flexjustifycenter \">\n                    <div className=\" mwc flex flexjustifycenter mb5 mt5 \">\n                        <div className=\"\" >\n                            <div className=\"smalldesc mb3 unselectable latentunittitle\">{data} units</div>\n                            <div\n                                layergroup=\"latent\"\n                                unitindex={layerindex}\n                                buttonaction=\"add\"\n                                onClick={this.updateUnits.bind(this)}\n                                className={\"updatebutton unselectable mb3 clickable \" + ((data === this.state.maxUnits || !this.isUpdatable) ? \" disabled unclickable \" : \"\")}>\n                                <Add16 className=\"unclickable\"></Add16>\n                            </div>\n                            <div id=\"latentdiv\" className=\"layerdiv  pt3 mb3\">{eachLayer}</div>\n                            <div\n                                layergroup=\"latent\"\n                                unitindex={layerindex}\n                                buttonaction=\"subtract\"\n                                onClick={this.updateUnits.bind(this)}\n                                className={\"updatebutton unselectable  clickable \" + ((data === this.state.minUnits || !this.isUpdatable) ? \" disabled unclickable \" : \"\")}>\n                                <Subtract16 className=\"unclickable\"></Subtract16>\n                            </div>\n                        </div>\n                    </div>\n\n                </div>\n            )\n        })\n\n        let encLayers = this.state.hiddenDims.map((data, layerindex) => {\n\n            let eachLayer = _.range(data).map((unitindex) => {\n                // console.log(\"layerunit\" + layerindex + unitindex)\n                return (\n                    <div nodeunit={\"layerunit\" + layerindex + unitindex} ref={\"layerunit\" + layerindex + unitindex} className={\"eachunitbox \" + (this.state.isTraining ? \" unitgrey\" : \" unitblue\")} key={\"eachunit\" + unitindex}></div>\n                )\n            })\n            return (\n                <div key={\"enclayer\" + layerindex} className=\"iblock encdecbox  mr10 flex flexfull flexjustifycenter \">\n                    <div className=\"iblock    mb5 mt5\">\n                        <div className=\"smalldesc mb3 unselectable \">{data} units</div>\n                        <div\n                            layergroup=\"encoder\"\n                            unitindex={layerindex}\n                            buttonaction=\"add\"\n                            onClick={this.updateUnits.bind(this)}\n                            className={\"updatebutton unselectable mb3 clickable \" + ((data === this.state.maxUnits || !this.isUpdatable) ? \" disabled unclickable \" : \"\")}>\n                            <Add16 className=\"unclickable\"> </Add16>\n                        </div>\n                        <div layerdiv={\"layerdiv\" + layerindex} className=\"layerdiv  pt3 mb3\">{eachLayer}</div>\n                        <div\n                            layergroup=\"encoder\"\n                            unitindex={layerindex}\n                            buttonaction=\"subtract\"\n                            onClick={this.updateUnits.bind(this)}\n                            className={\"updatebutton unselectable mb3 clickable \" + ((data === this.state.minUnits || !this.isUpdatable) ? \" disabled unclickable \" : \"\")}>\n                            <Subtract16 className=\"unclickable\"></Subtract16>\n                        </div>\n\n\n                    </div>\n                </div >\n            )\n        })\n\n        // console.log(encLayers.length);\n        let decLayers = _.reverse(_.clone(encLayers));\n\n        return (\n            <div className=\"mb10 \">\n\n                {/* Layer controls */}\n\n                <div className=\"flex w100 mb5 \">\n                    {/* <div className=\"mediumdesc mb5 mt5 mr10\"> * we map the same configuration for both encoder and decoder </div> */}\n                    <div className=\"flex5 \">\n                        <div className=\"smalldesc networktitle  p5\"> Encoder {this.state.hiddenDims.length} Layers </div>\n                    </div>\n                    {this.props.isUpdatable && <div className=\"buttonbar mr10 ml10 \">\n                        <div\n                            layergroup=\"encoder\"\n                            buttonaction=\"add\"\n                            onClick={this.updateLayerClick.bind(this)}\n                            className={\"updatebutton unselectable mr5 clickable \" + (this.state.hiddenDims.length === this.state.maxLayers || !this.isUpdatable ? \" disabled unclickable \" : \"\")}>\n                            <Add16 className=\"unclickable\"></Add16>\n                        </div>\n                        <div\n                            layergroup=\"encoder\"\n                            buttonaction=\"subtract\"\n                            onClick={this.updateLayerClick.bind(this)}\n                            className={\"updatebutton unselectable  clickable \" + (this.state.hiddenDims.length === this.state.minLayers || !this.isUpdatable ? \" disabled unclickable \" : \"\")}>\n                            <Subtract16 className=\"unclickable\"></Subtract16>\n                        </div>\n                    </div>}\n                    {!this.props.isUpdatable && <div> z </div>}\n                    <div className=\"unselectable flex5     \">\n                        <div className=\"flex p5 networktitle  mediumdesc \">\n                            <div className=\"flex flexjustifyleft \"> </div>\n                            <div className=\"flex flexfull flexjustifycenter   \"></div>\n                            <div className=\"smalldesc\"> Decoder {this.state.hiddenDims.length} Layers </div>\n                        </div>\n                    </div>\n                </div>\n\n                {/* Section titles */}\n                <div className=\"flex mb10 displaynone\">\n                    <div className=\"flex4 textaligncenter mediumdesc boldtext\"> Encoder </div>\n                    <div className=\"flex2 textaligncenter  mediumdesc boldtext\"> Bottleneck </div>\n                    <div className=\"flex4 textaligncenter  mediumdesc boldtext\"> Decoder </div>\n                </div>\n                {/* Encoder, bottleneck, Decoder  */}\n                <div className=\"flex\">\n                    <div className=\"iotextdata unselectable mr10 p5  \">\n                        input <span className=\"smalldesc\">[140 units]</span>\n                    </div>\n                    <div id=\"mainencoderdiv\" ref=\"encoderbox\" className=\"encoder greyhighlight  pl5 flex5 mr10 \">\n                        <div className=\"layerbar flex  flexjustifycenter pb10 pt10\">\n                            {encLayers}\n                        </div>\n\n                    </div>\n                    <div ref=\"latentbox\" className=\"bottlneck pr5 pl5   mr10 \">\n                        <div className=\"layerbar  h100  flex  flexjustifycenter  \">\n                            {latentLayers}\n                        </div>\n                    </div>\n                    <div id=\"maindecoderdiv\" ref=\"decoderbox\" className=\"decoder greyhighlight  pl5 flex5 \">\n                        <div className=\"layerbar flex   flexjustifycenter  pb10 pt10\">\n                            {decLayers}\n                        </div>\n                    </div>\n\n                    <div className=\"iotextdata unselectable ml10 p5  \">\n                        output <span className=\"smalldesc\">[140 units]</span>\n                    </div>\n\n                </div>\n\n            </div>\n        );\n    }\n}\n\nexport default ComposeModel;","/**\n * @license\n * Copyright 2019 Victor Dibia. https://github.com/victordibia\n * Anomagram - Anomagram: Anomaly Detection with Autoencoders in the Browser.\n * Licensed under the MIT License (the \"License\"); \n * =============================================================================\n */\n\nimport React, { Component } from \"react\";\nimport \"./histogram.css\"\nimport * as d3 from \"d3\"\n\nclass HistogramChart extends Component {\n\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            chart: this.props.data\n        }\n        this.minChartWidth = this.props.data.chartWidth\n        this.minChartHeight = this.props.data.chartHeight\n\n        this.numTicks = 40\n        this.xTicks = 7\n    }\n\n    componentDidMount() {\n\n        this.drawGraph(this.props.data.data)\n        // console.log(this.props.data); \n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        // console.log(prevProps.data.epoch, this.props.data.epoch)\n        if ((prevProps.data.epoch !== this.props.data.epoch) || (this.props.data.epoch + \"\" === \"0\" || this.props.data.threshold !== prevProps.data.threshold)) {\n            // console.log(\"props updated\");\n            this.updateGraph(this.props.data.data)\n        }\n\n    }\n\n\n    setupScalesAxes(data) {\n        // console.log(this.minChartWidth);\n\n        let self = this\n\n        this.chartMargin = { top: 10, right: 5, bottom: 55, left: 45 }\n        this.chartWidth = this.minChartWidth - this.chartMargin.left - this.chartMargin.right\n        this.chartHeight = this.minChartHeight - this.chartMargin.top - this.chartMargin.bottom;\n\n\n\n        this.xScale = d3.scaleLinear()\n            .domain(d3.extent(data, function (d) { return d.mse })).nice()\n            .range([this.chartMargin.left, this.chartWidth - this.chartMargin.right])\n\n        // All Bins\n        this.bins = d3.histogram()\n            .value(function (d) { return d.mse })\n            .domain(this.xScale.domain())\n            .thresholds(this.xScale.ticks(self.numTicks))(data)\n\n        // Normal Bins\n        this.binNorm = d3.histogram()\n            .value(function (d) {\n                if (d.label + \"\" === \"0\") {\n                    return d.mse\n                };\n            })\n            .domain(this.xScale.domain())\n            .thresholds(this.xScale.ticks(self.numTicks))(data)\n\n        // Abnormal Bins\n        this.binsAnorm = d3.histogram()\n            .value(function (d) {\n                if (d.label + \"\" === \"1\") {\n                    return d.mse\n                };\n            })\n            .domain(this.xScale.domain())\n            .thresholds(this.xScale.ticks(self.numTicks))(data)\n\n        // this.xScale = d3.scaleLinear()\n        //     .domain([0, n - 1]) // input\n        //     .range([0, this.chartWidth]); // output\n\n        this.yScale = d3.scaleLinear()\n            .domain([0, d3.max(self.bins, d => d.length)]).nice()\n            .range([this.chartHeight, 0])\n\n        this.xAxis = d3.axisBottom(this.xScale).ticks(this.xTicks)\n        this.yAxis = d3.axisRight(this.yScale)\n            .tickSize(this.minChartWidth)\n\n\n\n    }\n\n    updateGraph(data) {\n        let self = this\n        // console.log(data[0]);\n\n\n\n\n        this.setupScalesAxes(data)\n\n        let svg = d3.select(\"div.histogramchart\") //.transition();\n        // console.log(svg);\n\n        // // Abnormal Bins\n        svg.select(\".normcolor\")\n            .selectAll(\"rect\")\n            .data(self.binNorm)\n            .join(\"rect\")\n            .attr(\"x\", d => self.xScale(d.x0) + 1)\n            .attr(\"width\", d => Math.max(0, self.xScale(d.x1) - self.xScale(d.x0) - 1))\n            .attr(\"y\", d => self.yScale(d.length))\n            .attr(\"height\", d => self.yScale(0) - self.yScale(d.length))\n        // .transition();\n\n        svg.select(\".anormcolor\")\n            .selectAll(\"rect\")\n            .data(self.binsAnorm)\n            .join(\"rect\")\n            .attr(\"x\", d => self.xScale(d.x0) + 1)\n            .attr(\"width\", d => Math.max(0, self.xScale(d.x1) - self.xScale(d.x0) - 1))\n            .attr(\"y\", d => self.yScale(d.length))\n            .attr(\"height\", d => self.yScale(0) - self.yScale(d.length))\n\n        // Remove previous threshold line\n        // d3.select(\".thresholdline\").transition().duration(5500).style(\"opacity\", 0).remove()\n        // let thresholdVal = this.getThreshold(data)\n        svg.select(\".thresholdline\")\n            .attr(\"x1\", this.xScale(this.props.data.threshold))\n            .attr(\"x2\", this.xScale(this.props.data.threshold))\n\n        svg.select(\".thresholdtext\")\n            .attr(\"x\", this.xScale(this.props.data.threshold))\n            .text(\"Threshold - \" + this.props.data.threshold.toFixed(3));\n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\");\n            g.selectAll(\".tick text\").attr(\"x\", -20).attr(\"y\", -.01)\n        }\n\n        function customXAxis(g) {\n            g.call(self.xAxis);\n            g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"x\", 100)\n            g.selectAll(\".tick text\").attr(\"y\", 15)\n        }\n\n        svg.select(\".y.axis\")\n            .call(customYAxis);\n\n        svg.select(\".x.axis\")\n            .call(customXAxis);\n\n\n    }\n\n    getThreshold(data) {\n\n        let meanNormal = d3.mean(data, function (d) {\n            if (d.label + \"\" === \"0\") {\n                return d.mse\n            };\n        })\n\n        let meanAbnormal = d3.mean(data, function (d) {\n            if (d.label + \"\" === \"1\") {\n                return d.mse\n            };\n        })\n\n        let midPoint = (meanNormal + meanAbnormal) / 2\n        let walkBackPercentage = 0.2\n        let thresholdVal = Math.min(meanNormal, meanAbnormal) + (midPoint - Math.min(meanNormal, meanAbnormal)) * walkBackPercentage\n\n\n        return thresholdVal\n    }\n\n    drawGraph(data) {\n        let self = this\n        this.setupScalesAxes(data)\n        // console.log(data[0]);\n\n        const svg = d3.select(\"div.histogramchart\").append(\"svg\")\n            .attr(\"width\", this.chartWidth + this.chartMargin.left + this.chartMargin.right)\n            .attr(\"height\", this.chartHeight + this.chartMargin.top + this.chartMargin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + this.chartMargin.left + \",\" + this.chartMargin.top + \")\");\n\n\n\n        // normal histogram\n        svg.append(\"g\")\n            .attr(\"class\", \"normcolor\")\n            .selectAll(\"rect\")\n            .data(self.binNorm)\n            .join(\"rect\")\n            .attr(\"x\", d => self.xScale(d.x0) + 1)\n            .attr(\"width\", d => Math.max(0, self.xScale(d.x1) - self.xScale(d.x0) - 1))\n            .attr(\"y\", d => self.yScale(d.length))\n            .attr(\"height\", d => self.yScale(0) - self.yScale(d.length));\n\n        // Abnormal histogram\n        svg.append(\"g\")\n            .attr(\"class\", \"anormcolor\")\n            .selectAll(\"rect\")\n            .data(self.binsAnorm)\n            .join(\"rect\")\n            .attr(\"x\", d => self.xScale(d.x0) + 1)\n            .attr(\"width\", d => Math.max(0, self.xScale(d.x1) - self.xScale(d.x0) - 1))\n            .attr(\"y\", d => self.yScale(d.length))\n            .attr(\"height\", d => self.yScale(0) - self.yScale(d.length));\n\n        //add threshold line\n        // let thresholdVal = this.getThreshold(data)\n\n        // threshold line\n        svg.append(\"line\")\n            .attr(\"class\", \"thresholdline\")\n            .attr(\"x1\", this.xScale(this.props.data.threshold))  //<<== change your code here\n            .attr(\"y1\", this.yScale(0))\n            .attr(\"x2\", this.xScale(this.props.data.threshold))  //<<== and here\n            .attr(\"y2\", this.yScale(this.yScale.domain()[1]))\n        // threshold label\n        svg.append(\"text\")\n            .attr(\"class\", \"thresholdtext\")\n            .attr(\"x\", this.xScale(this.props.data.threshold))\n            .attr(\"y\", this.yScale(this.yScale.domain()[1]))\n            .attr(\"dy\", \".95em\")\n            .attr(\"dx\", \".35em\")\n            .text(\"Threshold - \" + this.props.data.threshold.toFixed(3));\n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\");\n            g.selectAll(\".tick text\").attr(\"x\", -20).attr(\"y\", -.01)\n        }\n\n        function customXAxis(g) {\n            g.call(self.xAxis);\n            g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"x\", 100)\n            g.selectAll(\".tick text\").attr(\"y\", 15)\n        }\n\n        // text label for the x axis\n        svg.append(\"text\")\n            .attr(\"transform\",\n                \"translate(\" + (this.chartWidth / 2) + \" ,\" +\n                (this.chartHeight + this.chartMargin.top + 43) + \")\")\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", \"axislabel x\")\n            .text(\"Mean Squared Error\");\n\n\n        // text label for the y axis\n        svg.append(\"text\")\n            .attr(\"transform\", \"rotate(-90)\")\n            .attr(\"y\", 0 - this.chartMargin.left)\n            .attr(\"x\", 0 - (this.chartHeight / 2))\n            .attr(\"dy\", \"1em\")\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", \"axislabel y\")\n            .text(\"Frequency\");\n\n        // 3. Call the x axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"x axis\")\n            .attr(\"transform\", \"translate(0,\" + (self.chartHeight + 10) + \")\")\n            .call(customXAxis); // Create an axis component with d3.axisBottom\n\n        // 4. Call the y axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"y axis\")\n            .call(customYAxis); // Create an axis component with d3.axisLeft\n\n    }\n\n    render() {\n        return (\n            <div className=\"positionrelative mainchartbox \">\n                <div className=\"chartlegend legendtopleft p5 mediumdesc\">\n                    <div className=\"mb3\"> <div className=\"legendcolorbox mr5  themeblue iblock\"></div> Normal </div>\n                    <div> <div className=\"legendcolorbox mr5 themeorange iblock\"></div> Abnormal </div>\n                </div>\n\n                <div className=\"histogramchart chartsvg\"></div>\n            </div>\n        );\n    }\n}\n\nexport default HistogramChart;","/**\n * @license\n * Copyright 2019 Victor Dibia. https://github.com/victordibia\n * Anomagram - Anomagram: Anomaly Detection with Autoencoders in the Browser.\n * Licensed under the MIT License (the \"License\"); \n * =============================================================================\n */\n\n\nimport React, { Component } from 'react'\nimport { Loading, Button, Slider } from 'carbon-components-react'; \nimport {StopFilledAlt16, PlayFilledAlt16} from '@carbon/icons-react';\nimport \"./viz.css\"\nimport LineChart from \"../linechart/LineChart\"\nimport SmallLineChart from \"../linechart/SmallLineChart\"\nimport DrawSignal from \"../drawsignal/DrawSignal\"\nimport ComposeModel from \"../composemodel/ComposeModel\"\nimport HistogramChart from \"../histogram/HistogramChart\"\nimport {registerGAEvent, computeAccuracyGivenThreshold, percentToRGB } from \"../helperfunctions/HelperFunctions\" \nimport * as _ from \"lodash\"\nimport * as tf from '@tensorflow/tfjs';\nimport * as d3 from \"d3\"\n\n \nclass Viz extends Component {\n    constructor(props) {\n        super(props)\n\n        this.modelChartWidth = Math.min(390, window.innerWidth - 25)\n        this.modelChartHeight = 270\n\n        // Allow the draw signal component update current signal with drawn signal\n        this.updateCurrentSignal = this.updateCurrentSignal.bind(this)\n \n\n        // Define the composition and amount of test data shown\n        this.testData = require(\"../../data/ecg/test_small.json\") \n        // let maxTestData = 50\n        // this.testData = this.subsetTestData(testData, maxTestData)\n        \n        // console.log(this.testData);\n        \n        \n        this.zeroArr = new Array(this.testData[0].data.length).fill(0);\n        this.trainMse = {\"threshold\":[0]}\n\n        //set state\n        this.state = {\n            apptitle: \"Anomagram\",\n            trainData: [],\n            selectedIndex: 0,\n            selectedData: this.testData[0].data,\n            showDrawData: false,\n            drawSectionWidth: 350,\n            drawSectionHeight: this.modelChartHeight ,\n            isLoading: false,\n            modelLoaded: false,\n            threshold: 0.0075,\n            predictedData: this.zeroArr,\n            predictedMse: 0,\n            selectedLegend: \"All\",\n            showAutoEncoderViz: true,\n            showMseViz:true,\n            isDataTransormed: false,\n            showBeforeTrainingHistogram: false,\n            trainVizEpoch: 0,\n            bestMetric: { acc: 0, fpr: 0, fnr: 0, tnr: 0, tpr: 0, threshold: 0, precision: 0, recall: 0 },\n            minThreshold: 0,\n            maxThreshold: 1,\n            vizThresold: this.trainMse[\"threshold\"][0],\n            histPlaying: false,\n            showError: false,\n            errorMsg: \"An error has occured.\"\n        }\n\n        this.currentEpoch = 0\n        // Hashmap storing test data legend metadata\n        this.chartColorMap = {\n            0: { color: \"white\", colornorm: \"grey\", name: \"All\" },\n            1: { color: \"#0062ff\", colornorm: \"#0062ff\", name: \"Normal\" },\n            2: { color: \"orange\", colornorm: \"grey\", name: \"R-on-T Premature Ventricular Contraction\" },\n            3: { color: \"violet\", colornorm: \"grey\", name: \"Ectopic Beat\" },\n            4: { color: \"indigo\", colornorm: \"grey\", name: \"Premature Ventricular Contraction\" },\n            // 5: { color: \"red\", colornorm: \"grey\", name: \"Unclassifiable Beat\" },\n        }\n\n        this.maxSmallChart = 100\n        this.modelDataLastUpdated = true\n\n\n        this.hiddenDim = [7, 3]\n        this.latentDim = [2]\n\n       \n\n        this.mseExplanations = {}\n        this.mseExplanations[\"0\"] = \"Model is untrained, both normal and abnormal data have similar value range and overlapping distributions.\"\n        this.mseExplanations[\"2\"] = \"Model is untrained, both normal and abnormal data have similar value range and overlapping distributions.\"\n        this.mseExplanations[\"5\"] = \"Model is getting better at reconstructing normal data resulting in smaller MSE for normal data points.\"\n        this.mseExplanations[\"25\"] = \"Both distributions are now separate. We can set a clear threshold that separates normal from abnormal data.\"\n        \n\n        this.smallChartHeight = 30\n        this.smallChartWidth = 80\n\n        this.smallChartxScale = d3.scaleLinear()\n            .domain([0, this.testData[0].data.length - 1]) // input\n            .range([0, this.smallChartWidth]); // output\n\n\n        this.smallChartyScale = d3.scaleLinear()\n            .domain([d3.min(this.testData[0].data), d3.max(this.testData[0].data)]) // input \n            .range([0, this.smallChartHeight]); // output\n         \n    }\n\n\n    \n\n    componentDidUpdate(prevProps, prevState) {\n\n\n    }\n\n\n    componentDidMount() { \n\n        this.setState({ drawSectionWidth: this.refs[\"datasection\"].offsetWidth - 5 })\n        this.drawSectionWidth = this.refs[\"datasection\"].offsetWidth -5 \n\n        // Load minmax data transformation parameters\n        this.xMinArray = require(\"../../data/ecg/transform/xmin.json\")\n        this.xMaxArray = require(\"../../data/ecg/transform/xmax.json\")\n        this.featureRange = require(\"../../data/ecg/transform/range.json\")\n        \n        this.sampleTestData = this.myStringify(this.applyTransform(this.testData[0].data.slice(0,50)))\n        this.sampleTransformedTestData = this.myStringify(this.testData[0].data.slice(0, 50)) \n        \n        \n        this.trainMse = require(\"../../data/viz/mse.json\")\n        this.setState({vizThresold:this.trainMse[\"threshold\"][0]})\n        this.computeAccuracyMetrics(this.trainMse[\"mse\"][49]) \n         \n        this.componentLoadedTime = (new Date()).getTime()\n\n        this.replayHistInterval = 200\n    }\n\n    myStringify(data) {\n        let result = \"\"\n        data.forEach(el => {\n            result += \" \" + el.toFixed(2) + \",  \"; \n        });\n        return result\n    }\n\n    componentWillUnmount() {\n        // window.removeEventListener(\"resize\", this.onWindowResize)\n        if (this.loadedModel) {\n            this.loadedModel.dispose()\n        }\n    }\n\n    applyTransform(data) {\n        let holder = []\n        for (let i = 0; i < data.length; i++) {\n            holder[i] = ((data[i] - this.xMinArray[i]) / (this.xMaxArray[i] - this.xMinArray[i])) * (this.featureRange[\"max\"] - this.featureRange[\"min\"]) + this.featureRange[\"min\"]\n        }\n        return holder\n    }\n\n    applyReverseTransform(data) {\n        let holder = []\n        for (let i = 0; i < data.length; i++) {\n            holder[i] = ((data[i] - this.featureRange[\"min\"]) / (this.featureRange[\"max\"] - this.featureRange[\"min\"])) * (this.xMaxArray[i] - this.xMinArray[i]) + this.xMinArray[i]\n        }\n        return holder\n    }\n\n\n\n\n    loadModel() {\n        this.setState({ isLoading: true }) \n        setTimeout(() => {\n            let modelPath = process.env.PUBLIC_URL + \"/webmodel/ecg/model.json\"\n            tf.loadLayersModel(modelPath)\n                .catch(() => {\n                    console.log(\"Failed to loadmodel\");\n                    this.setState({showError:true, errorMsg: \"Error fetching model. Please check internet connection and reload page.\"}) \n                })\n                .then((model) => {\n                if (model) {\n                    this.loadedModel = model\n                    this.setState({ modelLoaded: true, isLoading: false, showError: false })\n                    this.getPrediction(this.state.selectedData)\n                } else {\n                   \n                }\n               \n            });\n        }, 700);\n    }\n\n\n    // Get predictions for a selected data point\n    getPrediction(data) {\n\n        if (!this.state.modelLoaded) {\n            this.setState({ selectedData: data })\n            this.loadModel()\n        } else {\n            this.setState({ isLoading: true })\n\n            let transformedData = this.applyTransform(data) \n\n            // Get predictions  \n            const [mse, preds] = tf.tidy(() => {\n                let dataTensor = tf.tensor2d(transformedData, [1, 140])\n                let preds = this.loadedModel.predict(dataTensor, { batchSize: 8 })\n                return [tf.sub(preds, dataTensor).square().mean(1), preds]\n            })\n\n            mse.array().then(array => { \n                this.setState({ isLoading: false, predictedMse: array[0] })\n            });\n\n            preds.array().then(array => {\n                this.modelDataLastUpdated = !this.modelDataLastUpdated\n                this.setState({ selectedData: data, predictedData: this.applyReverseTransform(array[0]) }, () => {\n\n                })\n            });\n\n            mse.dispose()\n            preds.dispose()\n        }\n\n\n\n    }\n\n    computeAccuracyMetrics(data) { \n        let uniqueMse = _.uniq(_.map(data, 'mse'))   \n\n        let rocMetricHolder = [] \n\n        uniqueMse.forEach((each, i) => {\n            let metric = computeAccuracyGivenThreshold(data, each) \n            rocMetricHolder.push(metric)  \n        }); \n \n\n        let bestMetric = _.maxBy(rocMetricHolder, \"acc\")  \n        this.setState({ bestMetric: bestMetric })\n        this.setState({ minThreshold: _.min(uniqueMse) })\n        this.setState({ maxThreshold: _.max(uniqueMse) }) \n        \n    }\n\n    updateThreshold(e) { \n            let threshVal = this.state.minThreshold + (e.value / 100) * (this.state.maxThreshold - this.state.minThreshold)\n            let bestMetric = computeAccuracyGivenThreshold(this.trainMse[\"mse\"][49] , threshVal)\n             \n        this.setState({ bestMetric: bestMetric }) \n        this.setState({ vizThresold: threshVal })\n        \n        if (this.state.trainVizEpoch !== 49) {\n\n            this.setState({ trainVizEpoch: 49 , histPlaying:false})\n            \n        }\n\n    }\n\n\n\n    updateCurrentSignal(data) {\n        this.getPrediction(data)\n    }\n\n\n    clickDataPoint(e) {\n\n        registerGAEvent(\"introduction\", \"ecgdatapointclick\",  e.target.getAttribute(\"indexvalue\"), this.componentLoadedTime)\n        \n        this.lastclicked = \"model\"\n        let selectedData = this.testData[e.target.getAttribute(\"indexvalue\")].data\n        // set data and get predictions on click \n        this.setSelectedData(e.target.getAttribute(\"indexvalue\"), selectedData)\n\n    }\n\n    setSelectedData(index, data) {\n\n        this.setState({ selectedIndex: index }, () => {\n            this.getPrediction(data)\n        })\n    }\n\n      \n    setDatasetDraw(e) {\n        this.setState({ showDrawData: true })\n        this.setState({ drawSectionWidth: Math.max(this.refs[\"datasetexamplebox\"].offsetWidth -5 , 350)})\n        // console.log(this.refs[\"datasetexamplebox\"].offsetWidth); \n        registerGAEvent(\"introduction\", \"showdraw\",  \"showdraw\", this.componentLoadedTime)\n        \n    }\n    setDatasetECG(e) {\n        this.setState({ showDrawData: false })\n        registerGAEvent(\"introduction\", \"showdataset\",  \"showdataset\", this.componentLoadedTime)\n        // this.setSelectedData(0, this.testData[0].data) \n    }\n\n    clickLegend(e) { \n        this.setState({ selectedLegend: e.target.getAttribute(\"action\") })\n    }\n\n    toggelTransform(e) {\n        this.setState({ isDataTransormed: !this.state.isDataTransormed })\n        registerGAEvent(\"introduction\", \"transformdata\",  !this.state.isDataTransormed.toString(), this.componentLoadedTime)\n    }\n \n\n    updateTrainVizEpoch(e) {\n        this.setState({ trainVizEpoch: e.value, vizThresold: this.trainMse[\"threshold\"][e.value] })\n    }\n\n    replayUpdater() {\n        setTimeout(() => {\n            // this.currentEpoch  =  (this.currentEpoch + 1) % 49\n            // console.log(this.state.trainVizEpoch);\n            \n            if (this.state.histPlaying && this.state.trainVizEpoch < 49) {\n                this.setState({ trainVizEpoch: this.state.trainVizEpoch +1 , vizThresold: this.trainMse[\"threshold\"][this.state.trainVizEpoch +1]   })\n                this.replayUpdater()\n            } else {\n                this.setState({ histPlaying:false  })\n            }\n        }, this.replayHistInterval);\n    }\n\n    toggleVizHistPlaying(e) {\n        if (!this.state.histPlaying) {\n            this.setState({trainVizEpoch:0}, () =>{\n                this.replayUpdater()\n            })\n           \n        }\n        this.setState({histPlaying: !this.state.histPlaying})\n    }\n\n    render() {\n\n\n        let dataLegend = Object.entries(this.chartColorMap).map((data, index) => {\n            let color = data[1].color\n            let name = data[1].name\n            // console.log(name); \n            return (\n                <div action={name} onClick={this.clickLegend.bind(this)} className={\"iblock mr5 mb5 unselectable legendrow clickable\" + (this.state.selectedLegend === name ? \" active\" : \" \")} key={\"legendrow\" + index}>\n                    <div style={{ background: color }} className=\"unclickable indicatorcircle iblock mr5\"></div>\n                    <div className=\"iblock unclickable legendtext pl4 mediumdesc\"> {name}</div> \n                </div>\n            )\n        });\n\n        let dataLegendSmall = Object.entries(this.chartColorMap).map((data, index) => {\n            let color = data[1].color\n            let name =  data[1].name\n            // console.log(name); \n            return (\n                <div action={name}  className={\"iblock mr5  unselectable \" + (data[1].name === \"All\" || data[1].name === \"Normal\"  ? \" displaynone\" : \"\") } key={\"legendsmallrow\" + index}>\n                    <div style={{ background: color }} className=\"unclickable indicatorcircle iblock mr5\"></div>\n                    <div className=\"iblock unclickable legendtext mediumdesc\"> {name}</div> \n                </div>\n            )\n        });\n\n        let dataPoints = this.testData.slice(0, this.maxSmallChart)\n            .map((data, index) => {  \n                let isVisible = (this.state.selectedLegend === this.chartColorMap[this.testData[index].target].name) || this.state.selectedLegend === \"All\"\n                return (\n                    <div  indexvalue={index} onClick={this.clickDataPoint.bind(this)} key={\"testrow\" + index} className={\"mb5 p5 clickable  ecgdatapoint rad3 iblock mr5\" + (isVisible ? \" \" : \" displaynone \") + (this.state.selectedIndex + \"\" === index + \"\" ? \" active \" : \"\")}  targetval={data.target} >\n                        {/* <div  className=\"boldtext  unclickable iblock \"> */}\n                            <div  indexvalue={index}  className=\"unclickable positionrelative\">\n                                <div className=\"p3 indicatoroutrcircle  positionabsolute bottomright\">\n                                    <div style={{ background: this.chartColorMap[this.testData[index].target].color }} className=\"indicatorcircle \"></div>\n                                </div>\n                                <SmallLineChart\n                                    data={{\n                                        data: this.testData[index],\n                                        index: index,\n                                        color: this.chartColorMap[this.testData[index].target].colornorm,\n                                        chartWidth: this.smallChartWidth,\n                                        chartHeight: this.smallChartHeight,\n                                        xScale: this.smallChartxScale,\n                                        yScale: this.smallChartyScale\n                                    }}\n                                > </SmallLineChart>\n                            </div> \n                        {/* </div>  */}\n                    </div>\n                ) \n        });\n\n        let datasetExamples = (\n            <div className=\"flex\">\n                <div className=\"flex20 mr10\">\n                    <div className=\"mb5\">\n                        {dataLegend}\n                    </div>\n                    <div className=\"ecgdatabox scrollwindow\">\n                        {dataPoints}\n                    </div>\n                </div>\n                <div className=\"p10 greyhighlight displaynone\">\n                    Threshold ring implementation\n                </div>\n            </div>\n        )\n\n        let dataSketchPad = (\n            <div >\n                <DrawSignal\n                    width={this.state.drawSectionWidth}\n                    height={this.state.drawSectionHeight}\n                    updateCurrentSignal={this.updateCurrentSignal}\n                ></DrawSignal>\n            </div>\n        )\n        let barColor = this.state.predictedMse ? this.state.predictedMse > this.state.threshold ? \"#ff0000\" : \"#008000\" : \"#808080\"\n        let modelOutput = (\n            <div className=\"  modeloutputbox rad5 \">\n                {/* <div className=\"mb10 boldtext\"> Model Prediction</div> */}\n                <div className=\"flex  \">\n                    <div className=\"iblock \">\n                        <div ref=\"\" className=\"resetbox vizloadingbox\" style={{ opacity: (this.state.isLoading) ? 1 : 0, width: (this.state.isLoading) ? \"34px\" : \"0px\" }} >\n                            <Loading\n                                className=\" mr10\"\n                                active={true}\n                                small={true}\n                                withOverlay={false}\n                            > </Loading>\n                        </div>\n                    </div>\n                    <div className=\"iblock thresholdbox flex flexjustifycenter mr5 pl10 pr10 pt5 pb5\">\n                        <div>\n                        <div style={{fontSize:\"18px\"}} className=\"mediumdesc textaligncenter boldtext thresholdtext\">{this.state.predictedMse.toFixed(3) }</div>\n                        <div className=\"smalldesc textaligncenter mt5\">mse</div>\n                        </div>\n                    </div>\n                    <div className=\"flexfull  \">\n                        {this.testData.length > 0 &&\n                            <div className=\"mt5 mediumdesc \">\n                                {this.state.predictedMse !== 0 &&\n                                    <div className=\"mr10  \">\n                                        <div className=\"mr10 boldtext \">\n                                        MODEL PREDICTION :\n                                        \n                                        &nbsp;\n                                        {this.state.predictedMse > this.state.threshold ? \"ABNORMAL\" : \"NORMAL\"}\n                                            </div>\n\n                                        <div className=\"pt5 mediumdesc\">  Explanation:   [mse = {this.state.predictedMse.toFixed(3)}]  is \n                                        <strong>{this.state.predictedMse > this.state.threshold ? \" above \" : \" below\"}</strong> the <strong> {this.state.threshold.toFixed(3)}</strong> threshold \n                                    </div>\n                                    </div>\n                                }\n                                {this.state.predictedMse === 0 &&\n                                <div className=\"mr10  \">\n                                        <div className=\" boldtext \">\n                                        MODEL PREDICTION \n                                        </div> \n                                        <div className=\"pt5 mediumdesc\">\n                                        Select a signal or draw one!\n                                        </div>\n                                    </div>\n                            }\n                                <div style={{ backgroundColor: barColor }} ref=\"predictioncolordiv\" className=\"mt5  colorbox redbox\"></div>\n                            \n\n                            </div>\n                        }\n                    </div>\n                </div>\n                <div className=\"iblock \">\n                    <LineChart\n                        data={this.state.selectedData}\n                        predictedData={this.state.predictedData}\n                        predictedColor={barColor}\n                        index={this.state.selectedIndex}\n                        lastUpdated={this.modelDataLastUpdated}\n                        color={this.chartColorMap[this.testData[this.state.selectedIndex].target].colornorm}\n                        width={this.modelChartWidth}\n                        height={this.modelChartHeight}\n                    > </LineChart>\n                </div>\n            </div>\n        )\n\n        // if (this.refs[\"datasetexamplebox\"]) {\n        //     console.log(this.refs[\"datasetexamplebox\"].offsetWidth);\n        // } \n        \n        \n\n        return (\n            <div>  \n                <div className=\"mynotif mt10 h100 lh10  lightbluehightlight maxh16  mb10\">\n                    <div className=\"boldtext mb5\">  A Gentle Introduction to Anomaly Detection with Autoencoders</div>\n                    {this.state.apptitle} is an interactive visualization tool for exploring\n                    how a deep learning model can be applied to the task of anomaly detection (on stationary data).\n                    Given an ECG signal sample, an autoencoder model (running live in your browser) can predict if it is\n                     normal or abnormal. To try it out, <strong>click</strong> any of the test ECG signals from the ECG5000 dataset below,\n                    or better still, draw a signal to see the model's prediction!\n                    <div className=\" mediumdesc boldtext\">\n                        <span className=\"\"> Disclaimer: </span> This prototype is built for demonstration purposes only \n                        and is not intended for use in any medical setting.\n                    </div>\n                </div>\n\n                {this.state.showError && <div className=\"errordiv p10 mb10\"> \n                    {this.state.errorMsg}\n                </div>}\n\n\n                {!this.state.showDrawData && < div className=\"mediumdesc pb10 \"> <strong>Click</strong> on a data sample below to see the prediction of a trained autoencoder. </div>}\n                {this.state.showDrawData &&  <div className=\"mediumdesc pb10 \"> <strong>Draw</strong> a signal and view the autoencoders prediction. What types of signal shapes is it sensitive to? </div>}\n\n                <div className=\"mb10 lowerbar\">\n                    <div onClick={this.setDatasetECG.bind(this)} className={\"datasettab clickable iblock mr5 \" + (this.state.showDrawData ? \"\" : \" active\")}> ECG5000 Dataset</div>\n                    <div onClick={this.setDatasetDraw.bind(this)} className={\"datasettab clickable iblock mr10 \" + (this.state.showDrawData ? \" active\" : \" \")}> Draw your ECG data</div>\n \n                </div>\n\n                <div className=\"flex flexwrap \">\n\n                    <div ref=\"datasection\" className=\" flexwrapitem  flex40 mr10 \" >\n                        {<div ref=\"datasetexamplebox\" className={\" \" + (this.state.showDrawData ? \" displaynone\" : \" \")}>\n                            {datasetExamples}\n                        </div>}\n                        {<div className={\" \" + (!this.state.showDrawData ? \" displaynone\" : \" \")}>\n                            {dataSketchPad}\n                        </div>}\n                    </div>\n \n                    <div className=\"flexwrapitem flex20 flex  \">\n                       <div > {modelOutput}</div>\n                        <div className=\"flex20 flexpushout \"></div>\n                    </div>\n                </div>\n\n                <div className=\"lh10 lightgreyback mt5 p10 \">\n                     \n                   The autoencoder is trained using normal ECG data samples. It has never seen any of the test signals above, \n                    but correcly predicts (most of the time) if a given signal is normal or abnormal. So, how does the autoencoder \n                    identify anomalies? Why is  <span className=\"italics\">mean squared error</span> a useful metric?\n                    What is the <span className=\"italics\">threshold</span>   and how is it set? Read on to learn more!\n                       \n                </div>\n\n\n\n                {\n                    <div className=\" \">\n\n                        <div className=\"\">\n                            <div className=\"flex\">\n                                <div className=\"flex20  lh10 mb10 \">\n                                    <div className=\"sectiontitle mt10 mb5\"> How does the Autoencoder work? </div>\n                                    \n                                    {this.state.showAutoEncoderViz &&\n                                        \n                                        <div className=\" pl10 floatright autoencodervizbox  \"  >\n                                        \n                                        <div className=\"vizcaption w380 mediumdesc lhmedium pb5\">\n                                        Example below shows the architecture of a two layer autoencoder with 7 and 3 units respectively.\n                                        Click the <span className=\"italics\">train a model</span> tab to build and train one from scratch.\n                                        </div>\n\n                                        <ComposeModel\n                                            hiddenDims={this.hiddenDim}\n                                            latentDim={[this.latentDim]}\n                                            isTraining={false}\n                                            isUpdatable={false}\n                                            updateModelDims={null}\n                                            adv={\"track\" + this.state.showDrawData}\n                                        />\n\n                                       \n                                    </div>}\n\n\n                                   \n\n                                    An <a href=\"https://en.wikipedia.org/wiki/Autoencoder\" target=\"_blank\" rel=\"noopener noreferrer\">Autoencoder</a> [1] is a type of\n                                    artificial neural network used to learn efficient (low dimensional) data representations in an unsupervised manner.\n                                    It is typically comprised of two components\n                                    - an <strong>encoder</strong> that learns to map input data to a low dimension representation ( <strong>also called a bottleneck, denoted by z</strong> )\n                                    and a <strong>decoder</strong> that learns to reconstruct the original signal from the\n                                    low dimension representation.\n                                    The training objective for the autoencoder model is to minimize the reconstruction\n                                    error - the difference between the input data and the reconstructed output.\n                                    \n                                    <div className=\"boldtext  pt5\"> Applying Autoencoders for Anomaly Detection</div>\n                                    \n                                    <div className=\"lh10  p10 \"> \n                                        An anomaly (outlier, abnormality) is defined as an observation which deviates so much from \n                                        other observations as to arouse suspicions that it was generated by a different mechanism - Hawkins 1980.\n                                    </div>\n                                    \n                                    While autoencoder models have been widely applied for dimensionality reduction (similar to techniques such as PCA), \n                                    they can also be used for anomaly detection[3]. In fact, a few deep learning models that are comprised of encoders and decoders\n                                    (e.g. Sequence to Sequence Models[5] , Variational Autoencoders[2], Bidirectional GANs[4]), with some modifications, also work well for this task!\n                                    So, how is this all achieved?\n                                    <br/>\n                                    It turns out that if  we train the model on normal data (or data with very few abnormal samples), it  learns a \n                                    reconstruction function that works \n                                    well for <span className=\"italics\"> normal looking data  </span>(low reconstruction error)\n                                    and works poorly for abnormal data (high reconstruction error).\n                                    We can then use reconstruction error as a signal for anomaly detection.\n                                    <br />\n                                    In particular, if we visualize a histrogram of reconstruction errors generated by a trained autoencoder, we hopefully\n                                    will observe that the distribution of errors for normal samples is overall smaller and\n                                    markedly separate from the distribution of errors for abnormal data.\n                                    \n                                    <br />\n                                    <strong className=\"greycolor\"> Note</strong>: We may not always have labelled data, but we can can assume (given the rare nature of anomalies) that the majority of data points for most\n                                    anomaly detection use cases are normal. See the section below that discusses the impact of data composition (% of abnormal data) on model performance.\n\n                              \n                                    Click the <a className=\"italics\" href=\"#train\" rel=\"noopener noreferrer\">train a model</a> tab to\n                                    interactively build and train an autoencoder,  evaluate its performance and visualize the histogram of errors for normal and abnormal test data.\n\n                                </div>\n\n\n                            </div>\n\n                        </div>\n\n\n                        <div className=\"sectiontitle mt10 mb5\"> The Dataset  </div>\n                        <div className=\"mb10 lh10\">\n                            This prototype uses the   <a href=\"http://www.timeseriesclassification.com/description.php?Dataset=ECG5000\" target=\"_blank\" rel=\"noopener noreferrer\"> ECG5000 dataset</a> which\n                            contains 5000 examples of ECG signals from a patient. Each data sample (corresponds to an extracted heartbeat containing 140 points) has been labelled as normal \n                            or being indicative of heart conditions related to congestive heart failure - {dataLegendSmall}.\n\n                        </div>\n                        <div className=\"\">\n                            <div className=\"flex lh10 flexwrap\">\n                                <div className=\"flex40 flexwrapitem  mb10 pr10\">\n                                    <div className=\"pb5 boldtext\"> Data Transformation  </div>\n                                    Prior to training the autoencoder, we first apply a minmax scaling transform to the input data \n                                    which converts it from its original range (-5 to 2) to a range of  (0 to 1)  \n                                    This is done for two main reasons. First, <a href=\"https://www.jeremyjordan.me/batch-normalization/\" target=\"_blank\" rel=\"noopener noreferrer\">existing   research</a>  suggests that neural networks in general train better when input values  \n                                     lie between 0 and 1 (or have zero mean and unit variance).  Secondly, scaling the data supports the learning objective \n                                    for the autoencoder (minimizing reconstruction error) and makes the results more interpretable. \n                                    In general, the range of output values from the autoencoder is dependent on the type of activation function used in the output layer.\n                                    For example, the tanh activation function outputs values in the range of -1 and 1, sigmoid outputs values in the range of 0 - 1 \n                                    In the example above, we use the sigmoid activation function in the output layer of \n                                    the autoencoder, allowing us directly compare the transformed input signal to the output data when computing the means square error metric during training.\n                                    In addition, having both input and output in the same range allows us to visualize the differences that contribute to the anomaly classification.\n                                    \n                                    <br />\n                                    <strong className=\"greycolor\"> Note:</strong> \n                                    The parameters of the scaling transform should be <a href=\" https://sebastianraschka.com/faq/docs/scale-training-test.html\" target=\"_blank\" rel=\"noopener noreferrer\"> computed only on train data</a> and \n                                     then <span className=\"italics\"> applied </span> to test data. \n                                    \n\n                            </div>\n                                <div className=\" flex20 flexwrapitem \">\n                                   <div className=\"vizcaption lhmedium pt10  mediumdesc pb10\">\n                                            Example below shows sample ECG data <span className=\"italics\">{this.state.isDataTransormed ? \"after \" : \"before\"}</span> minmax (0,1) scaling transformation.\n                                        </div>\n                                    <div className=\"flexfull  lh10 p10 overflowhidden  greyborder\">\n                                     \n                                        \n                                    {this.state.isDataTransormed ?  this.sampleTestData + \" ...\": this.sampleTransformedTestData + \" ...\" }\n                                \n                                        <div className = \"mt5 mr10\">\n                                            <Button\n                                                className=\"bwidthtransform\"\n                                            size={\"small\"}\n                                            renderIcon={null}\n                                            onClick={this.toggelTransform.bind(this)}\n                                        > {this.state.isDataTransormed ?  \"Inverse Transform\": \"Transform\"} </Button>\n\n                                        </div>\n                                    \n                                    </div> \n                                </div>\n\n\n                                <div className=\"border displaynone rad4 p10 \" style={{ width: \"300px\", height: \"300px\" }}>\n                                    Interactive replay of training run visualization\n                            </div>\n                            </div>\n                             \n\n                        </div>\n\n                        <div className=\"sectiontitle mt10 mb5\"> Model Implementation and Training </div>\n                        <div className=\"\">\n                            <div className=\"flex flexwrap8\">\n                                <div className=\"flex40 flexwrapitem8 lh10 mb10 \">\n                                  The autoencoder in this prototype (visualized above) has two layers in its encoder and decoder respectively.\n                                  It is implemented using the <a href=\"https://www.tensorflow.org/js/guide/layers_for_keras_users\" target=\"_blank\" rel=\"noopener noreferrer\">Tensorflow.js layers api </a> (similar to the keras api). \n                                     The encoder/decoder are specified   using dense layers, relu activation function, and \n                                     the Adam optimizer (lr = 0.01) is used for training. Given that each ECG data sample is comprised of 140 values, \n                                     both the encoder input vector  and decoder output layer are of size 140.\n                                        \n                                  <div className=\" mt10 mb10 lh10  lightbluehightlight maxh16   mb10\">\n                                     Tensorflow.js code for <a href=\"https://github.com/victordibia/anomagram/blob/master/app/src/components/train/models/ae.jsx\" target=\"_blank\" rel=\"noopener noreferrer\">specifying the autoencoder</a> can\n                                    be found in the project repository on <a href=\"https://github.com/victordibia/anomagram/\" target=\"_blank\" rel=\"noopener noreferrer\">Github</a>. \n                                  </div>\n                                      As training progresses, the model's weights are updated to minimize the difference between the encoder input \n                                      and decoder output for the training data (normal samples).  \n                                    <br/>\n                                    To illustrate the relevance of the training process to the anomaly detection task, we can visualize the \n                                    the histogram of reconstruction error generated by the model (see figure to the right). At initialization (epoch 0), the untrained autoencoder \n                                    has not learned to reconstruct normal data and hence makes fairly random guesses in its attempt\n                                    to reconstruct any input data - thus we see a similar distribution of errors for both normal and abnormal data.\n                                    As training progresses, the model gets better at reconstructing normal data, and its reconstruction error markedly \n                                    becomes smaller for normal samples leading to a distinct distribution for normal compared to abnormal data.\n\n                                    As both distributions <span className=\"italics\">diverge</span>, we can set a threshold or cutoff point; any data point \n                                    with error above this threshold is termed an anomaly and any data point below this is termed normal. \n                                    Using labelled test data (and some domain expertise), we can automatically determine this threshold as the point that yields the best \n                                    anomaly classification accuracy. \n                                    {/* For example, in the visualization on the right, the threshold is automatically set as the point */}\n                                    But is accuracy enough?\n                                  \n                              \n                            </div>\n\n                                {this.state.showMseViz &&\n                                    <div className=\"  pl10 flexwrapitem8  floatright\">\n\n                                    <div className=\"flex \">  \n                                        <div className=\"flexfull\"> \n                                            <div className=\"flex mb10\">\n                                                <div className=\" mr5\"> \n                                                    <div className=\"epochvalue textaligncenter\">\n                                                     {this.state.trainVizEpoch}\n                                                    </div>\n                                                    <div className=\"textaligncenter smalldesc\">\n                                                        Epoch\n                                                    </div>\n\n                                                </div>\n                                                <div className=\"flexfull \">\n                                                    <div className=\"mediumdesc w350   lhmedium\" > \n                                                            <span> Example below shows the histogram of errors during training epochs. At</span>\n                                                            <span className=\"boldtext\"> Epoch {this.state.trainVizEpoch}</span>, \n                                                            <span className=\"italics\" ref=\"mseexplanation\"> {this.mseExplanations[this.state.trainVizEpoch + \"\"] ? this.mseExplanations[this.state.trainVizEpoch + \"\"] : this.refs[\"mseexplanation\"].textContent}</span>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                            \n                                            \n                                            <div className=\"greyhighlight pl10 mb10 pt10 flex pb5\"> \n                                                \n                                                <div className=\" iblock \">\n                                                    <div\n                                                        onClick={this.toggleVizHistPlaying.bind(this)}\n                                                        className={(\"iblock circlemedium circlebutton ml10 mr5 flexcolumn flex flexjustifycenter clickable \") }>\n                                                        {!this.state.histPlaying && <PlayFilledAlt16 style={{ fill: \"white\" }} className=\"unselectable unclickable\" />}\n                                                        {this.state.histPlaying && <StopFilledAlt16 style={{ fill: \"white\" }} className=\"unselectable unclickable\" />}\n                                                    </div>\n                                                    <div className=\"smalldesc textaligncenter pt10 pb5 replaylabelbox\">  {this.state.histPlaying ? \"Stop Replay\" : \"Replay Training\"} </div>\n                                                </div>\n                                                    \n                                                    <Slider\n                                                    className=\"flexfull touchnoscroll border\"\n                                                    min={0} //{(this.state.minThreshold.toFixed(4) * 1)}\n                                                    max={49}//{(this.state.maxThreshold.toFixed(4) * 1)}\n                                                    step={1}\n                                                    minLabel={\"\"}\n                                                    maxLabel={\"\"}\n                                                    value={this.state.trainVizEpoch}\n                                                    stepMuliplier={10}\n                                                    // disabled={this.state.isTraining ? true : false}\n                                                    labelText={\"Move slider to view mse histogram at each epoch. \"}\n                                                    hideTextInput={true}\n                                                    onChange={this.updateTrainVizEpoch.bind(this)}\n                                                    />\n                                                \n                                            </div>\n                                           \n                                             \n                                        </div>\n\n                                    </div>\n                                    \n                                    \n                                    \n                                    {this.trainMse[\"mse\"] && <HistogramChart\n                                        data={{\n                                            data: this.trainMse[\"mse\"][this.state.trainVizEpoch],\n                                            chartWidth: 380,\n                                            chartHeight: 240,\n                                            epoch: 2 + this.state.trainVizEpoch,\n                                            threshold: this.state.vizThresold\n                                        }}\n                                    ></HistogramChart>}\n                                     \n                            </div>}\n                            </div>\n\n                        </div>\n\n\n                        <div className=\"sectiontitle mt10 mb5\"> Model Evaluation: Accuracy is NOT Enough </div>\n                        <div className=\"\">\n                            <div className=\"flex flexwrap\">\n                                <div className=\"flex40  flexwrapitem lh10 mb10 pr10\">\n                                    For most anomaly detection problems, data is usually imbalanced - the number of labelled normal samples vastly out number\n                                    abnormal samples. For example, for every 100 patients who take an\n                                    ECG test, <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3319226/\">less than 23 are likely</a> to have \n                                    some type of abnormal reading. This sort of data imbalance introduces issues that make accuracy \n                                    an inssufficient metric. Consider a naive model (actually a really bad model) \n                                    that simply flags every sample as normal. Given our ECG scenario above, it would have an accuracy of <strong> > 77%</strong> despite being a really unskilled model. \n                                    Clearly, accuracy alone does not \n                                    tell the complete story i.e. how often does the model flag an ECG as abnormal when it is indeed\n                                     abnormal (<strong>true positive</strong>), abnormal when it is normal (<strong>false positive</strong>)\n                                    normal when it is abnormal (<strong>false negative</strong>) and normal when it is indeed normal (<strong>true negative</strong>). \n                                     \n                                    Two important metrics can be applied to address these issues - precision aand recall. <strong>Precision</strong> expresses \n                                    the percentage of positive predictions that are correct\n                                    and is calculated as   (true positive / true positive + false positive ). <strong>Recall</strong> expresses the \n                                    proportion of actual positives that were corrected predicted (true positive / true positive + false negative).\n                                \n                                    <br/>\n                                    \n                                    Depending on the use case, it may be desirable to optimize a model's performance for high precision or high recall. \n                                    This tradeoff between precision and recall can be \n                                    adjusted by the selection of a threshold (e.g. a low enough threshold will yield excellent recall but reduced precision). \n                                    In addition, the Receiver Operating Characteristics (ROC) curve provides a visual assessment of a model's skill (area under the curve - AUC)\n                                    and is achieved by plotting the true positive rate against the false positive rate at various values of the threshold.\n                                     \n\n                            </div>\n\n                                <div className=\" p10 flex20 flexwrapitem\" >\n                                    \n\n                                    \n\n                                <div className={\"iblock perfmetrics w100 \" + (this.state.isTraining ? \" disabled \" : \" \")}>\n                            \n                                        <div className=\"mediumdesc lhmedium pb10\">\n                                            Example below the performance of a trained autoencoder model. \n                                            Move the slider to see how threshold choices impact precision recall metrics. \n                                            \n                                        </div>\n                                        \n\n                                        \n\n                            <div className=\"mb5 greyhighlight p10 touchnoscroll\">\n                                <Slider\n                                    className=\"w100 border\"\n                                    min={0} //{(this.state.minThreshold.toFixed(4) * 1)}\n                                    max={100}//{(this.state.maxThreshold.toFixed(4) * 1)}\n                                    step={2}\n                                    minLabel={\"%\"}\n                                    maxLabel={\"%\"}\n                                    value={((this.state.bestMetric.threshold - this.state.minThreshold) / (this.state.maxThreshold - this.state.minThreshold)) * 100}\n                                    stepMuliplier={10}\n                                    disabled={this.state.isTraining ? true : false}\n                                    labelText={\"Threshold \" + (this.state.bestMetric.threshold).toFixed(4) + \" [ \" + (((this.state.bestMetric.threshold - this.state.minThreshold) / (this.state.maxThreshold - this.state.minThreshold)) * 100).toFixed(0) + \" % ] \"}\n                                    hideTextInput={true}\n                                    onChange={this.updateThreshold.bind(this)}\n                                />\n                            </div>\n                            <div className=\"flex\">\n                                <div style={{ borderLeftColor: percentToRGB((this.state.bestMetric.acc * 100)) }} className=\"metricguage mb5  greyhighlight accuracybox  textaligncenter mr5 flex5\" >\n                                    <div className=\"metricvalue textaligncenter  rad4\"> {(this.state.bestMetric.acc * 100).toFixed(2)}  %</div>\n                                    <div className=\"metricdesc mediumdesc p5\"> Accuracy </div>\n                                </div>\n                                 \n\n                                <div style={{ borderLeftColor: percentToRGB((this.state.bestMetric.precision * 100)) }} className=\"metricguage mb5 greyhighlight  textaligncenter flex5\" >\n                                    <div className=\"metricvalue textaligncenter  rad4\"> {(this.state.bestMetric.precision ).toFixed(2)} </div>\n                                    <div className=\"metricdesc mediumdesc p5\"> Precision </div>\n                        </div>\n                        \n                        <div style={{ borderLeftColor: percentToRGB((this.state.bestMetric.recall * 100)) }} className=\"metricguage mb5 greyhighlight  textaligncenter flex5\" >\n                                    <div className=\"metricvalue textaligncenter  rad4\"> {(this.state.bestMetric.recall).toFixed(2)} </div>\n                                    <div className=\"metricdesc mediumdesc p5\"> Recall </div>\n                                </div>\n\n                            </div>\n                            <div className=\"mb5 flex\">\n\n                                <div style={{ borderLeftColor: percentToRGB(100 - (this.state.bestMetric.fpr * 100)) }} className=\"metricguage flex5 mr5  greyhighlight  textaligncenter\">\n                                    <div className=\"metricvalue textaligncenter\"> {(this.state.bestMetric.fpr * 100).toFixed(2)}  % </div>\n                                    <div className=\"metricdesc mediumdesc p5\"> False Positive Rate </div>\n                                </div>\n                                <div style={{ borderLeftColor: percentToRGB(100 - (this.state.bestMetric.fnr * 100)) }} className=\"metricguage flex5   greyhighlight  textaligncenter\">\n                                    <div className=\"metricvalue\"> {(this.state.bestMetric.fnr * 100).toFixed(2)} % </div>\n                                    <div className=\"metricdesc displayblock mediumdesc p5\"> False Negative Rate </div>\n                                </div>\n\n                            </div>\n                            <div className=\"flex\">\n                                <div style={{ borderLeftColor: percentToRGB((this.state.bestMetric.tpr * 100)) }} className=\"metricguage flex5  mr5 greyhighlight  textaligncenter\">\n                                    <div className=\"metricvalue\"> {(this.state.bestMetric.tpr * 100).toFixed(2)} % </div>\n                                    <div className=\"metricdesc mr10 mediumdesc p5\"> True Positive Rate </div>\n                                </div>\n                                <div style={{ borderLeftColor: percentToRGB((this.state.bestMetric.tnr * 100)) }} className=\"metricguage flex5  greyhighlight  textaligncenter\">\n                                    <div className=\"metricvalue\"> {(this.state.bestMetric.tnr * 100).toFixed(2)} % </div>\n                                    <div className=\"metricdesc mediumdesc p5\"> True Negative Rate </div>\n                                </div>\n                            </div>\n\n                        </div>\n                            </div>\n                            </div>\n\n                        </div>\n\n                        <div className=\"sectiontitle mt10 mb10\"> Some Insights on the Effect of Model/Training Parameters </div>\n                        <div className=\"mb10 lh10\">\n                        Some interesting insights that can be observed while modifying the training parameters for the model \n                        are highlighted below. You can explore them via the <span className=\"italics\"> train a model</span> interactive tab.\n                        </div>\n                        <div className=\"flex flexwrap\">\n \n\n                            <div className=\"flex20 flexwrapitem  mr10\">\n                                <div className=\"flex6 lh10 mb10 pr10\">\n                                    <div className=\"pb5 boldtext\"> Regularization, Optimizer, Batch Size </div>\n                                    Neural networks can approximate complex functions. They are also likely overfit, given limited data.\n                                    In this prototype, we have relatively few samples (2500 normal samples), and we can observe \n                                    signs of overfitting (train loss is less than validation loss). \n                                    Regularization (l1 and l2) can be an effective way to address this.\n                                    In addition, the choice of learning rate and optimizer can affect the speed and effectiveness \n                                    (time to peak performance) of training. For example using Adam reaches peak accuracy within fewer epochs compared to optimizers like rmsprop and good old sgd.\n                                    In the <span className=\"italics\"> train a model</span> interactive section, you can apply activation regularization - l1, l2 and l1l2 (regularization rate is set to learning rate) and observe its impact!\n                                    You can also try out 6 different optimizers (Adam, Adamax, Adadelta, Rmsprop,Momentum, Sgd), with various learning rates.\n                                </div>\n\n\n                            </div>\n\n                            \n                           \n\n                            <div className=\"flex20 flexwrapitem  mr10\">\n                                <div className=\"flex6 lh10 mb10 pr10\">\n                                    <div className=\"pb5 boldtext\"> Abnormal Percentage </div>\n                                    We may not always have labelled normal data to train a model.\n                                    However, given the rarity of anomalies (and domain expertise), we can assume that unlabelled data is mostly  \n                                    comprised of normal samples. Does model performance degrade with an changes in the percentage of abnormal samples in the dataset? \n                                    \n\n                                    The <span className=\"italics\"> train a model</span>  section, you can specify the percentage of abnormal samples  to include when \n                                    training the autoencoder model. We see that with <strong>0%</strong> abnormal data, the model AUC is <strong>~96%</strong>.\n                                   At <strong>30%</strong> abnormal sample composition, AUC drops to <strong>~93%</strong>. \n                                    At 50% abnormal datapoints, there is just not enough information in the data \n                                    that allows the model learn a pattern of normal behaviour. It essentially learns to reconstruct normal and abnormal \n                                    data equally well and mse is no longer a good measure of anomaly.\n                                    At this point, model performance is only slightly above random chance (AUC of 56%).\n \n                                </div>\n                            </div>\n                        </div>\n\n                        \n                        <div id=\"references\" className=\"sectiontitle mt10 mb5\"> Ok .. The Road to Production? </div>\n                        <div className=\"flexfull lh10 mb10 pr10\">\n                                There are a few important properties of the current dataset that make the autoencoder approach possible.\n                            First, while ECG is  <span className=\"italics\">time series</span>, the current dataset has been\n                            discretized i.e. chunked into fixed-size <span className=\"italics\">slices</span> of 140 values, where each slice constitutes\n                            a sample in the dataset. This discretization is performed using some domain knowledge (each set of 140 values corresponds to a heartbeat),\n                            making each sample comparable or identical. Next, we can also observe that the data is stationary - i.e. its mean and variance do not change with time. This way, it is more likely that \n                            the values being predicted at test time lie in the same range (distribution) as values seen during training.\n\n                            In order to move to production with your own data using the autoencoder approach discussed above, it is important that similar conditions are met - stationarity \n                            is handled (if it exists) and the dataset is constructed such that each sample is identical. \n                            {/* In some cases, it is also necessary that each sample is independent. */}\n\n                            <div className=\"pb5 boldtext mt10  \"> Model Serving </div> \n                            <div className=\"mb10\">\n                            For production purposes, there are a couple  options. First, we can integrate our \n                            Tensorflow.js model code (model.predict) <span className=\"italics\">as is</span> into a Node.js web server application.\n                            However, we will be using either the <a href=\"https://www.tensorflow.org/js/guide/nodejs#tensorflow_cpu\" target=\"_blank\" rel=\"noopener noreferrer\">Tensorflow.js CPU</a> backend\n                            which accelerates computation via the Tensorflow C binary, or the <a href=\"https://www.tensorflow.org/js/guide/nodejs#tensorflow_gpu\" target=\"_blank\" rel=\"noopener noreferrer\">Tensorflow.js GPU</a>  backend \n                            which accelerates computation via an available CUDA enabled GPU. This option makes sense for teams already heavily invested in the Nodejs stack.\n                            Our second option is to rewrite the model using the Keras API. The good part is that the Tensorflow.js (layers) api \n                            has an  <a href=\"https://www.tensorflow.org/js/guide/layers_for_keras_users\" target=\"_blank\" rel=\"noopener noreferrer\">almost 1:1almost 1:1</a>   mapping with the Keras API, making rewrites easy. A keras model can be served in \n                            production using <a href=\"https://www.tensorflow.org/tfx/tutorials/serving/rest_simple\" target=\"_blank\" rel=\"noopener noreferrer\">Tensorflow serving</a>  .\n\n                            </div>\n                            \n                            \n \n\n                                \n                        </div> \n                        \n\n                        <div id=\"references\" className=\"sectiontitle mt10 mb5\"> Closing Notes </div>\n                        <div className=\"flexfull lh10 mb10 pr10\">\n                                    In this prototype, we have considered the task of detecting anomalies in ECG data.\n                                    We used an autoencoder and demonstrate some fairly good results with minimal tuning. \n                                    We have also explored how and why it works. This and other \n                                    neural approaches (Sequence to Sequence Models, Variational Autoencoders, BiGANs etc) can be particularly \n                                    effective for anomaly detection with multivariate or high dimensional datasets \n                                    such as images (think convolutional layers instead of dense layers).\n                                    <br />\n                                    <strong className=\"greycolor\"> Note</strong>: A deep learning model\n                                    is not always the best tool for the job. Particularly, for univariate data (and low dimension data ) , autoregressive linear models \n                                    (linear regression, ARIMA family of models for time series, etc), Clustering (PCA, KMeans, etc), Nearest Neighbour (KNNs) can be very fast and effective. \n                                    \n                                    Interested in learning more about other deep learning approaches to anomaly detection? My colleagues and I cover additional details on this\n                                    topic in the upcoming <a href=\"http://experiments.fastforwardlabs.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Fast Forward Labs</a>  2020 report\n                                     on <a href=\"https://www.cloudera.com/products/fast-forward-labs-research.html\" target=\"_blank\" rel=\"noopener noreferrer\"> Deep Learning for Anomaly Detection.</a>  \n                                    \n                            </div> \n\n                        <div className=\"sectiontitle mt10 mb5\"> Further Reading </div>\n                        <div className=\"\">\n                                <div className=\" lh10 mb2  pr10\">\n                                 [1] Goodfellow, Ian, Yoshua Bengio, and Aaron Courville. MIT Press 2016 <a href=\"http://www.deeplearningbook.org/contents/autoencoders.html\" target=\"_blank\" rel=\"noopener noreferrer\">Deep learning. Chapter 14, Autoencoders</a>  \n                            </div> \n                            <div className=\" lh10 mb2 pr10\">\n                                 [2] An, J., & Cho, S. (2015). Variational autoencoder based anomaly detection using reconstruction probability. Special Lecture on IE, 2(1).\n                            </div> \n                            <div className=\" lh10 mb2 pr10\">\n                                [3] Zhou, Chong, and Randy C. Paffenroth. \"Anomaly detection with robust deep autoencoders.\" Proceedings of the 23rd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining. ACM, 2017.\n                            </div>\n                            <div className=\" lh10 mb2 pr10\">\n                                [4] Di Mattia, Federico, et al. \"A Survey on GANs for Anomaly Detection.\" arXiv preprint arXiv:1906.11632 (2019).\n                            </div>\n                            <div className=\" lh10 mb2 pr10\">\n                                [5] Malhotra, Pankaj, et al. \"LSTM-based encoder-decoder for multi-sensor anomaly detection.\" arXiv preprint arXiv:1607.00148 (2016).\n                            </div>\n                            \n                            \n                        </div>\n\n\n                    </div>\n                }\n\n\n\n\n\n\n                <div>\n                    {/* A VAE (an extension of an AE) can allow us generate sampled data without */}\n                </div>\n\n\n\n\n\n                <br />\n                <br />\n                <br />\n                <br />\n            </div>\n        )\n    }\n}\n\nexport default Viz","/**\n * @license\n * Copyright 2019 Victor Dibia. https://github.com/victordibia\n * Anomagram - Anomagram: Anomaly Detection with Autoencoders in the Browser.\n * Licensed under the MIT License (the \"License\"); \n * =============================================================================\n */\n\n\nimport React, { Component } from \"react\";\nimport \"./rocchart.css\"\nimport * as d3 from \"d3\"\n\n\nclass ROCChart extends Component {\n\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            chart: this.props.data\n        }\n        this.minChartWidth = this.props.data.chartWidth\n        this.minChartHeight = this.props.data.chartHeight\n\n        this.numTicks = 40\n        this.dotRadius = 1\n    }\n\n    componentDidMount() {\n        this.drawGraph(this.props.data.data)\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n\n\n        // if ((prevProps.data.isTraining !== this.props.data.isTraining)) {\n        //     console.log(\"props updated\");\n        //     this.updateGraph(this.props.data.data)\n        // }\n\n        if ((prevProps.data.epoch !== this.props.data.epoch) || this.props.data.epoch + \"\" === \"0\") {\n            this.updateGraph(this.props.data.data)\n        }\n    }\n\n    updateGraph(data) {\n        let self = this\n\n        d3.select(\"div.ROCChart\").selectAll(\".rocnode > *\").remove();\n\n        this.setupScalesAxes(data)\n        let svg = d3.select(\"div.ROCChart\").transition();\n\n        svg.select(\".rocline\")\n            .duration(self.animationDuration)\n            .attr(\"d\", this.rocLine(data)); // 11. Calls the line generator \n\n        svg.select(\".rocarea\")\n            .duration(self.animationDuration)\n            .attr(\"d\", this.rocArea(data)); // 11. Calls the line generator \n\n        d3.select(\"div.ROCChart\")\n            .select(\".rocnode\")\n            .selectAll(\"rocdot\")\n            .data(data)\n            .join(\"circle\")\n            .attr(\"cx\", function (d) { return self.xScale(d.fpr); })\n            .attr(\"cy\", function (d) { return self.yScale(d.tpr); })\n            .attr(\"r\", this.dotRadius)\n            .attr(\"class\", \"rocdot\")\n\n\n\n\n        // svg.select(\".lossvalcolor\")\n        //     .duration(self.animationDuration)\n        //     .attr(\"d\", this.valLine); // 11. Calls the line generator  \n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\");\n            g.selectAll(\".tick text\").attr(\"x\", -30).attr(\"y\", -.01)\n        }\n\n        function customXAxis(g) {\n            g.call(self.xAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"x\", 100)\n            g.selectAll(\".tick text\").attr(\"y\", 15)\n        }\n\n        svg.select(\".y.axis\")\n            .call(customYAxis);\n\n        svg.select(\".x.axis\")\n            .call(customXAxis);\n\n    }\n    setupScalesAxes(data) {\n        // console.log(data);\n\n        // let self = this \n        this.chartMargin = { top: 10, right: 10, bottom: 55, left: 55 }\n        this.chartWidth = this.minChartWidth - this.chartMargin.left - this.chartMargin.right\n        this.chartHeight = this.minChartHeight - this.chartMargin.top - this.chartMargin.bottom;\n\n\n        // this.xScale = d3.scaleLinear()\n        //     .domain([d3.min(data, function (d) { return d.fpr }),\n        //     d3.max(data, function (d) { return d.fpr })]) // input \n        //     .range([0, this.chartWidth]); // output\n        this.xScale = d3.scaleLinear()\n            .domain([0, 1]) // input \n            .range([0, this.chartWidth]); // output\n\n\n        // this.yScale = d3.scaleLinear()\n        //     .domain([d3.min(data, function (d) { return d.tpr }),\n        //     d3.max(data, function (d) { return d.tpr })]) // input \n        //     .range([this.chartHeight, 0])\n        this.yScale = d3.scaleLinear()\n            .domain([0, 1]) // input \n            .range([this.chartHeight, 0])\n\n        this.xAxis = d3.axisBottom(this.xScale)\n        this.yAxis = d3.axisRight(this.yScale)\n            .tickSize(this.minChartWidth)\n    }\n    drawLines(svg, data) {\n        let self = this\n\n        svg.append(\"path\")\n            .datum(data) // 10. Binds data to the line \n            .attr(\"class\", \"rocline roccolor\") // Assign a class for styling  \n            .attr(\"d\", this.rocLine); // 11. Calls the line generator \n\n\n        svg.append(\"path\")\n            .datum(data)\n            .attr(\"class\", \"rocarea\")\n            .attr(\"d\", this.rocArea);\n\n        svg.append(\"line\")\n            .attr(\"x1\", this.xScale(0))  //<<== change your code here\n            .attr(\"y1\", this.yScale(0))\n            .attr(\"x2\", this.chartWidth)  //<<== and here\n            .attr(\"y2\", this.yScale(this.yScale.domain()[1]))\n            .attr(\"class\", \"diagonal\")\n\n        svg.append('g')\n            .attr(\"class\", \"rocnode\")\n            .selectAll(\"rocdot\")\n            .data(data)\n            .join(\"circle\")\n            .attr(\"cx\", function (d, i) { return self.xScale(d.fpr) })\n            .attr(\"cy\", function (d) { return self.yScale(d.tpr) })\n            .attr(\"r\", this.dotRadius)\n\n\n        // svg.selectAll(\".rocdot\")\n        //     .data(data)\n        //     .join(\"circle\") // Uses the enter().append() method\n        //     .attr(\"class\", \"rocdot\") // Assign a class for styling\n        //     .attr(\"cx\", function (d, i) { return self.xScale(d.fpr) })\n        //     .attr(\"cy\", function (d) { return self.yScale(d.tpr) })\n        //     .attr(\"r\", 5)\n\n\n    }\n\n    drawGraph(data) {\n        let self = this\n\n        // data = [\n        //     { \"acc\": 0.7, \"threshold\": 1.2428572177886963, \"tp\": 3, \"tn\": 4, \"fp\": 3, \"fn\": 0, \"ton\": 7, \"top\": 3, \"tpr\": 1, \"fpr\": 0.42857142857142855, \"fnr\": 0, \"tnr\": 0.5714285714285714 },\n        //     { \"acc\": 0.5, \"threshold\": 1.2, \"tp\": 3, \"tn\": 2, \"fp\": 5, \"fn\": 0, \"ton\": 7, \"top\": 3, \"tpr\": 1, \"fpr\": 0.7142857142857143, \"fnr\": 0, \"tnr\": 0.2857142857142857 },\n        //     { \"acc\": 1, \"threshold\": 1.3, \"tp\": 3, \"tn\": 7, \"fp\": 0, \"fn\": 0, \"ton\": 7, \"top\": 3, \"tpr\": 1, \"fpr\": 0, \"fnr\": 0, \"tnr\": 1 },\n        //     { \"acc\": 0.7, \"threshold\": 1.9, \"tp\": 0, \"tn\": 7, \"fp\": 0, \"fn\": 3, \"ton\": 7, \"top\": 3, \"tpr\": 0, \"fpr\": 0, \"fnr\": 1, \"tnr\": 1 },\n        //     { \"acc\": 0.8, \"threshold\": 1.25, \"tp\": 3, \"tn\": 5, \"fp\": 2, \"fn\": 0, \"ton\": 7, \"top\": 3, \"tpr\": 1, \"fpr\": 0.2857142857142857, \"fnr\": 0, \"tnr\": 0.7142857142857143 },\n        //     { \"acc\": 0.8, \"threshold\": 1.8, \"tp\": 1, \"tn\": 7, \"fp\": 0, \"fn\": 2, \"ton\": 7, \"top\": 3, \"tpr\": 0.3333333333333333, \"fpr\": 0, \"fnr\": 0.6666666666666666, \"tnr\": 1 },\n        //     { \"acc\": 0.9, \"threshold\": 1.75, \"tp\": 2, \"tn\": 7, \"fp\": 0, \"fn\": 1, \"ton\": 7, \"top\": 3, \"tpr\": 0.6666666666666666, \"fpr\": 0, \"fnr\": 0.3333333333333333, \"tnr\": 1 },\n        //     { \"acc\": 0.6, \"threshold\": 1.2428570985794067, \"tp\": 3, \"tn\": 3, \"fp\": 4, \"fn\": 0, \"ton\": 7, \"top\": 3, \"tpr\": 1, \"fpr\": 0.5714285714285714, \"fnr\": 0, \"tnr\": 0.42857142857142855 }]\n\n\n        this.setupScalesAxes(data)\n\n        this.rocLine = d3.line()\n            .x(function (d, i) { return self.xScale(d.fpr); }) // set the x values for the line generator\n            .y(function (d) { return self.yScale(d.tpr); }) // set the y values for the line generator \n        // .curve(d3.curveMonotoneX) // apply smoothing to the line\n\n        this.rocArea = d3.area()\n            .x(function (d) { return self.xScale(d.fpr); })\n            .y0(this.chartHeight)\n            .y1(function (d) { return self.yScale(d.tpr); });\n\n\n\n\n        const svg = d3.select(\"div.ROCChart\").append(\"svg\")\n            .attr(\"width\", this.chartWidth + this.chartMargin.left + this.chartMargin.right)\n            .attr(\"height\", this.chartHeight + this.chartMargin.top + this.chartMargin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + this.chartMargin.left + \",\" + this.chartMargin.top + \")\");\n\n        this.drawLines(svg, data)\n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\");\n            g.selectAll(\".tick text\").attr(\"x\", -20).attr(\"y\", -.01)\n        }\n\n        function customXAxis(g) {\n            g.call(self.xAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"x\", 100)\n            g.selectAll(\".tick text\").attr(\"y\", 15)\n        }\n        // 3. Call the x axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"x axis\")\n            .attr(\"transform\", \"translate(0,\" + (self.chartHeight + 10) + \")\")\n            .call(customXAxis);\n        // Create an axis component with d3.axisBottom\n\n        // text label for the x axis\n        svg.append(\"text\")\n            .attr(\"transform\",\n                \"translate(\" + (this.chartWidth / 2) + \" ,\" +\n                (this.chartHeight + this.chartMargin.top + 43) + \")\")\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", \"axislabel x\")\n            .text(\"False Positive Rate\");\n\n\n        // text label for the y axis\n        svg.append(\"text\")\n            .attr(\"transform\", \"rotate(-90)\")\n            .attr(\"y\", 0 - this.chartMargin.left)\n            .attr(\"x\", 0 - (this.chartHeight / 2))\n            .attr(\"dy\", \"1em\")\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", \"axislabel y\")\n            .text(\"True Positive Rate\");\n\n\n\n        // 4. Call the y axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"y axis\")\n            .call(customYAxis); // Create an axis component with d3.axisLeft\n\n    }\n    render() {\n        // console.log(this.props.data.data[his.props.data.data].loss.toFixed(2));\n\n        return (\n            <div className=\"positionrelative mainchartbox \">\n                <div className=\"chartlegend legendtopright p5 mediumdesc \">\n                    <div className=\"mb3 \">\n                        <div className=\"legendcolorbox mr5  themeblue iblock\"></div>\n                        <div ref=\"trainlabel\" className=\"iblock boldtext mr5\"> Area : {this.props.data.auc.toFixed(2)}  </div>\n                        <div className=\"iblock \"> </div>\n                    </div>\n                    <div>\n                        <div className=\"legendcolorbox mr5 redchance iblock\"></div>\n                        <div ref=\"validationlabel\" className=\"iblock boldtext mr5\"> Chance</div>\n                        <div className=\"iblock \"></div>\n                    </div>\n                </div>\n\n\n                <div className=\"ROCChart chartsvg\"> </div>\n            </div>\n\n        );\n    }\n}\n\nexport default ROCChart;    ","/**\n * @license\n * Copyright 2019 Victor Dibia. https://github.com/victordibia\n * Anomagram - Anomagram: Anomaly Detection with Autoencoders in the Browser.\n * Licensed under the MIT License (the \"License\"); \n * =============================================================================\n */\n\n\nimport React, { Component } from \"react\";\nimport \"./scatterplot.css\"\nimport * as d3 from \"d3\"\n\n\nclass ScatterPlot extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            chart: this.props.data\n        }\n        this.minChartWidth = this.props.data.chartWidth\n        this.minChartHeight = this.props.data.chartHeight\n\n        this.numTicks = 40\n    }\n\n    componentDidMount() {\n\n\n        this.drawGraph(this.props.data.data)\n\n        // console.log(this.props.data);\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n\n        if ((prevProps.data.epoch !== this.props.data.epoch) || this.props.data.epoch + \"\" === \"0\") {\n            // console.log(\"props updated\");\n            this.updateGraph(this.props.data.data)\n        }\n\n    }\n\n    updateGraph(data) {\n        let self = this\n        // console.log(data[0]);\n\n        d3.select(\"div.scatterplotchart\").selectAll(\".scatternode > *\").remove();\n\n        this.setupScalesAxes(data)\n\n        let svg = d3.select(\"div.scatterplotchart\") //.transition();\n\n        // svg.selectAll(\"dot\").remove()\n\n        svg.select(\".scatternode\")\n            .selectAll(\"dot\")\n            .data(data)\n            .join(\"circle\")\n            .attr(\"cx\", function (d) { return self.xScale(d.x); })\n            .attr(\"cy\", function (d) { return self.yScale(d.y); })\n            .attr(\"r\", 2.5)\n            .attr(\"class\", d => {\n                if (d.label + \"\" === \"0\") {\n                    return \"normcolor\"\n                } else {\n                    return \"anormcolor\"\n                }\n            })\n\n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\");\n            g.selectAll(\".tick text\").attr(\"x\", -20).attr(\"y\", -.01)\n        }\n\n        function customXAxis(g) {\n            g.call(self.xAxis);\n            g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"x\", 100)\n            g.selectAll(\".tick text\").attr(\"y\", 15)\n        }\n\n        svg.select(\".y.axis\")\n            .call(customYAxis);\n\n        svg.select(\".x.axis\")\n            .call(customXAxis);\n\n\n\n    }\n    setupScalesAxes(data) {\n        // console.log(data);\n\n        // let self = this\n\n        this.chartMargin = { top: 10, right: 5, bottom: 55, left: 45 }\n        this.chartWidth = this.minChartWidth - this.chartMargin.left - this.chartMargin.right\n        this.chartHeight = this.minChartHeight - this.chartMargin.top - this.chartMargin.bottom;\n\n\n        this.xScale = d3.scaleLinear()\n            .domain([d3.min(data, function (d) { return d.x }), d3.max(data, function (d) { return d.x })]) // input  \n            .range([this.chartMargin.left, this.chartWidth - this.chartMargin.right])\n\n\n\n        this.yScale = d3.scaleLinear()\n            .domain([d3.min(data, function (d) { return d.y }), d3.max(data, function (d) { return d.y })]) // input  \n            .range([this.chartHeight, 0])\n\n        this.xAxis = d3.axisBottom(this.xScale)\n        this.yAxis = d3.axisRight(this.yScale)\n            .tickSize(this.minChartWidth)\n\n\n\n    }\n\n    drawGraph(data) {\n        let self = this\n        this.setupScalesAxes(data)\n\n        const svg = d3.select(\"div.scatterplotchart\").append(\"svg\")\n            .attr(\"width\", this.chartWidth + this.chartMargin.left + this.chartMargin.right)\n            .attr(\"height\", this.chartHeight + this.chartMargin.top + this.chartMargin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + this.chartMargin.left + \",\" + this.chartMargin.top + \")\");\n\n\n        svg.append('g')\n            .attr(\"class\", \"scatternode\")\n            .selectAll(\"dot\")\n            .data(data)\n            .join(\"circle\")\n            .attr(\"cx\", function (d) { return self.xScale(d.x); })\n            .attr(\"cy\", function (d) { return self.yScale(d.y); })\n            .attr(\"r\", 2.5)\n            .attr(\"class\", d => {\n                if (d.label + \"\" === \"0\") {\n                    return \"normcolor\"\n                } else {\n                    return \"anormcolor\"\n                }\n            })\n\n\n        // text label for the x axis\n        svg.append(\"text\")\n            .attr(\"transform\",\n                \"translate(\" + (this.chartWidth / 2) + \" ,\" +\n                (this.chartHeight + this.chartMargin.top + 43) + \")\")\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", \"axislabel x\")\n            .text(\"Dimension 1\");\n\n\n        // text label for the y axis\n        svg.append(\"text\")\n            .attr(\"transform\", \"rotate(-90)\")\n            .attr(\"y\", 0 - this.chartMargin.left)\n            .attr(\"x\", 0 - (this.chartHeight / 2))\n            .attr(\"dy\", \"1em\")\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", \"axislabel y\")\n            .text(\"Dimension 0\");\n\n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\")\n            g.selectAll(\".tick text\").attr(\"x\", -20).attr(\"y\", -.01)\n        }\n\n        function customXAxis(g) {\n            g.call(self.xAxis);\n            g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"x\", 100)\n            g.selectAll(\".tick text\").attr(\"y\", 15)\n        }\n        // 3. Call the x axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"x axis\")\n            .attr(\"transform\", \"translate(0,\" + (self.chartHeight + 10) + \")\")\n            .call(customXAxis); // Create an axis component with d3.axisBottom\n\n        // 4. Call the y axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"y axis\")\n            .call(customYAxis); // Create an axis component with d3.axisLeft\n\n    }\n    render() {\n        return (\n            <div className=\"positionrelative mainchartbox\">\n                <div className=\"chartlegend legendtopleft p5 mediumdesc\">\n                    <div className=\"mb3\"> <div className=\"legendcolorbox mr5  themeblue iblock\"></div> Normal </div>\n                    <div> <div className=\"legendcolorbox mr5 themeorange iblock\"></div> Abnormal </div>\n                </div>\n\n                <div className=\"scatterplotchart\"> </div>\n            </div>\n\n        );\n    }\n}\n\nexport default ScatterPlot;","/**\n * @license\n * Copyright 2019 Victor Dibia. https://github.com/victordibia\n * Anomagram - Anomagram: Anomaly Detection with Autoencoders in the Browser.\n * Licensed under the MIT License (the \"License\"); \n * =============================================================================\n */\n\n\nimport React, { Component } from \"react\";\nimport \"./losschart.css\"\nimport * as d3 from \"d3\"\n\n\nclass LossChart extends Component {\n\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            chart: this.props.data\n        }\n        this.minChartWidth = this.props.data.chartWidth\n        this.minChartHeight = this.props.data.chartHeight\n\n        this.numTicks = 40\n        this.dotRadius = 3.5\n    }\n\n    componentDidMount() {\n        this.drawGraph(this.props.data.data)\n        // console.log(this.props.data.data);\n\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if ((prevProps.data.epoch !== this.props.data.epoch) && this.props.data.data.length > 0) {\n            // console.log(\"props updated\");\n            this.updateGraph(this.props.data.data)\n            this.refs[\"trainlabel\"].innerHTML = this.props.data.data[this.props.data.data.length - 1].loss.toFixed(4)\n            this.refs[\"validationlabel\"].innerHTML = this.props.data.data[this.props.data.data.length - 1].val_loss.toFixed(4)\n            // console.log(this.props.data.data[0].loss, this.refs[\"trainlabel\"]);\n\n        }\n    }\n\n    updateGraph(data) {\n        let self = this\n\n        // d3.select(\"div.losschart\").selectAll(\".lossline\").remove();\n        // d3.select(\"div.losschart\").selectAll(\".pointdot\").remove();\n\n        this.setupScalesAxes(data)\n        let svg = d3.select(\"div.losschart\").transition();\n\n        svg.select(\".losstraincolor\")\n            .duration(self.animationDuration)\n            .attr(\"d\", this.trainLine(data)); // 11. Calls the line generator \n\n        svg.select(\".lossvalcolor\")\n            .duration(self.animationDuration)\n            .attr(\"d\", this.valLine(data)); // 11. Calls the line generator  \n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\");\n            g.selectAll(\".tick text\").attr(\"x\", -30).attr(\"y\", -.01)\n        }\n\n        function customXAxis(g) {\n            g.call(self.xAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"x\", 100)\n            g.selectAll(\".tick text\").attr(\"y\", 15)\n        }\n\n        svg.select(\".y.axis\")\n            .call(customYAxis);\n\n        svg.select(\".x.axis\")\n            .call(customXAxis);\n\n    }\n    setupScalesAxes(data) {\n        // console.log(data);\n\n        // let self = this \n        this.chartMargin = { top: 10, right: 10, bottom: 57, left: 45 }\n        this.chartWidth = this.minChartWidth - this.chartMargin.left - this.chartMargin.right\n        this.chartHeight = this.minChartHeight - this.chartMargin.top - this.chartMargin.bottom;\n\n        var n = data.length;\n\n        this.xScale = d3.scaleLinear()\n            .domain([0, n - 1]) // input\n            .range([0, this.chartWidth]); // output\n\n\n        this.yScale = d3.scaleLinear()\n            .domain([d3.min(data, function (d) {\n                // console.log(Math.min(d.loss, d.val_loss))\n                return Math.min(d.loss, d.val_loss)\n            }), d3.max(data, function (d) {\n                return Math.max(d.loss, d.val_loss)\n            })]) // input \n            .range([this.chartHeight, 0])\n\n        this.xAxis = d3.axisBottom(this.xScale)\n        this.yAxis = d3.axisRight(this.yScale)\n            .tickSize(this.minChartWidth)\n    }\n    drawLines(svg, data) {\n\n\n        svg.append(\"path\")\n            .datum(data) // 10. Binds data to the line \n            .attr(\"class\", \"lossline losstraincolor\") // Assign a class for styling  \n            .attr(\"d\", this.trainLine); // 11. Calls the line generator \n\n        svg.append(\"path\")\n            .datum(data) // 10. Binds data to the line \n            .attr(\"class\", \"lossline lossvalcolor\") // Assign a class for styling  \n            .attr(\"d\", this.valLine); // 11. Calls the line generator \n\n    }\n\n    drawGraph(data) {\n        let self = this\n\n\n        // data = [{ epoch: 1, loss: 0.9578104019165039, val_loss: 0.9471035003662109, traintime: 2.247 },\n        // { epoch: 2, loss: 0.7673317790031433, val_loss: 0.8629779815673828, traintime: 0.146 },\n        // { epoch: 3, loss: 0.749285876750946, val_loss: 0.8709790110588074, traintime: 0.152 },\n        // { epoch: 4, loss: 0.7410370707511902, val_loss: 0.8575628995895386, traintime: 0.11 }]\n        // data = [{ epoch: this.CumulativeSteps, loss: 0, val_loss: 0, traintime: 0 }]\n\n        this.setupScalesAxes(data)\n\n        this.trainLine = d3.line()\n            .x(function (d, i) { return self.xScale(i); }) // set the x values for the line generator\n            .y(function (d) { return self.yScale(d.loss); }) // set the y values for the line generator \n            .curve(d3.curveMonotoneX) // apply smoothing to the line\n\n        this.valLine = d3.line()\n            .x(function (d, i) { return self.xScale(i); }) // set the x values for the line generator\n            .y(function (d) { return self.yScale(d.val_loss); }) // set the y values for the line generator \n            .curve(d3.curveMonotoneX) // apply smoothing to the line\n\n\n\n\n        const svg = d3.select(\"div.losschart\").append(\"svg\")\n            .attr(\"width\", this.chartWidth + this.chartMargin.left + this.chartMargin.right)\n            .attr(\"height\", this.chartHeight + this.chartMargin.top + this.chartMargin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + this.chartMargin.left + \",\" + this.chartMargin.top + \")\");\n\n        this.drawLines(svg, data)\n\n        // text label for the x axis\n        svg.append(\"text\")\n            .attr(\"transform\",\n                \"translate(\" + (this.chartWidth / 2) + \" ,\" +\n                (this.chartHeight + this.chartMargin.top + 43) + \")\")\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", \"axislabel x\")\n            .text(\"Training Steps\");\n\n\n        // text label for the y axis\n        svg.append(\"text\")\n            .attr(\"transform\", \"rotate(-90)\")\n            .attr(\"y\", 0 - this.chartMargin.left - 5)\n            .attr(\"x\", 0 - (this.chartHeight / 2))\n            .attr(\"dy\", \"1em\")\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", \"axislabel y\")\n            .text(\"Loss\");\n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\");\n            g.selectAll(\".tick text\").attr(\"x\", -20).attr(\"y\", -.01)\n        }\n\n        function customXAxis(g) {\n            g.call(self.xAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"x\", 100)\n            g.selectAll(\".tick text\").attr(\"y\", 15)\n        }\n        // 3. Call the x axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"x axis\")\n            .attr(\"transform\", \"translate(0,\" + (self.chartHeight + 10) + \")\")\n            .call(customXAxis); // Create an axis component with d3.axisBottom\n\n        // 4. Call the y axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"y axis\")\n            .call(customYAxis); // Create an axis component with d3.axisLeft\n\n    }\n    render() {\n        // console.log(this.props.data.data[his.props.data.data].loss.toFixed(2));\n\n        return (\n            <div className=\"positionrelative mainchartbox \">\n                <div className=\"chartlegend legendtopright p5 mediumdesc\">\n                    <div className=\"mb3\">\n                        <div className=\"legendcolorbox mr5  themeblue iblock\"></div>\n                        <div ref=\"trainlabel\" className=\"iblock boldtext mr5\">0.0</div>\n                        <div className=\"iblock \">Train Loss</div>\n                    </div>\n                    <div>\n                        <div className=\"legendcolorbox mr5 themeorange iblock\"></div>\n                        <div ref=\"validationlabel\" className=\"iblock boldtext mr5\">0.0</div>\n                        <div className=\"iblock \">Validation Loss</div>\n                    </div>\n                </div>\n                <div className=\"losschart chartsvg\"> </div>\n            </div>\n\n        );\n    }\n}\n\nexport default LossChart;    ","/**\n * @license\n * Copyright 2019 Victor Dibia. https://github.com/victordibia\n * Anomagram - Anomagram: Anomaly Detection with Autoencoders in the Browser.\n * Licensed under the MIT License (the \"License\"); \n * =============================================================================\n */\n\n\n// Craft an autoencoder\nconst tf = require('@tensorflow/tfjs');\n\nexport function buildModel(params) {\n\n    const numFeatures = params.numFeatures    // Set feaetures to size of features \n    const latentDim = params.latentDim\n    const hiddenDim = params.hiddenDim\n    const outputActivation = params.outputActivation\n    const regularizationRate = params.regularizationRate\n    let layerRegularizer = null\n\n    if (params.regularizer === \"l1\") {\n        layerRegularizer = tf.regularizers.l1({ l1: regularizationRate })\n\n    } else if (params.regularizer === \"l2\") {\n        layerRegularizer = tf.regularizers.l2({ l2: regularizationRate })\n\n    } else if (params.regularizer === \"l1l2\") {\n        layerRegularizer = tf.regularizers.l1l2({ l1: regularizationRate, l2: regularizationRate })\n    }\n\n\n    // Specify encoder \n    const input = tf.input({ shape: [numFeatures] })\n    let encoderHidden = tf.layers.dense({ units: hiddenDim[0], activation: \"relu\", kernelRegularizer: layerRegularizer }).apply(input);\n    let i = 1\n    while (i < hiddenDim.length) {\n        encoderHidden = tf.layers.dense({ units: hiddenDim[i], activation: \"relu\", kernelRegularizer: layerRegularizer }).apply(encoderHidden);\n        i++\n    }\n    const z_ = tf.layers.dense({ units: latentDim }).apply(encoderHidden);\n    const encoder = tf.model({ inputs: input, outputs: z_, name: \"encoder\" })\n\n\n    // Specify decoder \n    const latentInput = tf.input({ shape: [latentDim] })\n    let decoderHidden = tf.layers.dense({ units: hiddenDim[hiddenDim.length - 1], activation: \"relu\", kernelRegularizer: layerRegularizer }).apply(latentInput);\n    let j = hiddenDim.length - 1\n    while (j > 0) {\n        j--;\n        decoderHidden = tf.layers.dense({ units: hiddenDim[j], activation: \"relu\", kernelRegularizer: layerRegularizer }).apply(decoderHidden);\n\n    }\n    const decoderOutput = tf.layers.dense({ units: numFeatures, activation: outputActivation }).apply(decoderHidden);\n    const decoder = tf.model({ inputs: latentInput, outputs: decoderOutput, name: \"decoder\" })\n\n    // link output of encoder to decoder \n    let output = decoder.apply(encoder.apply(input))\n\n    // Construct AE with both encoder and decoder\n    const ae = tf.model({ inputs: input, outputs: output, name: \"autoencoder\" })\n\n    // Compile with optimizer .. and we are done!\n    ae.compile({ optimizer: params.optimizer, loss: \"meanSquaredError\" })\n    return ae\n}\n\n\n","/**\n * @license\n * Copyright 2019 Victor Dibia. https://github.com/victordibia\n * Anomagram - Anomagram: Anomaly Detection with Autoencoders in the Browser.\n * Licensed under the MIT License (the \"License\"); \n * =============================================================================\n */\n\n \nimport React, { Component } from \"react\";\nimport {Loading,Dropdown, Slider, Checkbox, Tooltip } from \"carbon-components-react\"\nimport \"./train.css\"\nimport * as tf from '@tensorflow/tfjs';\nimport {registerGAEvent, computeAccuracyGivenThreshold, percentToRGB } from \"../helperfunctions/HelperFunctions\"\nimport ROCChart from \"../rocchart/ROCChart\"\n// custom charts \nimport HistogramChart from \"../histogram/HistogramChart\"\nimport ScatterPlot from \"../scatterplot/ScatterPlot\"\nimport LossChart from \"../losschart/LossChart\"\nimport ComposeModel from \"../composemodel/ComposeModel\"\n\nimport { Reset16, PlayFilledAlt16, PauseFilled16 } from '@carbon/icons-react';\nimport { buildModel } from \"./models/ae\"\nimport * as _ from \"lodash\"\n\n\nclass Train extends Component {\n\n    constructor(props) {\n        super(props) \n\n        this.chartWidth = 350;\n        this.chartHeight = 250;\n\n        \n\n        // Model update method passed to model composer component\n        this.updateModelDims = this.updateModelDims.bind(this)\n\n        this.stepOptions = [{ id: \"opt4\", text: \"30\", value: 30, type: \"steps\" },{ id: \"opt1\", text: \"50\", value: 50, type: \"steps\" }, { id: \"opt2\", text: \"100\", value: 100, type: \"steps\" }]\n        this.regularizerOptions = [{ id: \"opt1\", text: \"None\", value: \"none\", type: \"regularizer\" }, { id: \"opt1\", text: \"l1\", value: \"l1\", type: \"regularizer\" }, { id: \"opt2\", text: \"l2\", value: \"l2\", type: \"regularizer\" }, { id: \"opt2\", text: \"l1l2\", value: \"l1l2\", type: \"regularizer\" }]\n        this.batchSizeOptions = [{ id: \"opt1\", text: \"64\", value: 64, type: \"batchsize\" }, { id: \"opt2\", text: \"128\", value: 128, type: \"batchsize\" }, { id: \"opt3\", text: \"256\", value: 256, type: \"batchsize\" }, { id: \"opt3\", text: \"512\", value: 512, type: \"batchsize\" }, { id: \"opt3\", text: \"1024\", value: 1024, type: \"batchsize\" }]\n        this.learningRateOptions = [{ id: \"opt1\", text: \"0.01\", value: 0.01, type: \"learningrate\" }, { id: \"opt2\", text: \"0.001\", value: 0.001, type: \"learningrate\" }, { id: \"opt3\", text: \"0.0001\", value: 0.0001, type: \"learningrate\" },{ id: \"opt5\", text: \"0.1\", value: 0.1, type: \"learningrate\" },{ id: \"opt6\", text: \"1\", value: 1, type: \"learningrate\" },{ id: \"opt7\", text: \"10\", value: 10, type: \"learningrate\" }]\n        // this.regularizationRateOptions = [ \n        //     { id: \"opt3\", text: \"0.01\", value: 0.01, type: \"regularizationrate\" },\n        //     { id: \"opt1\", text: \"0.001\", value: 0.001, type: \"regularizationrate\" },\n        //     { id: \"opt2\", text: \"0.0001\", value: 0.0001, type: \"regularizationrate\" }, \n        // ]\n        this.trainingDataOptions = [{ id: \"opt1\", text: \"500\", value: 500, type: \"traindatasize\" }, { id: \"opt2\", text: \"1000\", value: 1000, type: \"traindatasize\" }, { id: \"opt3\", text: \"2500\", value: 2500, type: \"traindatasize\" }]\n        this.testDataOptions = [{ id: \"opt1\", text: \"100\", value: 100, type: \"testdatasize\" }, { id: \"opt2\", text: \"200\", value: 200, type: \"testdatasize\" }, { id: \"opt3\", text: \"500\", value: 500, type: \"testdatasize\" }]\n        this.optimizerOptions = [\n            { id: \"opt1\", text: \"Adam\", value: \"adam\", type: \"optimizer\" },\n            { id: \"opt3\", text: \"Adamax\", value: \"adamax\", type: \"optimizer\" },\n            { id: \"opt4\", text: \"Adadelta\", value: \"adadelta\", type: \"optimizer\" },\n            { id: \"opt5\", text: \"Rmsprop\", value: \"rmsprop\", type: \"optimizer\" },\n            { id: \"opt6\", text: \"Momentum\", value: \"momentum\", type: \"optimizer\" },\n            { id: \"opt7\", text: \"sgd\", value: \"sgd\", type: \"optimizer\" },\n        ]\n        this.abnormalPercentageOptions = [\n            { id: \"opt1\", text: \"0%\", value: 0, type: \"abnormalpercentage\" },\n            { id: \"opt3\", text: \"5%\", value: 0.05, type: \"abnormalpercentage\" },\n            { id: \"opt4\", text: \"10%\", value: 0.1, type: \"abnormalpercentage\" },\n            { id: \"opt5\", text: \"20%\", value: 0.2, type: \"abnormalpercentage\" },\n            { id: \"opt2\", text: \"30%\", value: 0.3, type: \"abnormalpercentage\" },\n            { id: \"opt9\", text: \"40%\", value: 0.4, type: \"abnormalpercentage\" },\n            { id: \"opt6\", text: \"50%\", value: 0.5, type: \"abnormalpercentage\" },\n            { id: \"opt7\", text: \"70%\", value: 0.7, type: \"abnormalpercentage\" },\n        ]\n \n\n        this.selectedAbnormalPercentage = 0\n        this.selectedTrainDataOption = 0\n        this.selectedTestDataOption = 2\n        this.selectedOptimizer = 0\n\n        this.selectedRegularizer = 0\n\n        this.trainMetricHolder = []\n        this.CumulativeSteps = 0;\n\n        this.interfaceTimedDelay=  700\n\n        this.state = {\n            apptitle: \"Anomagram\",\n            isTraining: false, \n            trainLoaded: false,\n            testLoaded: false,\n            trainDataShape: [0, 0],\n            testDataShape: [0, 0],\n            mseData: [],\n            rocData: [],\n            createdModel: null,\n            encodedData: [],\n            selectedData: 0,\n\n            currentEpoch: 0,\n            numFeatures: 140,\n            hiddenLayers: 2,\n            latentDim: 2,\n            hiddenDim: [7, 3],\n            learningRate: this.learningRateOptions[0].value,\n            regularizer: this.regularizerOptions[this.selectedRegularizer].value,\n            adamBeta1: 0.5,\n            optimizer: this.optimizerOptions[this.selectedOptimizer].value,\n            outputActivation: \"sigmoid\",\n            batchSize: this.batchSizeOptions[3].value,\n            numSteps: this.stepOptions[0].value,\n            numEpochs: 1,\n\n\n            trainMetrics: this.trainMetricHolder,\n            CumulativeSteps: 0,\n            trainDataSize: this.trainingDataOptions[this.selectedTrainDataOption].value,\n            testDataSize: this.testDataOptions[this.selectedTestDataOption].value,\n\n            modelStale: true,\n            bestMetric: { acc: 0, fpr: 0, fnr: 0, tnr: 0, tpr: 0, threshold: 0, precision:0, recall:0 },\n            minThreshold: 0,\n            maxThreshold: 1,\n\n\n            showModelComposer: true,\n            showModelEvaluationMetrics: true,\n            showRocChart: true,\n            showLossChart: true,\n            showMseHistogram: true,\n            showBottleneckScatterPlot: true,\n\n\n            validateOnStep: true,\n            auc: 0,\n\n\n            showAdvanced: true,\n            showIntroduction: true,\n            showWarmingUp: true,\n\n            \n            lossChartHeight: this.chartHeight,\n            lossChartWidth: this.chartWidth,\n            abnormalPercentage: this.abnormalPercentageOptions[this.selectedAbnormalPercentage].value,\n\n            floatCapable: false,\n            floatEnabled: false,\n            isCreating: false,\n            showError: false,\n            errorMsg: \"An error has occured.\"\n \n        }\n\n        this.showOptions = [\n            { label: \"Model Composer\", action: \"composer\", checked: this.state.showModelComposer },\n            { label: \"Model Metrics\", action: \"evaluation\", checked: this.state.showModelEvaluationMetrics }, { label: \"Training Loss\", action: \"loss\", checked: this.state.showLossChart },\n            { label: \"Error Histogram\", action: \"histogram\", checked: this.state.showMseHistogram },\n            { label: \"ROC Curve\", action: \"roc\", checked: this.state.showRocChart },\n            { label: \"Bottleneck Plot\", action: \"bottleneck\", checked: this.state.showBottleneckScatterPlot },\n\n        ]\n\n\n        this.currentSteps = 0;\n\n        this.xsTrain = []\n        this.xsTest = []\n        this.yTest = []\n\n        this.trainDataPath = process.env.PUBLIC_URL + \"/data/ecg/train_scaled.json\"\n        this.testDataPath = process.env.PUBLIC_URL + \"/data/ecg/test_scaled.json\" \n        this.momentum = 0.9 \n\n        this.modelWarmedUp = false;\n        this.tensorsCreated = false;\n\n        this.trainUnmounted = false\n\n       \n    }\n\n    componentDidMount() { \n\n        this.getChartContainerSizes() \n        this.componentLoadedTime = (new Date()).getTime()\n\n\n\n        // load test and train data\n        this.fetchData(this.trainDataPath).then((trainData) => {  \n                this.trainData = trainData\n                this.setState({trainLoaded: true}) \n           \n        }).catch((error) => {\n            this.handleDataLoadError()\n            \n        });\n        \n        this.fetchData(this.testDataPath).then((testData) => {  \n                this.testData = testData\n                this.setState({testLoaded: true})\n            \n        }).catch((error) => {\n            this.handleDataLoadError()\n            \n        });\n\n    }\n\n    handleDataLoadError() {\n        // console.log(\"Failed to test data\");\n        this.setState({showError:true, errorMsg: \"Error fetching data. Please check internet connection and reload page. \"}) \n    }\n\n    fetchData(dataPath) {\n        return fetch(dataPath)\n            .catch(() => {\n               \n           })\n            .then((response) => {\n                return response.json()\n            \n        })  \n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if ((prevState.isTraining !== this.state.isTraining) && this.state.isTraining === false) {\n             \n        }\n\n        if (this.currentSteps === 0 && prevState.mseData[0] !== this.state.mseData[0]) { \n            this.computeAccuracyMetrics(this.state.mseData)\n        }\n\n        if (this.state.CumulativeSteps !== prevState.CumulativeSteps) { \n            this.computeAccuracyMetrics(this.state.mseData)\n        }\n\n        // if train or test size updated, regenerate tensors\n        if (this.state.trainDataSize !== prevState.trainDataSize || this.state.testDataSize !== prevState.testDataSize || this.state.abnormalPercentage !== prevState.abnormalPercentage ) {\n            this.generateDataTensors()\n        }\n    }\n\n\n    destroyModelTensors() {\n        // Dispose all tensors used to hold model parameters\n        if (this.createdModel) {\n            // this.encoder.dispose()\n            this.createdModel.dispose()\n            this.optimizer.dispose() \n        }\n    }\n\n    componentWillUnmount() {\n        this.trainUnmounted = true\n        if (this.tensorsCreated) {\n            this.xsTest.dispose()\n            this.xsTrain.dispose() \n            this.destroyModelTensors()\n        }\n         \n        // this.xsWarmup.dispose()\n        // console.log(tf.memory()); \n    }\n    createModel() { \n\n        // dispose of existing model to release tensors from memory\n        this.destroyModelTensors()\n\n        // if Data tensors not created at all, create tensors \n        if (!this.tensorsCreated) {\n            this.generateDataTensors()\n            this.tensorsCreated = true\n        } \n\n        //construct model\n        switch (this.state.optimizer) {\n            case \"adam\":\n                this.optimizer = tf.train.adam(this.state.learningRate, this.state.adamBeta1)\n                break\n            case \"adamax\":\n                this.optimizer = tf.train.adamax(this.state.learningRate, this.state.adamBeta1)\n                break\n            case \"adadelta\":\n                this.optimizer = tf.train.adadelta(this.state.learningRate)\n                break\n            case \"rmsprop\":\n                this.optimizer = tf.train.rmsprop(this.state.learningRate)\n                break\n            case \"momentum\":\n                this.optimizer = tf.train.momentum(this.state.learningRate, this.momentum)\n                break\n            case \"sgd\":\n                this.optimizer = tf.train.sgd(this.state.learningRate)\n                break\n            default:\n                break;\n        }\n\n\n\n        let modelParams = {\n            numFeatures: this.state.numFeatures,\n            hiddenLayers: this.state.hiddenLayers,\n            latentDim: this.state.latentDim,\n            hiddenDim: this.state.hiddenDim,\n            optimizer: this.optimizer,\n            outputActivation: \"sigmoid\",\n            regularizer: this.state.regularizer,\n            regularizationRate: this.state.learningRate\n        }\n\n        this.createdModel = buildModel(modelParams)\n        this.setState({ modelStale: false, isCreating:false })\n        this.getPredictions()\n\n        \n        \n\n\n        // this.createdModel.summary()\n\n        // setTimeout(() => {\n        // this.modelWarmUp()\n        // }, 5000);\n\n        // showToast(\"success\", \"Model successfully created\")\n        // console.log(tf.memory());\n        // this.setState({showWarmingUp: false})\n    }\n\n    warmUpModel() {\n\n        // let warmUpTensor = tf.tensor2d(this.trainData[0].data,[1,140])\n         console.log(\"attempting warmup\");\n         \n        let warmUpTensor =  tf.tensor2d(this.trainData.slice(0,10).map(item => item.data\n            ), [10, this.trainData[0].data.length])\n        this.setState({ trainDataShape: this.xsTrain.shape })\n        \n        let startTime = new Date();\n        this.createdModel.fit(warmUpTensor, warmUpTensor, { epochs: 1, verbose: 0, batchSize: 512}\n        ).then(res => {\n            let endTime = new Date();\n            let elapsedTime = (endTime - startTime) / 1000\n            console.log(\"Warmup done\", elapsedTime);\n        });\n\n    }\n    trainModel() {\n        // for (let i = 0; i < this.numSteps; i++) {\n\n        this.currentSteps++;\n        //update progresssbar\n        // let progress = Math.floor((this.currentSteps / this.state.numSteps) * 100) + \"%\"\n        // this.refs[\"glowbar\"].style.width = progress;\n\n\n\n        this.CumulativeSteps++;\n        this.setState({ CumulativeSteps: this.CumulativeSteps });\n        // \n        let startTime = new Date();\n        this.createdModel.fit(this.xsTrain,\n            this.xsTrain, { epochs: this.state.numEpochs, verbose: 0, batchSize: this.state.batchSize, validationData: [this.xsTest, this.xsTest] }\n        ).then(res => {\n            let endTime = new Date();\n            let elapsedTime = (endTime - startTime) / 1000\n            // console.log(elapsedTime);\n\n            let metricRow = { epoch: this.CumulativeSteps, loss: res.history.loss[0], val_loss: res.history.val_loss[0], traintime: elapsedTime }\n            this.trainMetricHolder.push(metricRow)\n            // this.setState({ trainMetrics: this.trainMetricHolder });\n            // console.log(\"Step loss\", this.currentSteps, this.CumulativeSteps, res.history.loss[0], elapsedTime);\n           \n\n            // console.log(this.state.numSteps);\n\n            if (this.state.numSteps > this.currentSteps && this.state.isTraining && !this.trainUnmounted  && (!this.state.modelStale)) {\n                this.getPredictions();\n                this.setState({ currentEpoch: this.currentSteps })\n                this.trainModel()\n            } else {\n                 \n                \n                this.currentSteps = 0\n                this.setState({ isTraining: false })\n            }\n        });\n    }\n\n    async loadSavedModel() {\n        // TODO .. launch loadning spinnr\n        let modelPath = \"/webmodel/ecg/model.json\"\n        this.savedModel = await tf.loadLayersModel(modelPath);\n        console.log(\"model loaded\");\n        this.loadTestData()\n\n    }\n\n\n    computeAccuracyMetrics(data) {\n\n        let uniqueMse = _.uniq(_.map(data, 'mse'))\n\n        uniqueMse = _(uniqueMse).sortBy().value()\n        uniqueMse.reverse()\n\n\n\n\n        let rocMetricHolder = []\n        let rocSum = 0\n        let prevMetric = { fpr: 0, tpr: 0 }\n\n        uniqueMse.forEach((each, i) => {\n            let metric = computeAccuracyGivenThreshold(data, each)\n\n            rocMetricHolder.push(metric)\n            // if (i < uniqueMse.length) {\n            // rocSum += (prevMetric.tpr) * (metric.fpr - prevMetric.fpr)\n            rocSum += ((prevMetric.tpr + metric.tpr) / 2) * (metric.fpr - prevMetric.fpr)\n            // console.log(i, rocSum);\n            // }\n            prevMetric = metric\n\n        });\n\n        // Add point (1,1) to compute AUC\n        // use trapezium area rule to calculate area\n        if (prevMetric.fpr !== 1) {\n            rocMetricHolder.push({ fpr: 1, tpr: prevMetric.tpr })\n            rocSum += ((prevMetric.tpr + 1) / 2) * (1 - prevMetric.fpr)\n            // rocSum += prevMetric.tpr * (1 - prevMetric.fpr)\n        }\n\n\n        // console.log(rocSum, \" Region under curve\");\n        // console.log(rocMetricHolder);\n\n\n        this.setState({ rocData: rocMetricHolder })\n        this.setState({ auc: rocSum })\n        // console.log(\"mse initial\", _.min(uniqueMse), _.max(uniqueMse));\n\n        let bestMetric = _.maxBy(rocMetricHolder, \"acc\")\n        this.setState({ bestMetric: bestMetric })\n        this.setState({ minThreshold: _.min(uniqueMse) })\n        this.setState({ maxThreshold: _.max(uniqueMse) })\n\n        \n    }\n\n\n    getPredictions() {\n        let self = this;\n\n        // Get predictions \n        // let startTime = new Date()\n        let preds = this.createdModel.predict(this.xsTest, { batchSize: this.state.batchSize })\n        // let elapsedTime = (new Date() - startTime) / 1000\n        // console.log(\"prediction time\", elapsedTime);\n\n\n        //With large batchsize - 0.001, defualt batchsize .. 0.015\n        // Compute mean squared error difference between predictions and ground truth\n        const mse = tf.tidy(() => {\n            return tf.sub(preds, this.xsTest).square().mean(1)\n        })\n        // let mse = tf.sub(preds, this.xsTest).square().mean(1) //tf.losses.meanSquaredError(preds, xsTest)\n        let mseDataHolder = []\n        mse.array().then(array => {\n            array.forEach((element, i) => {\n                // console.log({ \"mse\": element, \"label\": yTest[i] });\n                mseDataHolder.push({ \"mse\": element, \"label\": this.yTest[i] })\n                // console.log(mseDataHolder.length)\n            });\n            self.setState({ mseData: mseDataHolder })\n\n            // console.log(mseDataHolder); \n\n        });\n\n\n\n        // Generate encoder output \n        this.encoder = tf.model({ inputs: this.createdModel.inputs, outputs: this.createdModel.getLayer(\"encoder\").getOutputAt(1) });\n        let encoderPredictions = this.encoder.predict(this.xsTest)\n\n\n        let encPredHolder = []\n        encoderPredictions.array().then(array => {\n            array.forEach((element, i) => {\n                encPredHolder.push({ x: element[0], y: element[1], \"label\": this.yTest[i] })\n            });\n            self.setState({ encodedData: encPredHolder })\n        })\n\n\n        preds.dispose()\n        encoderPredictions.dispose()\n        mse.dispose()\n        // console.log(tf.memory());\n\n        \n    }\n\n    updateModelDims(hiddenDims, latentDim) {\n        // console.log(hiddenDims, latentDim);\n        this.setState({ hiddenDim: hiddenDims })\n        this.setState({ latentDim: latentDim[0] })\n        this.setState({ modelStale: true })\n\n    }\n\n    // visualizeMSE(mse)\n    generateDataTensors() {\n        // console.log(\"Generating data tensor\");\n        \n        //shuffle data\n        this.trainData = _.shuffle(this.trainData)\n        this.testData = _.shuffle(this.testData)\n\n        let maxAbnormalCount = this.state.abnormalPercentage * this.state.trainDataSize;\n        let abnormalCount = 0;\n\n        let trainEcg = []\n        //Add abnormal samples\n        for (let row in this.trainData) {\n            let val = this.trainData[row] \n            if (val.target + \"\" !== 1 + \"\") {\n                if (abnormalCount < maxAbnormalCount) {\n                    trainEcg.push(val)\n                    abnormalCount++\n                }\n            }\n        }\n\n        //Add  positive normal ECG (target==1) to train json array \n        for (let row in this.trainData) {\n            let val = this.trainData[row]\n            if (val.target + \"\" === 1 + \"\") { \n                if (trainEcg.length < this.state.trainDataSize) {\n                    trainEcg.push(val)\n                } else {\n                    break\n                }\n            }  \n        }\n\n        // console.log(maxAbnormalCount, \"abnormal samples\",  abnormalCount, \"Total\", trainEcg.length);\n        \n\n        // Create train tensor from json array\n        this.xsTrain = tf.tensor2d(trainEcg.map(item => item.data\n        ), [trainEcg.length, trainEcg[0].data.length])\n        this.setState({ trainDataShape: this.xsTrain.shape })\n\n\n        // Create test data TENSOR from test data json array \n        let testData = this.testData.slice(0, this.state.testDataSize)\n        this.xsTest = tf.tensor2d(testData.map(item => item.data\n        ), [testData.length, testData[0].data.length])\n\n        // Create yLabel Tensor\n        this.yTest = testData.map(item => item.target + \"\" === 1 + \"\" ? 0 : 1)\n\n        this.setState({ testDataShape: this.xsTest.shape })\n\n    }\n\n    trainButtonClick(e) {\n        registerGAEvent(\"trainmodel\", \"trainbutton\", this.state.isTraining.toString(), this.componentLoadedTime)\n        if (this.state.isTraining) {\n            this.setState({ isTraining: false })\n        } else {\n            this.setState({ isTraining: true })\n            setTimeout(() => {\n                this.trainModel()\n            }, this.interfaceTimedDelay);\n        }\n    }\n\n    resetModelButtonClick(e) { \n        registerGAEvent(\"trainmodel\", \"compilebutton\",  \"compilebutton\", this.componentLoadedTime)\n        this.CumulativeSteps = 0 \n        this.trainMetricHolder = []\n        this.setState({\n            // showIntroduction: false,\n            isCreating: true,\n            isTraining: false,\n            CumulativeSteps: 0,\n            trainMetrics: this.trainMetricHolder \n        })\n        \n          \n       \n        // this.setState({ mseData: [] }) \n        setTimeout(() => {\n            this.createModel()\n        }, this.interfaceTimedDelay);\n        \n    }\n\n    updateModelParam(e) {\n        // model state is set to stale each time a parameter is updated.\n        registerGAEvent(\"trainmodel\", \"modelparameter\",  e.selectedItem.type, this.componentLoadedTime)\n        \n        this.setState({ modelStale: true })\n        switch (e.selectedItem.type) {\n            case \"steps\":\n                this.setState({ numSteps: e.selectedItem.value })\n                break\n            case \"batchsize\":\n                this.setState({ batchSize: e.selectedItem.value }) \n                break\n            case \"learningrate\":\n                this.setState({ learningRate: e.selectedItem.value }) \n                break\n            case \"traindatasize\":\n                this.setState({ trainDataSize: e.selectedItem.value }) \n                break\n            case \"abnormalpercentage\":\n                    this.setState({ abnormalPercentage: e.selectedItem.value }) \n                    break\n            case \"testdatasize\":\n                this.setState({ testDataSize: e.selectedItem.value })\n                break\n            case \"optimizer\":\n                this.setState({ optimizer: e.selectedItem.value }) \n                break\n            case \"regularizer\":\n                this.setState({ regularizer: e.selectedItem.value }) \n                break\n            default:\n                break\n        }\n\n\n    }\n\n\n    updateThreshold(e) {\n        if (this.state.mseData.length > 0) {\n            let threshVal = this.state.minThreshold + (e.value / 100) * (this.state.maxThreshold - this.state.minThreshold)\n            let bestMetric = computeAccuracyGivenThreshold(this.state.mseData, threshVal)\n            // console.log(e.value, this.state.mseData);\n            this.setState({ bestMetric: bestMetric })\n        }\n\n    }\n\n    \n\n    showOptionsClick(e) {\n        // console.log(e.target.checked, e.target.getAttribute(\"action\"));\n        registerGAEvent(\"trainmodel\", \"selectchart\",  e.target.getAttribute(\"action\"), this.componentLoadedTime)\n        \n        switch (e.target.getAttribute(\"action\")) {\n            case \"histogram\":\n                this.setState({ showMseHistogram: e.target.checked })\n                break\n            case \"loss\":\n                this.setState({ showLossChart: e.target.checked })\n                break\n            case \"composer\":\n                this.setState({ showModelComposer: e.target.checked })\n                break\n            case \"bottleneck\":\n                this.setState({ showBottleneckScatterPlot: e.target.checked })\n                break\n            case \"roc\":\n                this.setState({ showRocChart: e.target.checked })\n                break\n            case \"evaluation\":\n                this.setState({ showModelEvaluationMetrics: e.target.checked })\n                break\n            default:\n                break\n        }\n\n    }\n\n    toggleAdvancedDrawer(e) {\n        this.setState({ showAdvanced: !(this.state.showAdvanced) })\n    }\n\n    toggleIntroDrawer(e) {\n        this.setState({ showIntroduction: !(this.state.showIntroduction) })\n    }\n \n    getChartContainerSizes() {\n        \n\n        this.setState({ lossChartHeight: this.refs[\"modelevalbox\"].offsetHeight-  50 })\n        // this.setState({lossChartWidth: this.refs[\"modelevalbox\"].offsetWidth })\n         \n        \n    }\n\n    render() {\n        // console.log(this.state.mseData);\n        \n        \n        // Use chart state determine when to redraw model composer lines as UI has change\n        let chartState = \"\"\n        this.showOptions.forEach(data => {\n            let box = document.getElementById(data.action + \"checkboxid\")\n            if (box !== null) {\n                chartState += box.checked \n            } \n        }); \n\n         \n\n        let showCheckBoxes = this.showOptions.map((data) => {\n            return (\n                <div key={data.label + \"checkbox\"} className=\"mediumdesc iblock mr10\">\n                    <Checkbox\n                        defaultChecked={data.checked}\n                        wrapperClassName={\"mediumdesc chartchecks\"}\n                        className={\"mediumdesc \"}\n                        labelText={data.label}\n                        id={data.action + \"checkboxid\"}\n                        action={data.action}\n                        onClick={this.showOptionsClick.bind(this)}\n                    ></Checkbox>\n                </div>\n            )\n        })\n\n        let isDataLoaded = this.state.testLoaded && this.state.trainLoaded \n        let loadingText = (\n            <div className=\" pb10\">\n                Loading <span> train </span> <span> and test </span> data ... \n            </div>\n        )\n\n        let trainResetButtons = (\n            <div>\n                <div className=\"  flex flexjustifycenter pt10 \">\n\n                   \n\n                    <div className=\"iblock h100 mr5 \">\n                        <div className=\"  flex flexjustifycenter h100  \">\n                            <div className=\"\">\n                                <div\n                                    onClick={this.resetModelButtonClick.bind(this)}\n                                    className={\" circlesmall circlebutton mr5 flex flexjustifycenter clickable \" + (this.state.isTraining || !isDataLoaded ? \"  disabled\" : \"\") + \" \" + (this.state.modelStale ? \" pulse\" : \"\")}>\n                                    <Reset16 style={{ fill: \"white\" }} className=\"unselectable unclickable\" />\n\n                                </div>\n                                <div className=\" displayblock smalldesc textaligncenter pt5 \"> Compile  </div>\n                            </div>\n\n                        </div>\n\n                    </div>\n\n                    <div className=\" iblock \">\n                        <div\n                            onClick={this.trainButtonClick.bind(this)}\n                            className={(\"iblock circlelarge circlebutton mr5 flexcolumn flex flexjustifycenter clickable \") + (this.state.modelStale || !isDataLoaded ? \" disabled\" : \"\")}>\n                            {!this.state.isTraining && <PlayFilledAlt16 style={{ fill: \"white\" }} className=\"unselectable unclickable\" />}\n                            {this.state.isTraining && <PauseFilled16 style={{ fill: \"white\" }} className=\"unselectable unclickable\" />}\n                        </div>\n                        <div className=\"smalldesc textaligncenter pt5 pb5 \"> Train &nbsp; </div>\n                    </div>\n\n                    <div ref className=\"iblock  mr10\">\n                        <div ref=\"activeloaderdiv\" className=\"resetbox\" style={{opacity: (this.state.isTraining || this.state.isCreating || !isDataLoaded ) ? 1:0, width: (this.state.isTraining || this.state.isCreating || !isDataLoaded)  ?  \"34px\": \"0px\"  }} >\n                            <Loading\n                                className=\" \"\n                                active={true}\n                                small={true}\n                                withOverlay={false}\n                            > </Loading>\n                        </div>\n\n                    </div>\n\n\n\n                </div>\n            </div>\n        )\n        let configBar = (\n            <div ref=\"modelconfigbar\" style={{ zIndex: 100 }} className={\"w100   unselectable greyhighlight  flex flexjustifyleft flexjustifycenter modelconfigbar  \" + (!isDataLoaded ? \" divdisabled\" : \"\")}>\n                <div className=\"pl10 pt10 pr10 pb5  iblock\">\n                    <div className=\"iblock mr10\">\n                        <div className=\"mediumdesc pb7 pt5\"> Steps <span className=\"boldtext\"> {this.state.numSteps} </span>  - {this.state.CumulativeSteps}  </div>\n                        <Dropdown\n                            id=\"epochsdropdown\" \n                            label=\"Steps\"\n                            items={this.stepOptions}\n                            initialSelectedItem={this.stepOptions[0]}\n                            itemToString={item => (item ? item.text : \"\")}\n                            onChange={this.updateModelParam.bind(this)}\n                        />\n                    </div>\n\n                    <div className=\"iblock mr10\">\n                        <div className=\"mediumdesc pb7 pt5\"> Batchsize <span className=\"boldtext\"> {this.state.batchSize} </span> </div>\n                        <Dropdown\n                            id=\"batchsizedropdown\"\n                            label=\"Batch Size\"\n                            items={this.batchSizeOptions}\n                            initialSelectedItem={this.batchSizeOptions[3]}\n                            itemToString={item => (item ? item.text : \"\")}\n                            onChange={this.updateModelParam.bind(this)}\n                        />\n                    </div>\n\n                    <div className=\"iblock mr10\">\n                        <div className=\"mediumdesc pb7 pt5\"> Learning Rate <span className=\"boldtext\"> {this.state.learningRate}</span>  </div>\n                        <Dropdown\n                            id=\"learningratedropdown\"\n                            label=\"Learning Rate\"\n                            items={this.learningRateOptions}\n                            itemToString={item => (item ? item.text : \"\")}\n                            initialSelectedItem={this.learningRateOptions[0]}\n                            onChange={this.updateModelParam.bind(this)}\n                        />\n                    </div>\n\n                    <div className=\"iblock mr10\">\n                        <div className=\"mediumdesc pb7 pt5\"> Regularlizer <span className=\"boldtext\"> {this.state.regularizer}</span> </div>\n                        <Dropdown\n                            id=\"regularizeerdropdown\"\n                            label=\"Regularizer\"\n                            items={this.regularizerOptions}\n                            itemToString={item => (item ? item.text : \"\")}\n                            initialSelectedItem={this.regularizerOptions[this.selectedRegularizer]}\n                            onChange={this.updateModelParam.bind(this)}\n                        />\n                    </div>\n\n                    <div style={{ zIndex: 5000 }} className=\"iblock mr10 \">\n                        <div className=\"mediumdesc pb7 pt5\"> Optimizer <span className=\"boldtext\"> {this.state.optimizer} </span> </div>\n                        <Dropdown\n                            style={{ zIndex: 100 }}\n                            id=\"optimizerdropdown\"\n                            label=\"Optimizer\"\n                            items={this.optimizerOptions}\n                            itemToString={item => (item ? item.text : \"\")}\n                            initialSelectedItem={this.optimizerOptions[this.selectedOptimizer]}\n                            onChange={this.updateModelParam.bind(this)}\n                        />\n                    </div>\n\n                     \n                    <div className=\"iblock mr10 borderleftdash pl10 \">\n                    {/* <div className=\"configsectiontitle smalldesc iblock mr10\">  Dataset </div> */}\n                        <div className=\"iblock\">\n                        <div className=\"mediumdesc pb7 pt5\">Train Size <span className=\"boldtext\"> {this.state.trainDataShape[0]} </span>  </div>\n                        <Dropdown\n                            id=\"trainingdatadropdown\"\n                            label=\"Training Data\"\n                            items={this.trainingDataOptions}\n                            initialSelectedItem={this.trainingDataOptions[this.selectedTrainDataOption]}\n                            itemToString={item => (item ? item.text : \"\")}\n                            onChange={this.updateModelParam.bind(this)}\n                        />\n                        </div>\n                    </div>\n\n                    <div className=\"iblock mr10\">\n                        <div className=\"mediumdesc pb7 pt5\"> Abnormal % <span className=\"boldtext\"> {this.state.abnormalPercentage} </span> </div>\n                        <Dropdown\n                            id=\"abnormalpercentagedatadropdown\"\n                            label=\"Abnormal %\"\n                            items={this.abnormalPercentageOptions}\n                            initialSelectedItem={this.abnormalPercentageOptions[this.selectedAbnormalPercentage]}\n                            itemToString={item => (item ? item.text : \"\")}\n                            onChange={this.updateModelParam.bind(this)}\n                        />\n                    </div>\n\n                    <div className=\"iblock mr10\">\n                        <div className=\"mediumdesc pb7 pt5\">Test Size <span className=\"boldtext\"> {this.state.testDataShape[0]} </span> </div>\n                        <Dropdown\n                            id=\"testdatadropdown\"\n                            label=\"Test Data\"\n                            items={this.testDataOptions}\n                            itemToString={item => (item ? item.text : \"\")}\n                            initialSelectedItem={this.testDataOptions[this.selectedTestDataOption]}\n                            onChange={this.updateModelParam.bind(this)}\n                        />\n                    </div>\n\n                \n                    <div className=\"   pt5 pb3\">  \n                        {this.state.modelStale && <div className=\"smallblueball pulse iblock\"></div>}\n                        {(this.state.modelStale && this.state.CumulativeSteps === 0) && <span className=\"mediumdesc\"> Select model parameters\n                        and click <span className=\"boldtext \"> Compile </span> to <span className=\"\">initialize</span> the model.</span>}\n                        {(this.state.modelStale && this.state.CumulativeSteps > 0) && <span className=\"mediumdesc\"> Model configuration has changed. Click <span className=\"boldtext \"> Compile </span> to recompile model.</span>}\n                    { !this.state.modelStale && <span className=\"mediumdesc\"> Model compiled based on selected parameters. Ready to <span className=\"boldtext\"> train </span>. </span> }\n                    </div>\n                </div>\n            </div>\n        )\n \n        if (this.state.encodedData[0]) {\n            // console.log(this.state.encodedData[0].x);\n            this.firstEncode = this.state.encodedData[0].x + this.state.encodedData[1].x\n        }\n        let compBoxSize = 0\n        if (this.refs[\"composemodelbox\"]) {\n            compBoxSize = this.refs[\"composemodelbox\"].offsetWidth\n        }\n        // console.log(compBoxSize);\n        \n        let modelComposerBlock = (\n            <div className=\"composermaindiv\">\n                 {/* // Model Composer  */}\n                {this.state.showModelComposer &&\n                        <div className=\" mr10 \">\n                            <div>\n                                <div className=\"charttitle mb5 \">\n                                    Model Composer  \n                            </div>\n                                <div>\n                                    <ComposeModel\n                                        hiddenDims={this.state.hiddenDim}\n                                        latentDim={[this.state.latentDim]}\n                                isTraining={this.state.isTraining}\n                                isUpdatable={true}\n                                        updateModelDims={this.updateModelDims}\n                                        adv={this.state.showAdvanced + \"b\" + this.state.showIntroduction.toString() + chartState + this.firstEncode + \"-\" + compBoxSize  +\"-\"+ isDataLoaded }\n                                    />\n                                </div>\n                            </div>\n                        </div>}\n            </div>\n        )\n\n        let lossChartBlock = (\n            <div>\n                {this.state.showLossChart && <div className=\"iblock mr10  h100 \" > \n                                    <div>\n                                        <div className=\"charttitle \">\n                                            Train Loss\n                                        </div>\n\n                        <div>\n                        <div className={\"positionrelative h100 \" + (this.state.trainMetrics.length <= 0 ? \" \" : \"\")} style={{ width: this.chartWidth, height: this.chartHeight }}>\n                                {this.state.trainMetrics.length <= 0 &&\n                                    <div className=\"notrainingdata\">  No training loss data yet </div>\n                                }\n                                 \n                                    {this.state.trainMetrics.length > 0 &&\n                                                    <LossChart\n                                                        data={{\n                                                            data: this.state.trainMetrics,\n                                                            chartWidth: this.chartWidth,\n                                                            chartHeight: this.state.lossChartHeight,\n                                                            epoch: this.state.CumulativeSteps\n                                                        }}\n\n                                        ></LossChart>\n                                }\n                                </div>\n                                        </div>\n                                    </div> \n                        </div>}\n            </div>\n        )\n\n        let rocChartBlock = (\n            <div>\n                {this.state.showRocChart && <div className=\"iblock mr10\">\n                            {this.state.rocData.length > 0 &&\n                                <div>\n                                    <div className=\"charttitle \">\n                                        ROC Curve [ AUC : {this.state.auc.toFixed(2)} ]\n                                    </div>\n\n                                    <div>\n                                        <ROCChart\n                                            data={{\n                                                chartWidth: this.chartWidth,\n                                                chartHeight: this.state.lossChartHeight,\n                                                data: this.state.rocData,\n                                                isTraining: this.state.isTraining,\n                                                epoch: this.state.CumulativeSteps,\n                                                auc: this.state.auc\n\n                                            }} \n                                        ></ROCChart>\n                                    </div>\n                                </div>\n                            }\n                        </div>}\n            </div>\n        )\n\n        let mseHistogramBlock = (\n            <div>\n                {this.state.showMseHistogram && <div className=\"iblock mr10 \">\n                            {this.state.mseData.length > 0 && \n                                <div>\n                                    <div className=\"charttitle\"> Histogram of Mean Square Error </  div>\n\n                                    <div>\n                                        <HistogramChart\n                                            data={{\n                                                data: this.state.mseData,\n                                                chartWidth: this.chartWidth,\n                                                chartHeight: this.state.lossChartHeight,\n                                                epoch: this.state.CumulativeSteps,\n                                                threshold: this.state.bestMetric.threshold\n                                            }}\n                                        ></HistogramChart>\n                                    </div>\n                                </div> \n                            }\n                        </div>}\n            </div>\n        )\n\n        let bottleneckScatterPlotBlock = (\n            <div>\n                 {this.state.showBottleneckScatterPlot && <div className=\"iblock mr10  \">\n                            {this.state.encodedData.length > 0 &&\n\n                                <div>\n                                    <div className=\"charttitle\"> Bottleneck Scatterplot </  div>\n\n                                    <div>\n                                        <ScatterPlot\n                                            data={{\n                                                data: this.state.encodedData,\n                                                chartWidth: this.chartWidth,\n                                                chartHeight: this.state.lossChartHeight,\n                                                epoch: this.state.CumulativeSteps\n                                            }}\n\n                                        ></ScatterPlot>\n                                    </div>\n                                </div>\n\n                            }\n                        </div>}\n            </div>\n        )\n\n        let modelMetricsBlock = (\n            <div className=\"flex  w100 pr10   \"> \n                    {(this.state.bestMetric && this.state.showModelEvaluationMetrics) &&\n\n                        <div className={\"iblock perfmetrics w100 \" + (this.state.isTraining ? \" disabled \" : \" \")}>\n                            <div className=\"charttitle mb5 \">\n                                Model Evaluation Metrics\n                            </div>\n                            <div className=\"mb5 greyhighlight p10 touchnoscroll\">\n                                <Slider\n                                    className=\"w100 border\"\n                                    min={0} //{(this.state.minThreshold.toFixed(4) * 1)}\n                                    max={100}//{(this.state.maxThreshold.toFixed(4) * 1)}\n                                    step={2}\n                                    minLabel={\"%\"}\n                                    maxLabel={\"%\"}\n                                    value={((this.state.bestMetric.threshold - this.state.minThreshold) / (this.state.maxThreshold - this.state.minThreshold)) * 100}\n                                    stepMuliplier={10}\n                                    disabled={this.state.isTraining ? true : false}\n                                    labelText={\"Threshold \" + (this.state.bestMetric.threshold).toFixed(4) + \" [ \" + (((this.state.bestMetric.threshold - this.state.minThreshold) / (this.state.maxThreshold - this.state.minThreshold)) * 100).toFixed(0) + \" % ] \"}\n                                    hideTextInput={true}\n                                    onChange={this.updateThreshold.bind(this)}\n                                />\n                            </div>\n                            <div className=\"flex\">\n                                <div style={{ borderLeftColor: percentToRGB((this.state.bestMetric.acc * 100)) }} className=\"metricguage mb5  greyhighlight accuracybox  textaligncenter mr5 flex5\" >\n                                    <div className=\"metricvalue textaligncenter  rad4\"> {(this.state.bestMetric.acc * 100).toFixed(2)}  %</div>\n                                    <div className=\"metricdesc mediumdesc p5\"> Best Accuracy </div>\n                                </div>\n                                <div style={{ borderLeftColor: percentToRGB((this.state.auc * 100)) }} className=\"metricguage mb5 greyhighlight  textaligncenter flex5\" >\n                                    <div className=\"metricvalue textaligncenter  rad4\"> {(this.state.auc).toFixed(2)} </div>\n                                    <div className=\"metricdesc mediumdesc p5\"> AUC </div>\n                                </div>\n\n                                <div style={{ borderLeftColor: percentToRGB((this.state.bestMetric.precision * 100)) }} className=\"metricguage mb5 greyhighlight  textaligncenter flex5\" >\n                                    <div className=\"metricvalue textaligncenter  rad4\"> {(this.state.bestMetric.precision ).toFixed(2)} </div>\n                                    <div className=\"metricdesc mediumdesc p5\"> Precision </div>\n                        </div>\n                        \n                        <div style={{ borderLeftColor: percentToRGB((this.state.bestMetric.recall * 100)) }} className=\"metricguage mb5 greyhighlight  textaligncenter flex5\" >\n                                    <div className=\"metricvalue textaligncenter  rad4\"> {(this.state.bestMetric.recall).toFixed(2)} </div>\n                                    <div className=\"metricdesc mediumdesc p5\"> Recall </div>\n                                </div>\n\n                            </div>\n                            <div className=\"mb5 flex\">\n\n                                <div style={{ borderLeftColor: percentToRGB(100 - (this.state.bestMetric.fpr * 100)) }} className=\"metricguage flex5 mr5  greyhighlight  textaligncenter\">\n                                    <div className=\"metricvalue textaligncenter\"> {(this.state.bestMetric.fpr * 100).toFixed(2)}  % </div>\n                                    <div className=\"metricdesc mediumdesc p5\"> False Positive Rate </div>\n                                </div>\n                                <div style={{ borderLeftColor: percentToRGB(100 - (this.state.bestMetric.fnr * 100)) }} className=\"metricguage flex5   greyhighlight  textaligncenter\">\n                                    <div className=\"metricvalue\"> {(this.state.bestMetric.fnr * 100).toFixed(2)} % </div>\n                                    <div className=\"metricdesc displayblock mediumdesc p5\"> False Negative Rate </div>\n                                </div>\n\n                            </div>\n                            <div className=\"flex\">\n                                <div style={{ borderLeftColor: percentToRGB((this.state.bestMetric.tpr * 100)) }} className=\"metricguage flex5  mr5 greyhighlight  textaligncenter\">\n                                    <div className=\"metricvalue\"> {(this.state.bestMetric.tpr * 100).toFixed(2)} % </div>\n                                    <div className=\"metricdesc mr10 mediumdesc p5\"> True Positive Rate </div>\n                                </div>\n                                <div style={{ borderLeftColor: percentToRGB((this.state.bestMetric.tnr * 100)) }} className=\"metricguage flex5  greyhighlight  textaligncenter\">\n                                    <div className=\"metricvalue\"> {(this.state.bestMetric.tnr * 100).toFixed(2)} % </div>\n                                    <div className=\"metricdesc mediumdesc p5\"> True Negative Rate </div>\n                                </div>\n                            </div>\n\n                        </div>}\n\n                </div>\n        )\n  \n        return (\n            <div className=\"maintrainbox\">  \n                {/* {this.state.showWarmingUp && <div className=\"\">\n                    <div className=\"flex mt10 mr10 \">\n                        <div className=\"iblock  flexjustifycenter\" ref=\"activeloaderdiv\" >\n                            <div className=\"loadcircle iblock\"></div>\n                                \n                        </div> \n                       \n                        <div className=\"iblock pt3 pl5 h100 \"> Initializing model ...</div> \n                    </div>\n                </div>} */}\n\n                {/* show advanced options pannel */}\n                <div style={{ zIndex: 100 }} onClick={this.toggleIntroDrawer.bind(this)} className=\"unselectable mt10 p10 clickable  flex greymoreinfo\">\n                    <div className=\"iblock flexfull minwidth485\">\n                        <strong>\n                            {!this.state.showIntroduction && <span>&#x25BC;  </span>} {this.state.showIntroduction && <span>&#x25B2;  </span>}\n                        </strong>\n                        Introduction\n                    </div>\n                    <div className=\"iblock   \">\n                        <div className=\"iblock mr5\"> <span className=\"boldtext\"> {} </span></div>\n                        <div className=\"iblock\">\n                            <div className=\"smalldesc\"> Overview of how it works!</div>\n                        </div>\n                    </div>\n\n                </div>\n\n\n                {(this.state.showIntroduction) &&\n                    <div className=\"mynotif h100 lh10 mt10 lightbluehightlight maxh16  mb10\">\n                        <div className=\"boldtext\"> Train an Autoencoder for Anomaly Detection </div>\n                        <div>\n                            <a href=\"https://en.wikipedia.org/wiki/Autoencoder\" target=\"_blank\" rel=\"noopener noreferrer\">\n                                Autoencoders</a> are neural networks which learn to reconstruct input data. We can leverage this property to detect anomalies.\n                                <div className=\"circlenumber iblock textaligncenter\"> 1 </div>  <span className=\"boldtext\"> Compile Model . </span> Select model parameters\n                            (number of layers, batchsize, learning rate, regularizer etc) and then click <span className=\"italics\">compile</span> to initialize the model. \n                        \n                            <strong className=\"greycolor\"> Hint</strong>: You can add/remove layers and units to \n                            the autoencoder using  the visual model composer + and - buttons. Remember to click <span className=\"italics\">compile</span> after every change!\n                        <div className=\"circlenumber iblock textaligncenter\"> 2 </div>  <span className=\"boldtext\"> Train. </span> This trains the autoencoder using normal data \n                        samples from the ECG5000 dataset.  Training the model on a dataset that consists of mainly normal data (an assumption that holds for most anomaly use cases), \n                        the model learns to reconstruct only normal data samples with very little reconstruction error. \n                        To mirror your use case conditions, you can specify the percentage of abnormal samples \n                        to include in the training data set and observe how it affects accuracy.\n                        <div className=\"circlenumber iblock textaligncenter\"> 3 </div>  <span className=\"boldtext\"> Evaluate. </span> \n                        At each training step, visualize the reconstruction error (mse) generated for each sample in the test dataset. Observe that mse is higher\n                        for abnormal samples compared to abnormal samples. We can select a threshold and flag samples with an mse > threshold as anomalies. \n                        Model performance can then be evaluated using metrics such has AUC, TPR, FPR; also observe how these metrics vary with different\n                        choices of threshold.\n         \n                     </div>\n\n                    </div>}\n\n                \n                {(this.state.showError && !(this.state.testLoaded && this.state.trainLoaded ))&&\n                    <div className=\"errordiv p10 mb10\"> \n                        {this.state.errorMsg}\n                    </div>\n                }\n                {/* show advanced options pannel */}\n                <div style={{ zIndex: 100 }} onClick={this.toggleAdvancedDrawer.bind(this)} className=\"unselectable mt10 p10 clickable  flex greymoreinfo\">\n                    <div className=\"iblock flexfull minwidth485\">\n                        <strong>\n                            {!this.state.showAdvanced && <span>&#x25BC;  </span>} {this.state.showAdvanced && <span>&#x25B2;  </span>}\n                        </strong>\n                        Select model configuration and visualization charts.\n                    </div>\n                    <div className=\"iblock   \">\n                        <div className=\"iblock mr5\"> <span className=\"boldtext\"> {} </span></div>\n                        <div className=\"iblock\">\n                            <div className=\"smalldesc\"> \n                                \n                                {this.state.hiddenDim.length} Layer Autoencoder\n                                \n                            </div>\n                        </div>\n                    </div>\n\n                </div>\n                \n\n                {(this.state.showAdvanced) &&\n                    <div className=\" modelconfigdiv p10 \"> \n                        { !isDataLoaded &&  loadingText}\n\n                        <div className=\"flex flexwrap \">\n                            <div className=\"flexwrapitem\">\n                                {trainResetButtons}\n                            </div>\n                            <div className=\"flexwrapitem flexfull \">\n                                {configBar}\n                        </div>\n                       \n                        </div>\n\n                        <div className=\"pl10 pt5 pr10 pb5 greyborder mt10\">\n                            <div className=\"boldtext  iblock mr5\">\n                                {/* <div className=\"iblock \"> Charts </div> */}\n                                <div className=\"iblock boldtext  \">\n                                    <Tooltip\n                                        direction=\"right\"\n                                        triggerText=\"Select Charts\"\n                                    >\n                                        <div className=\"tooltiptext\">\n                                            Add/Remove charts that visualize the state of the model as training progresses.\n                                            For example, the Training Loss chart shows the \"loss\" or error of the model as training progresses.\n                                        </div>\n\n                                    </Tooltip>\n                                </div>\n\n                            </div>\n                            {showCheckBoxes}\n                        </div>\n\n                    </div>\n                }\n                <div ref=\"glowbar\" className={\"glowbar w0 \"} style={{ width: Math.floor((this.currentSteps / this.state.numSteps) * 100) + \"%\" }}></div>\n \n                <div ref=\"chartcontainer\" className=\"flex chartcontainer flexwrap mt10\">\n                    {this.state.showModelComposer && <div ref=\"composemodelbox\" action=\"composer\"  className={\"traincomposerdiv flexwrapitem \" + (this.state.showModelComposer ? \" flex40\":\"\")}> {modelComposerBlock} </div>}\n                    {this.state.showModelEvaluationMetrics &&  <div ref=\"modelevalbox\" action=\"metrics\" className={\"flexwrapitem \" + (this.state.showModelEvaluationMetrics ? \" flexfull\":\"\")}> {modelMetricsBlock} </div>}\n                    <div ref=\"lossbox1\" action=\"loss\"  className=\"  flexwrapitem \"> { lossChartBlock} </div>\n                    <div action=\"mse\" className=\"flexwrapitem  \"> {mseHistogramBlock} </div>\n                    {/* <div className=\"flex20 flexpushout\"></div> */}\n                    \n                    {(this.state.rocData.length > 0 && this.state.encodedData.length >0) &&\n                        <div className=\"   iblock flex20\">\n                            <div action=\"roc\" className=\"flexwrapitem  iblock \"> {rocChartBlock} </div>\n                            <div action=\"bottleneck\"  className=\"flexwrapitem   iblock\"> {bottleneckScatterPlotBlock} </div>\n\n                         </div>\n                    }\n                </div>\n                \n                 \n               \n                \n                {\n                     \n                    // <div className=\"mediumdesc p10\"> \n                    //    Textures in use - Flaot32 Capable ? {this.state.floatCapable.toString()} | {this.state.floatEnabled.toString()}\n                    // </div>\n                }\n                <br />\n                <br />\n                <br />\n\n            </div >\n        );\n    }\n}\n\nexport default Train;","/**\n * @license\n * Copyright 2019 Victor Dibia. https://github.com/victordibia\n * Anomagram - Anomagram: Anomaly Detection with Autoencoders in the Browser.\n * Licensed under the MIT License (the \"License\"); \n * =============================================================================\n */\n\n\nimport React, { Component } from \"react\";\nimport {\n    Route,\n    HashRouter,\n\n} from \"react-router-dom\";\nimport ReactGA from 'react-ga';\n\nimport \"./template.css\"\n\n// import Sidebar from \"./Sidebar\";\nimport AppHeader from \"./header/AppHeader\";\nimport Footer from \"./footer/Footer\";\nimport Viz from \"./viz/Viz\";\nimport Train from \"./train/Train\"\n\nimport { createBrowserHistory } from 'history';\n\n\nReactGA.initialize(\"UA-131578973-2\")\nconst history = createBrowserHistory({\n    basename: \"\", // The base URL of the app (see below)\n    forceRefresh: false, // Set true to force full page refreshes\n    keyLength: 6, // The length of location.key\n    // A function to use to confirm navigation with the user (see below)\n    getUserConfirmation: (message, callback) => callback(window.confirm(message))\n});\nhistory.listen(location => {\n    ReactGA.set({ page: location.hash })\n    ReactGA.pageview(location.hash)\n    // console.log(location.pathname, location.hash)\n})\n\nlet linkHolder = {}\n\nfunction updateLh(location) {\n\n    if (location.hash in linkHolder) {\n        linkHolder[location.hash] = linkHolder[location.hash] + 1\n    } else {\n        linkHolder[location.hash] = 0\n    }\n\n}\n\nhistory.listen(location => {\n    updateLh(location)\n});\n\n\nclass Main extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n        }\n\n        // console.log(window.location)\n        updateLh(window.location)\n    }\n\n    componentDidMount() {\n        // ReactGA.pageview(window.location.hash)\n        // document.title = \"Image Analysis Explorer | Explore Convolutional Neural Nets for Imagee Analysis\";\n    }\n\n\n\n\n\n\n    render() {\n\n\n        return (\n            <HashRouter>\n                <AppHeader></AppHeader>\n\n                <div className=\"container-fluid p10\">\n                    <Route exact path=\"/\" component={Viz} />\n                    <Route exact path=\"/train\" component={Train} />\n\n                </div>\n                <div id=\"footer\"> <Footer /> </div>\n            </HashRouter>\n\n        );\n    }\n}\n\nexport default Main;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport Main from \"./components/Main\";\nimport * as serviceWorker from './serviceWorker';\n\nimport \"./components/template.scss\"\n// import 'bootstrap/dist/css/bootstrap.css';\n\nReactDOM.render(\n    <Main />,\n    document.getElementById(\"root\")\n);\n\nserviceWorker.register()"],"sourceRoot":""}